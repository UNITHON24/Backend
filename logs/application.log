2025-08-10 00:15:41 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 9600 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 00:15:41 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 00:15:41 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 00:15:42 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 00:15:42 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 14 ms. Found 3 JPA repository interfaces.
2025-08-10 00:15:42 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=d80ca709-2739-3bf7-a85d-20ed4be5f376
2025-08-10 00:15:42 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 00:15:42 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 00:15:42 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 00:15:42 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 00:15:42 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 544 ms
2025-08-10 00:15:42 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 00:15:42 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 00:15:42 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 00:15:42 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 00:15:42 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 00:15:42 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@18ca9277
2025-08-10 00:15:42 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 00:15:42 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 00:15:42 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 00:15:42 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 00:15:43 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 00:15:44 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 00:15:44 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 00:15:44 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 00:15:44 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 00:15:44 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 00:15:44 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 00:15:44 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 00:15:45 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'dataSourceScriptDatabaseInitializer' defined in class path resource [org/springframework/boot/autoconfigure/sql/init/DataSourceInitializationConfiguration.class]: Failed to execute SQL script statement #12 of file [/Users/yunjeong/Desktop/unithon/build/resources/main/data.sql]: INSERT INTO menu_synonym (menu_id, synonym, priority) VALUES (1, '아아', 1), (1, '따아', 2), (1, '아메', 3), (1, '커피', 4), (2, '라떼', 1), (2, '라떼', 2), (5, '콜라', 1), (5, '코카', 2), (6, '제로', 1), (6, '제로콜라', 2), (6, '콜라제로', 3), (9, '빅맥세트', 1), (11, '상하이세트', 1), (11, '상하이 세트', 2), (11, '맥스파이시세트', 3), (17, '감튀', 1), (17, '감자튀김', 2), (17, '프라이', 3), (18, '너겟', 1), (18, '치킨', 2)
2025-08-10 00:15:45 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 00:15:45 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-10 00:15:45 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-10 00:15:45 [main] INFO  o.a.catalina.core.StandardService - Stopping service [Tomcat]
2025-08-10 00:15:45 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-08-10 00:15:45 [main] ERROR o.s.boot.SpringApplication - Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'dataSourceScriptDatabaseInitializer' defined in class path resource [org/springframework/boot/autoconfigure/sql/init/DataSourceInitializationConfiguration.class]: Failed to execute SQL script statement #12 of file [/Users/yunjeong/Desktop/unithon/build/resources/main/data.sql]: INSERT INTO menu_synonym (menu_id, synonym, priority) VALUES (1, '아아', 1), (1, '따아', 2), (1, '아메', 3), (1, '커피', 4), (2, '라떼', 1), (2, '라떼', 2), (5, '콜라', 1), (5, '코카', 2), (6, '제로', 1), (6, '제로콜라', 2), (6, '콜라제로', 3), (9, '빅맥세트', 1), (11, '상하이세트', 1), (11, '상하이 세트', 2), (11, '맥스파이시세트', 3), (17, '감튀', 1), (17, '감자튀김', 2), (17, '프라이', 3), (18, '너겟', 1), (18, '치킨', 2)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1826)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:315)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.instantiateSingleton(DefaultListableBeanFactory.java:1222)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingleton(DefaultListableBeanFactory.java:1188)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:1123)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:987)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.example.unithon.UnithonApplication.main(UnithonApplication.java:10)
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #12 of file [/Users/yunjeong/Desktop/unithon/build/resources/main/data.sql]: INSERT INTO menu_synonym (menu_id, synonym, priority) VALUES (1, '아아', 1), (1, '따아', 2), (1, '아메', 3), (1, '커피', 4), (2, '라떼', 1), (2, '라떼', 2), (5, '콜라', 1), (5, '코카', 2), (6, '제로', 1), (6, '제로콜라', 2), (6, '콜라제로', 3), (9, '빅맥세트', 1), (11, '상하이세트', 1), (11, '상하이 세트', 2), (11, '맥스파이시세트', 3), (17, '감튀', 1), (17, '감자튀김', 2), (17, '프라이', 3), (18, '너겟', 1), (18, '치킨', 2)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:282)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:254)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:54)
	at org.springframework.boot.jdbc.init.DataSourceScriptDatabaseInitializer.runScripts(DataSourceScriptDatabaseInitializer.java:87)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.runScripts(AbstractScriptDatabaseInitializer.java:146)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.applyScripts(AbstractScriptDatabaseInitializer.java:108)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.applyDataScripts(AbstractScriptDatabaseInitializer.java:102)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.initializeDatabase(AbstractScriptDatabaseInitializer.java:77)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.afterPropertiesSet(AbstractScriptDatabaseInitializer.java:66)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822)
	... 20 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '라떼' for key 'menu_synonym.unique_synonym'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:109)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:837)
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:685)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:95)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:261)
	... 30 common frames omitted
2025-08-10 00:17:13 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 10416 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 00:17:13 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 00:17:13 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 00:17:13 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 00:17:13 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 16 ms. Found 3 JPA repository interfaces.
2025-08-10 00:17:13 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=d80ca709-2739-3bf7-a85d-20ed4be5f376
2025-08-10 00:17:13 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 00:17:13 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 00:17:13 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 00:17:13 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 00:17:13 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 499 ms
2025-08-10 00:17:13 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 00:17:13 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 00:17:13 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 00:17:13 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 00:17:13 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 00:17:13 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@34652065
2025-08-10 00:17:13 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 00:17:14 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 00:17:14 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 00:17:14 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 00:17:14 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 00:17:14 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 00:17:14 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 00:17:14 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 00:17:15 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 00:17:15 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 00:17:15 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 00:17:15 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 00:17:15 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'dataSourceScriptDatabaseInitializer' defined in class path resource [org/springframework/boot/autoconfigure/sql/init/DataSourceInitializationConfiguration.class]: Failed to execute SQL script statement #5 of file [/Users/yunjeong/Desktop/unithon/build/resources/main/schema.sql]: CREATE INDEX idx_menu_category_id ON menu(category_id)
2025-08-10 00:17:15 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 00:17:15 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-10 00:17:15 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-10 00:17:15 [main] INFO  o.a.catalina.core.StandardService - Stopping service [Tomcat]
2025-08-10 00:17:15 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-08-10 00:17:15 [main] ERROR o.s.boot.SpringApplication - Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'dataSourceScriptDatabaseInitializer' defined in class path resource [org/springframework/boot/autoconfigure/sql/init/DataSourceInitializationConfiguration.class]: Failed to execute SQL script statement #5 of file [/Users/yunjeong/Desktop/unithon/build/resources/main/schema.sql]: CREATE INDEX idx_menu_category_id ON menu(category_id)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1826)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:315)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.instantiateSingleton(DefaultListableBeanFactory.java:1222)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingleton(DefaultListableBeanFactory.java:1188)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:1123)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:987)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.example.unithon.UnithonApplication.main(UnithonApplication.java:10)
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #5 of file [/Users/yunjeong/Desktop/unithon/build/resources/main/schema.sql]: CREATE INDEX idx_menu_category_id ON menu(category_id)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:282)
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:254)
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:54)
	at org.springframework.boot.jdbc.init.DataSourceScriptDatabaseInitializer.runScripts(DataSourceScriptDatabaseInitializer.java:87)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.runScripts(AbstractScriptDatabaseInitializer.java:146)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.applyScripts(AbstractScriptDatabaseInitializer.java:108)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.applySchemaScripts(AbstractScriptDatabaseInitializer.java:98)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.initializeDatabase(AbstractScriptDatabaseInitializer.java:76)
	at org.springframework.boot.sql.init.AbstractScriptDatabaseInitializer.afterPropertiesSet(AbstractScriptDatabaseInitializer.java:66)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822)
	... 20 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Duplicate key name 'idx_menu_category_id'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:837)
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:685)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:95)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:261)
	... 30 common frames omitted
2025-08-10 00:17:33 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 10611 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 00:17:33 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 00:17:33 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 00:17:33 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 00:17:33 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 16 ms. Found 3 JPA repository interfaces.
2025-08-10 00:17:33 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=d80ca709-2739-3bf7-a85d-20ed4be5f376
2025-08-10 00:17:33 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 00:17:33 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 00:17:33 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 00:17:33 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 00:17:33 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 500 ms
2025-08-10 00:17:33 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 00:17:33 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 00:17:33 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 00:17:33 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 00:17:33 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 00:17:33 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@3636f2a7
2025-08-10 00:17:33 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 00:17:33 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 00:17:33 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 00:17:33 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 00:17:34 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 00:17:34 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 00:17:34 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 00:17:34 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 00:17:34 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 00:17:34 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 00:17:34 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 00:17:34 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 00:17:35 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'
2025-08-10 00:17:35 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 00:17:35 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-10 00:17:35 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-10 00:17:35 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-08-10 00:17:35 [main] ERROR o.s.b.d.LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Web server failed to start. Port 8080 was already in use.

Action:

Identify and stop the process that's listening on port 8080 or configure this application to listen on another port.

2025-08-10 00:18:20 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 11270 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 00:18:20 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 00:18:20 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 00:18:20 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 00:18:20 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 15 ms. Found 3 JPA repository interfaces.
2025-08-10 00:18:20 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=d80ca709-2739-3bf7-a85d-20ed4be5f376
2025-08-10 00:18:21 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 00:18:21 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 00:18:21 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 00:18:21 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 00:18:21 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 500 ms
2025-08-10 00:18:21 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 00:18:21 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 00:18:21 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 00:18:21 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 00:18:21 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 00:18:21 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@3636f2a7
2025-08-10 00:18:21 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 00:18:21 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 00:18:21 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 00:18:21 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 00:18:21 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 00:18:22 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 00:18:22 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 00:18:22 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 00:18:22 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 00:18:22 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 00:18:22 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 00:18:22 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 00:18:23 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'
2025-08-10 00:18:23 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 00:18:23 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-10 00:18:23 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-10 00:18:23 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-08-10 00:18:23 [main] ERROR o.s.b.d.LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Web server failed to start. Port 8080 was already in use.

Action:

Identify and stop the process that's listening on port 8080 or configure this application to listen on another port.

2025-08-10 00:19:17 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 11825 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 00:19:17 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 00:19:17 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 00:19:17 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 00:19:17 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 15 ms. Found 3 JPA repository interfaces.
2025-08-10 00:19:17 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=d80ca709-2739-3bf7-a85d-20ed4be5f376
2025-08-10 00:19:17 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 00:19:17 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 00:19:17 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 00:19:17 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 00:19:17 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 532 ms
2025-08-10 00:19:17 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 00:19:17 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 00:19:18 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 00:19:18 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 00:19:18 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 00:19:18 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@6651efa4
2025-08-10 00:19:18 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 00:19:18 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 00:19:18 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 00:19:18 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 00:19:18 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 00:19:18 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 00:19:18 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 00:19:18 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 00:19:19 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 00:19:19 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 00:19:19 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 00:19:19 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 00:19:19 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-08-10 00:19:19 [main] INFO  c.example.unithon.UnithonApplication - Started UnithonApplication in 2.737 seconds (process running for 3.187)
2025-08-10 00:25:43 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-10 00:25:43 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-10 00:25:43 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-08-10 00:25:43 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-08-10 00:25:43 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-08-10 00:25:43 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@6a4859fc
2025-08-10 00:25:43 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@249a7ccc
2025-08-10 00:25:43 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-08-10 00:25:43 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 4 ms
2025-08-10 00:25:43 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/menu/search/simple?query=%EC%95%84%EC%95%84", parameters={masked}
2025-08-10 00:25:43 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.unithon.domain.menu.controller.MenuController#searchMenuSimple(String)
2025-08-10 00:25:43 [http-nio-8080-exec-1] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 아아
2025-08-10 00:25:43 [http-nio-8080-exec-1] INFO  c.e.u.d.menu.service.MenuService - DB 동의어 매칭 성공: 아아 → 아메리카노
2025-08-10 00:25:43 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/octet-stream', given [*/*] and supported [*/*]
2025-08-10 00:25:43 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.example.unithon.global.error.GlobalExceptionHandler#handleException(Exception)
2025-08-10 00:25:43 [http-nio-8080-exec-1] ERROR c.e.u.g.error.GlobalExceptionHandler - HttpMediaTypeNotAcceptableException : org.springframework.web.HttpMediaTypeNotAcceptableException: No acceptable representation
2025-08-10 00:25:43 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json, application/yaml]
2025-08-10 00:25:43 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [com.example.unithon.global.error.dto.ExceptionResponse@7c105556]
2025-08-10 00:25:43 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotAcceptableException: No acceptable representation]
2025-08-10 00:25:43 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-08-10 00:29:20 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-10 00:29:20 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-10 00:29:20 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 00:29:20 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-10 00:29:20 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-10 00:29:23 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 17141 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 00:29:23 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 00:29:23 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 00:29:23 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 00:29:23 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 15 ms. Found 3 JPA repository interfaces.
2025-08-10 00:29:23 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=d80ca709-2739-3bf7-a85d-20ed4be5f376
2025-08-10 00:29:23 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 00:29:23 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 00:29:23 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 00:29:23 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 00:29:23 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 504 ms
2025-08-10 00:29:23 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 00:29:23 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 00:29:23 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 00:29:24 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 00:29:24 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 00:29:24 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@120d13ae
2025-08-10 00:29:24 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 00:29:24 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 00:29:24 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 00:29:24 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 00:29:24 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 00:29:24 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 00:29:24 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 00:29:24 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 00:29:25 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 00:29:25 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 00:29:25 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 00:29:25 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 00:29:25 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-08-10 00:29:25 [main] INFO  c.example.unithon.UnithonApplication - Started UnithonApplication in 2.836 seconds (process running for 3.344)
2025-08-10 00:29:29 [http-nio-8080-exec-2] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-10 00:29:29 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-10 00:29:29 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-08-10 00:29:29 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-08-10 00:29:29 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-08-10 00:29:29 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@7b1466e3
2025-08-10 00:29:29 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@1f9a472e
2025-08-10 00:29:29 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-08-10 00:29:29 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-08-10 00:29:29 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/menu/search/simple?query=%EC%95%84%EC%95%84", parameters={masked}
2025-08-10 00:29:29 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.unithon.domain.menu.controller.MenuController#searchMenuSimple(String)
2025-08-10 00:29:29 [http-nio-8080-exec-2] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 아아
2025-08-10 00:29:29 [http-nio-8080-exec-2] INFO  c.e.u.d.menu.service.MenuService - DB 동의어 매칭 성공: 아아 → 아메리카노
2025-08-10 00:29:29 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json, application/yaml]
2025-08-10 00:29:29 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [com.example.unithon.global.response.ApiResponse@16375ea8]
2025-08-10 00:29:29 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-08-10 00:31:34 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/menu/search/simple?query=%EB%B0%94%EB%8B%90%EB%9D%BC%ED%94%8C%EB%9E%AB%ED%99%94%EC%9D%B4%ED%8A%B8", parameters={masked}
2025-08-10 00:31:34 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.unithon.domain.menu.controller.MenuController#searchMenuSimple(String)
2025-08-10 00:31:34 [http-nio-8080-exec-5] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 바닐라플랫화이트
2025-08-10 00:31:34 [http-nio-8080-exec-5] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자가 '바닐라플랫화이트'를 주문했습니다.
다음 메뉴 중에서 가장 적절한 1-2개를 추천해주세요:

- 맥스파이시 상하이 버거 세트 (6200.00원): 맥스파이시 상하이 버거 + 사이드 + 음료
- 소프트 콘 (800.00원): 부드러운 소프트 아이스크림
- 맥플러리 오레오 (2500.00원): 오레오가 들어간 아이스크림
- 애플파이 (1500.00원): 따뜻한 애플파이
- 치킨 너겟 (2200.00원): 바삭한 치킨 너겟
- 프렌치프라이 (1800.00원): 바삭한 감자튀김
- 불고기 버거 (3500.00원): 한국식 불고기 버거
- 맥스파이시 상하이 버거 (4500.00원): 매콤한 치킨 버거
- 쿼터파운더 (4800.00원): 1/4파운드 순쇠고기 패티
- 빅맥 (4200.00원): 맥도날드 대표 버거
- 불고기 버거 세트 (5200.00원): 불고기 버거 + 사이드 + 음료
- 아메리카노 (1500.00원): 깔끔하고 진한 커피의 맛
- 쿼터파운더 세트 (6500.00원): 쿼터파운더 + 사이드 + 음료
- 빅맥 세트 (5900.00원): 빅맥 + 사이드 + 음료
- 오렌지 주스 (1500.00원): 신선한 오렌지 주스
- 스프라이트 (1200.00원): 상쾌한 사이다
- 코카콜라 제로 (1200.00원): 제로 칼로리 콜라
- 코카콜라 (1200.00원): 시원한 콜라
- 캐러멜 마키아토 (2500.00원): 달콤한 캐러멜과 에스프레소
- 카푸치노 (2200.00원): 거품이 풍성한 이탈리안 커피
- 카페라떼 (2000.00원): 부드러운 우유와 에스프레소의 조화

응답 형식: JSON
{
  "recommended": ["메뉴명1", "메뉴명2"],
  "reason": "추천 이유"
}
2025-08-10 00:31:35 [http-nio-8080-exec-5] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 00:31:35 [http-nio-8080-exec-5] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: ```json
{
  "recommended": ["애플파이", "카페라떼"],
  "reason": "바닐라 플랫화이트는 달콤하고 부드러운 커피이므로,  상대적으로 담백한 애플파이가 단맛과의 조화를 이루어 좋은 조합입니다. 또한 카페라떼는 플랫화이트와 유사한 부드러운 우유와 에스프레소의 조합으로 커피의 풍미를 더욱 즐길 수 있습니다."
}
```

2025-08-10 00:31:35 [http-nio-8080-exec-5] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: ```json
{
  "recommended": ["애플파이", "카페라떼"],
  "reason": "바닐라 플랫화이트는 달콤하고 부드러운 커피이므로,  상대적으로 담백한 애플파이가 단맛과의 조화를 이루어 좋은 조합입니다. 또한 카페라떼는 플랫화이트와 유사한 부드러운 우유와 에스프레소의 조합으로 커피의 풍미를 더욱 즐길 수 있습니다."
}
```

2025-08-10 00:31:35 [http-nio-8080-exec-5] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답에서 파싱된 추천 메뉴: [애플파이, 카페라떼]
2025-08-10 00:31:36 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json, application/yaml]
2025-08-10 00:31:36 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [com.example.unithon.global.response.ApiResponse@1d9b3771]
2025-08-10 00:31:36 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-08-10 00:34:25 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-10 00:34:25 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-10 00:34:25 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 00:34:25 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-10 00:34:25 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-10 00:34:27 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 19703 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 00:34:27 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 00:34:27 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 00:34:27 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 00:34:27 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 14 ms. Found 3 JPA repository interfaces.
2025-08-10 00:34:27 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=d80ca709-2739-3bf7-a85d-20ed4be5f376
2025-08-10 00:34:27 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 00:34:27 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 00:34:27 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 00:34:27 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 00:34:27 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 477 ms
2025-08-10 00:34:27 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 00:34:27 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 00:34:27 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 00:34:27 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 00:34:27 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 00:34:27 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@5909285b
2025-08-10 00:34:27 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 00:34:28 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 00:34:28 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 00:34:28 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 00:34:28 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 00:34:28 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 00:34:28 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 00:34:28 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 00:34:28 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 00:34:28 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 00:34:28 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 00:34:29 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 00:34:29 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-08-10 00:34:29 [main] INFO  c.example.unithon.UnithonApplication - Started UnithonApplication in 2.794 seconds (process running for 3.17)
2025-08-10 00:34:45 [http-nio-8080-exec-2] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-10 00:34:45 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-10 00:34:45 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-08-10 00:34:45 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-08-10 00:34:45 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-08-10 00:34:45 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@c0d114b
2025-08-10 00:34:45 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@14a7e16e
2025-08-10 00:34:45 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-08-10 00:34:45 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 7 ms
2025-08-10 00:34:45 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/menu/search/simple?query=%EB%B0%94%EB%8B%90%EB%9D%BC%ED%94%8C%EB%9E%AB%ED%99%94%EC%9D%B4%ED%8A%B8", parameters={masked}
2025-08-10 00:34:45 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.unithon.domain.menu.controller.MenuController#searchMenuSimple(String)
2025-08-10 00:34:45 [http-nio-8080-exec-2] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 바닐라플랫화이트
2025-08-10 00:34:45 [http-nio-8080-exec-2] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자가 '바닐라플랫화이트'를 주문했습니다.
이 메뉴는 현재 메뉴판에 없습니다.

다음 메뉴 중에서 바닐라플랫화이트와 가장 유사한 메뉴 1-2개를 찾아주세요:

- 맥스파이시 상하이 버거 세트 (6200.00원): 맥스파이시 상하이 버거 + 사이드 + 음료
- 소프트 콘 (800.00원): 부드러운 소프트 아이스크림
- 맥플러리 오레오 (2500.00원): 오레오가 들어간 아이스크림
- 애플파이 (1500.00원): 따뜻한 애플파이
- 치킨 너겟 (2200.00원): 바삭한 치킨 너겟
- 프렌치프라이 (1800.00원): 바삭한 감자튀김
- 불고기 버거 (3500.00원): 한국식 불고기 버거
- 맥스파이시 상하이 버거 (4500.00원): 매콤한 치킨 버거
- 쿼터파운더 (4800.00원): 1/4파운드 순쇠고기 패티
- 빅맥 (4200.00원): 맥도날드 대표 버거
- 불고기 버거 세트 (5200.00원): 불고기 버거 + 사이드 + 음료
- 아메리카노 (1500.00원): 깔끔하고 진한 커피의 맛
- 쿼터파운더 세트 (6500.00원): 쿼터파운더 + 사이드 + 음료
- 빅맥 세트 (5900.00원): 빅맥 + 사이드 + 음료
- 오렌지 주스 (1500.00원): 신선한 오렌지 주스
- 스프라이트 (1200.00원): 상쾌한 사이다
- 코카콜라 제로 (1200.00원): 제로 칼로리 콜라
- 코카콜라 (1200.00원): 시원한 콜라
- 캐러멜 마키아토 (2500.00원): 달콤한 캐러멜과 에스프레소
- 카푸치노 (2200.00원): 거품이 풍성한 이탈리안 커피
- 카페라떼 (2000.00원): 부드러운 우유와 에스프레소의 조화

중요한 규칙:
1. 카테고리가 같은 메뉴를 우선 추천 (커피→커피, 버거→버거)
2. 맛, 재료, 특성이 유사한 메뉴를 선택
3. 가격대가 비슷한 메뉴를 우선 고려
4. 반드시 위 메뉴 목록에 있는 정확한 메뉴명만 추천

예시:
- '바닐라 라떼' 요청 시 → '카페라떼' 또는 '캐러멜 마키아토' 추천
- '치즈버거' 요청 시 → '빅맥' 또는 '불고기 버거' 추천

응답 형식: JSON
{
  "recommended": ["정확한메뉴명1", "정확한메뉴명2"],
  "reason": "유사성 기준 설명"
}
2025-08-10 00:34:47 [http-nio-8080-exec-2] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 00:34:47 [http-nio-8080-exec-2] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: ```json
{
  "recommended": ["카페라떼", "카푸치노"],
  "reason": "바닐라 플랫화이트는 에스프레소와 우유가 기본 베이스인 커피 메뉴이며, 바닐라 시럽이 추가된 것이 특징입니다.  메뉴 목록 중 카페라떼와 카푸치노는 에스프레소와 우유를 베이스로 한 커피 메뉴로,  바닐라 플랫화이트와 가장 유사한 카테고리에 속하며, 맛과 재료 측면에서 유사성이 높습니다.  가격대 또한 비슷합니다."
}
```

2025-08-10 00:34:47 [http-nio-8080-exec-2] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: ```json
{
  "recommended": ["카페라떼", "카푸치노"],
  "reason": "바닐라 플랫화이트는 에스프레소와 우유가 기본 베이스인 커피 메뉴이며, 바닐라 시럽이 추가된 것이 특징입니다.  메뉴 목록 중 카페라떼와 카푸치노는 에스프레소와 우유를 베이스로 한 커피 메뉴로,  바닐라 플랫화이트와 가장 유사한 카테고리에 속하며, 맛과 재료 측면에서 유사성이 높습니다.  가격대 또한 비슷합니다."
}
```

2025-08-10 00:34:47 [http-nio-8080-exec-2] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답에서 파싱된 추천 메뉴: [카페라떼, 카푸치노]
2025-08-10 00:34:47 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json, application/yaml]
2025-08-10 00:34:47 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [com.example.unithon.global.response.ApiResponse@4dcfcdac]
2025-08-10 00:34:47 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-08-10 00:40:11 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-10 00:40:11 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-10 00:40:11 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 00:40:11 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-10 00:40:11 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-10 00:40:13 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 22671 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 00:40:13 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 00:40:13 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 00:40:14 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 00:40:14 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 15 ms. Found 3 JPA repository interfaces.
2025-08-10 00:40:14 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=d80ca709-2739-3bf7-a85d-20ed4be5f376
2025-08-10 00:40:14 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 00:40:14 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 00:40:14 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 00:40:14 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 00:40:14 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 521 ms
2025-08-10 00:40:14 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 00:40:14 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 00:40:14 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 00:40:14 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 00:40:14 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 00:40:14 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@4ebed2b3
2025-08-10 00:40:14 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 00:40:14 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 00:40:14 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 00:40:14 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 00:40:15 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 00:40:15 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 00:40:15 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 00:40:15 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 00:40:15 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 00:40:15 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 00:40:15 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 00:40:15 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 00:40:16 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-08-10 00:40:16 [main] INFO  c.example.unithon.UnithonApplication - Started UnithonApplication in 2.692 seconds (process running for 3.072)
2025-08-10 00:40:20 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-10 00:40:20 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-10 00:40:20 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-08-10 00:40:20 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-08-10 00:40:20 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-08-10 00:40:20 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@38dacb78
2025-08-10 00:40:20 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@2079ce51
2025-08-10 00:40:20 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-08-10 00:40:20 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-10 00:40:20 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/menu/search/simple?query=%EB%B0%94%EB%8B%90%EB%9D%BC%ED%94%8C%EB%9E%AB%ED%99%94%EC%9D%B4%ED%8A%B8", parameters={masked}
2025-08-10 00:40:20 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.unithon.domain.menu.controller.MenuController#searchMenuSimple(String)
2025-08-10 00:40:20 [http-nio-8080-exec-1] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 바닐라플랫화이트
2025-08-10 00:40:20 [http-nio-8080-exec-1] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자가 '바닐라플랫화이트'를 주문했습니다.
이것은 맥도날드 매장입니다. 다음은 현재 판매 중인 메뉴입니다:

버거/세트: 빅맥, 쿼터파운더, 맥스파이시 상하이 버거, 불고기 버거
커피: 아메리카노, 카페라떼, 카푸치노, 캐러멜 마키아토
음료: 코카콜라, 코카콜라 제로, 스프라이트, 오렌지 주스
사이드: 프렌치프라이, 치킨 너겟, 애플파이
디저트: 맥플러리 오레오, 소프트 콘

판단 기준:
1. 요청한 음식이 맥도날드에서 파는 종류의 음식인가?
2. 위 메뉴와 유사한 것이 있는가?

응답 규칙:
- 맥도날드와 전혀 관련 없는 음식(짜장면, 김치찌개, 초밥 등)이면 → NO_MATCH
- 유사한 메뉴가 있으면 → 다음 기준으로 추천:
  1. 카테고리가 같은 메뉴를 우선 추천 (커피→커피, 버거→버거)
  2. 맛, 재료, 특성이 유사한 메뉴를 선택
  3. 가격대가 비슷한 메뉴를 우선 고려
  4. 반드시 위 메뉴 목록에 있는 정확한 메뉴명만 추천

예시:
바닐라 라떼' → '카페라떼', '캐러멜 마키아토' 추천
'치즈버거' → '빅맥', '불고기 버거' 추천
'짜장면' → NO_MATCH (맥도날드 음식이 아님)
'김치찌개' → NO_MATCH (맥도날드 음식이 아님)

응답 형식: JSON
{
  "recommended": ["메뉴명1", "메뉴명2"] 또는 "NO_MATCH",
  "reason": "판단 이유"
}
2025-08-10 00:40:22 [http-nio-8080-exec-1] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 00:40:22 [http-nio-8080-exec-1] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: ```json
{
  "recommended": ["카페라떼"],
  "reason": "바닐라 플랫화이트는 커피 메뉴이며, 맥도날드 메뉴에는 직접적으로 일치하는 메뉴가 없습니다.  하지만 카페라떼는 우유 기반 커피라는 점에서 가장 유사합니다.  다른 커피 메뉴들(아메리카노, 카푸치노, 캐러멜 마키아토)은 우유가 들어가지 않거나 다른 풍미가 강하기 때문에 카페라떼를 가장 적합한 추천 메뉴로 판단했습니다."
}
```

2025-08-10 00:40:22 [http-nio-8080-exec-1] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: ```json
{
  "recommended": ["카페라떼"],
  "reason": "바닐라 플랫화이트는 커피 메뉴이며, 맥도날드 메뉴에는 직접적으로 일치하는 메뉴가 없습니다.  하지만 카페라떼는 우유 기반 커피라는 점에서 가장 유사합니다.  다른 커피 메뉴들(아메리카노, 카푸치노, 캐러멜 마키아토)은 우유가 들어가지 않거나 다른 풍미가 강하기 때문에 카페라떼를 가장 적합한 추천 메뉴로 판단했습니다."
}
```

2025-08-10 00:40:22 [http-nio-8080-exec-1] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답에서 파싱된 추천 메뉴: [카페라떼]
2025-08-10 00:40:22 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json, application/yaml]
2025-08-10 00:40:22 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [com.example.unithon.global.response.ApiResponse@18e259c8]
2025-08-10 00:40:22 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-08-10 00:41:19 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/menu/search/simple?query=%EC%A7%9C%EC%9E%A5%EB%A9%B4", parameters={masked}
2025-08-10 00:41:19 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.unithon.domain.menu.controller.MenuController#searchMenuSimple(String)
2025-08-10 00:41:19 [http-nio-8080-exec-3] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 짜장면
2025-08-10 00:41:19 [http-nio-8080-exec-3] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자가 '짜장면'를 주문했습니다.
이것은 맥도날드 매장입니다. 다음은 현재 판매 중인 메뉴입니다:

버거/세트: 빅맥, 쿼터파운더, 맥스파이시 상하이 버거, 불고기 버거
커피: 아메리카노, 카페라떼, 카푸치노, 캐러멜 마키아토
음료: 코카콜라, 코카콜라 제로, 스프라이트, 오렌지 주스
사이드: 프렌치프라이, 치킨 너겟, 애플파이
디저트: 맥플러리 오레오, 소프트 콘

판단 기준:
1. 요청한 음식이 맥도날드에서 파는 종류의 음식인가?
2. 위 메뉴와 유사한 것이 있는가?

응답 규칙:
- 맥도날드와 전혀 관련 없는 음식(짜장면, 김치찌개, 초밥 등)이면 → NO_MATCH
- 유사한 메뉴가 있으면 → 다음 기준으로 추천:
  1. 카테고리가 같은 메뉴를 우선 추천 (커피→커피, 버거→버거)
  2. 맛, 재료, 특성이 유사한 메뉴를 선택
  3. 가격대가 비슷한 메뉴를 우선 고려
  4. 반드시 위 메뉴 목록에 있는 정확한 메뉴명만 추천

예시:
바닐라 라떼' → '카페라떼', '캐러멜 마키아토' 추천
'치즈버거' → '빅맥', '불고기 버거' 추천
'짜장면' → NO_MATCH (맥도날드 음식이 아님)
'김치찌개' → NO_MATCH (맥도날드 음식이 아님)

응답 형식: JSON
{
  "recommended": ["메뉴명1", "메뉴명2"] 또는 "NO_MATCH",
  "reason": "판단 이유"
}
2025-08-10 00:41:20 [http-nio-8080-exec-3] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 00:41:20 [http-nio-8080-exec-3] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: ```json
{
  "recommended": "NO_MATCH",
  "reason": "짜장면은 맥도날드 메뉴에 없습니다."
}
```

2025-08-10 00:41:20 [http-nio-8080-exec-3] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: ```json
{
  "recommended": "NO_MATCH",
  "reason": "짜장면은 맥도날드 메뉴에 없습니다."
}
```

2025-08-10 00:41:20 [http-nio-8080-exec-3] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: 맥도날드 메뉴와 관련 없는 요청으로 판단됨
2025-08-10 00:41:20 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json, application/yaml]
2025-08-10 00:41:20 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [com.example.unithon.global.response.ApiResponse@7adf06e1]
2025-08-10 00:41:20 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-08-10 00:42:01 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/menu/search/simple?query=%EB%B2%A0%EC%9D%B4%EC%BB%A8%ED%86%A0%EB%A7%88%ED%86%A0%EB%94%94%EB%9F%AD%EC%8A%A4%EB%B2%84%EA%B1%B0", parameters={masked}
2025-08-10 00:42:01 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.unithon.domain.menu.controller.MenuController#searchMenuSimple(String)
2025-08-10 00:42:01 [http-nio-8080-exec-4] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 베이컨토마토디럭스버거
2025-08-10 00:42:01 [http-nio-8080-exec-4] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자가 '베이컨토마토디럭스버거'를 주문했습니다.
이것은 맥도날드 매장입니다. 다음은 현재 판매 중인 메뉴입니다:

버거/세트: 빅맥, 쿼터파운더, 맥스파이시 상하이 버거, 불고기 버거
커피: 아메리카노, 카페라떼, 카푸치노, 캐러멜 마키아토
음료: 코카콜라, 코카콜라 제로, 스프라이트, 오렌지 주스
사이드: 프렌치프라이, 치킨 너겟, 애플파이
디저트: 맥플러리 오레오, 소프트 콘

판단 기준:
1. 요청한 음식이 맥도날드에서 파는 종류의 음식인가?
2. 위 메뉴와 유사한 것이 있는가?

응답 규칙:
- 맥도날드와 전혀 관련 없는 음식(짜장면, 김치찌개, 초밥 등)이면 → NO_MATCH
- 유사한 메뉴가 있으면 → 다음 기준으로 추천:
  1. 카테고리가 같은 메뉴를 우선 추천 (커피→커피, 버거→버거)
  2. 맛, 재료, 특성이 유사한 메뉴를 선택
  3. 가격대가 비슷한 메뉴를 우선 고려
  4. 반드시 위 메뉴 목록에 있는 정확한 메뉴명만 추천

예시:
바닐라 라떼' → '카페라떼', '캐러멜 마키아토' 추천
'치즈버거' → '빅맥', '불고기 버거' 추천
'짜장면' → NO_MATCH (맥도날드 음식이 아님)
'김치찌개' → NO_MATCH (맥도날드 음식이 아님)

응답 형식: JSON
{
  "recommended": ["메뉴명1", "메뉴명2"] 또는 "NO_MATCH",
  "reason": "판단 이유"
}
2025-08-10 00:42:02 [http-nio-8080-exec-4] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 00:42:02 [http-nio-8080-exec-4] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: ```json
{
  "recommended": ["빅맥", "쿼터파운더"],
  "reason": "베이컨토마토디럭스버거는 맥도날드 메뉴에는 없지만, 버거 종류이며 베이컨과 토마토가 들어간 것으로 추정되므로, 맥도날드의 다른 버거 메뉴인 빅맥과 쿼터파운더를 추천합니다."
}
```

2025-08-10 00:42:02 [http-nio-8080-exec-4] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: ```json
{
  "recommended": ["빅맥", "쿼터파운더"],
  "reason": "베이컨토마토디럭스버거는 맥도날드 메뉴에는 없지만, 버거 종류이며 베이컨과 토마토가 들어간 것으로 추정되므로, 맥도날드의 다른 버거 메뉴인 빅맥과 쿼터파운더를 추천합니다."
}
```

2025-08-10 00:42:02 [http-nio-8080-exec-4] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답에서 파싱된 추천 메뉴: [빅맥, 쿼터파운더]
2025-08-10 00:42:02 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json, application/yaml]
2025-08-10 00:42:02 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [com.example.unithon.global.response.ApiResponse@5103007e]
2025-08-10 00:42:02 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-08-10 00:43:29 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/menu/search/simple?query=", parameters={masked}
2025-08-10 00:43:29 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.unithon.domain.menu.controller.MenuController#searchMenuSimple(String)
2025-08-10 00:43:29 [http-nio-8080-exec-7] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 
2025-08-10 00:43:29 [http-nio-8080-exec-7] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자가 ''를 주문했습니다.
이것은 맥도날드 매장입니다. 다음은 현재 판매 중인 메뉴입니다:

버거/세트: 빅맥, 쿼터파운더, 맥스파이시 상하이 버거, 불고기 버거
커피: 아메리카노, 카페라떼, 카푸치노, 캐러멜 마키아토
음료: 코카콜라, 코카콜라 제로, 스프라이트, 오렌지 주스
사이드: 프렌치프라이, 치킨 너겟, 애플파이
디저트: 맥플러리 오레오, 소프트 콘

판단 기준:
1. 요청한 음식이 맥도날드에서 파는 종류의 음식인가?
2. 위 메뉴와 유사한 것이 있는가?

응답 규칙:
- 맥도날드와 전혀 관련 없는 음식(짜장면, 김치찌개, 초밥 등)이면 → NO_MATCH
- 유사한 메뉴가 있으면 → 다음 기준으로 추천:
  1. 카테고리가 같은 메뉴를 우선 추천 (커피→커피, 버거→버거)
  2. 맛, 재료, 특성이 유사한 메뉴를 선택
  3. 가격대가 비슷한 메뉴를 우선 고려
  4. 반드시 위 메뉴 목록에 있는 정확한 메뉴명만 추천

예시:
바닐라 라떼' → '카페라떼', '캐러멜 마키아토' 추천
'치즈버거' → '빅맥', '불고기 버거' 추천
'짜장면' → NO_MATCH (맥도날드 음식이 아님)
'김치찌개' → NO_MATCH (맥도날드 음식이 아님)

응답 형식: JSON
{
  "recommended": ["메뉴명1", "메뉴명2"] 또는 "NO_MATCH",
  "reason": "판단 이유"
}
2025-08-10 00:43:31 [http-nio-8080-exec-7] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 00:43:31 [http-nio-8080-exec-7] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: 사용자가 주문한 음식이 없으므로 응답할 수 없습니다.  사용자가 주문한 음식을 입력해주세요.

2025-08-10 00:43:31 [http-nio-8080-exec-7] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: 사용자가 주문한 음식이 없으므로 응답할 수 없습니다.  사용자가 주문한 음식을 입력해주세요.

2025-08-10 00:43:31 [http-nio-8080-exec-7] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답에서 파싱된 추천 메뉴: []
2025-08-10 00:43:31 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json, application/yaml]
2025-08-10 00:43:31 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [com.example.unithon.global.response.ApiResponse@150fbbe2]
2025-08-10 00:43:31 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-08-10 00:44:40 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/menu/search/simple?query=%EC%95%84%EC%95%84", parameters={masked}
2025-08-10 00:44:40 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.unithon.domain.menu.controller.MenuController#searchMenuSimple(String)
2025-08-10 00:44:40 [http-nio-8080-exec-10] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 아아
2025-08-10 00:44:40 [http-nio-8080-exec-10] INFO  c.e.u.d.menu.service.MenuService - DB 동의어 매칭 성공: 아아 → 아메리카노
2025-08-10 00:44:40 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json, application/yaml]
2025-08-10 00:44:40 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [com.example.unithon.global.response.ApiResponse@7638cb04]
2025-08-10 00:44:40 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-08-10 00:45:05 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/menu/search/simple?query=%EC%95%84%EC%9D%B4%EC%8A%A4%EC%95%84%EB%A9%94%EC%B9%B4%EB%85%B8", parameters={masked}
2025-08-10 00:45:05 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.unithon.domain.menu.controller.MenuController#searchMenuSimple(String)
2025-08-10 00:45:05 [http-nio-8080-exec-2] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 아이스아메카노
2025-08-10 00:45:05 [http-nio-8080-exec-2] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자가 '아이스아메카노'를 주문했습니다.
이것은 맥도날드 매장입니다. 다음은 현재 판매 중인 메뉴입니다:

버거/세트: 빅맥, 쿼터파운더, 맥스파이시 상하이 버거, 불고기 버거
커피: 아메리카노, 카페라떼, 카푸치노, 캐러멜 마키아토
음료: 코카콜라, 코카콜라 제로, 스프라이트, 오렌지 주스
사이드: 프렌치프라이, 치킨 너겟, 애플파이
디저트: 맥플러리 오레오, 소프트 콘

판단 기준:
1. 요청한 음식이 맥도날드에서 파는 종류의 음식인가?
2. 위 메뉴와 유사한 것이 있는가?

응답 규칙:
- 맥도날드와 전혀 관련 없는 음식(짜장면, 김치찌개, 초밥 등)이면 → NO_MATCH
- 유사한 메뉴가 있으면 → 다음 기준으로 추천:
  1. 카테고리가 같은 메뉴를 우선 추천 (커피→커피, 버거→버거)
  2. 맛, 재료, 특성이 유사한 메뉴를 선택
  3. 가격대가 비슷한 메뉴를 우선 고려
  4. 반드시 위 메뉴 목록에 있는 정확한 메뉴명만 추천

예시:
바닐라 라떼' → '카페라떼', '캐러멜 마키아토' 추천
'치즈버거' → '빅맥', '불고기 버거' 추천
'짜장면' → NO_MATCH (맥도날드 음식이 아님)
'김치찌개' → NO_MATCH (맥도날드 음식이 아님)

응답 형식: JSON
{
  "recommended": ["메뉴명1", "메뉴명2"] 또는 "NO_MATCH",
  "reason": "판단 이유"
}
2025-08-10 00:45:06 [http-nio-8080-exec-2] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 00:45:06 [http-nio-8080-exec-2] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: ```json
{
  "recommended": ["아메리카노"],
  "reason": "고객이 주문한 '아이스아메리카노'는 맥도날드 메뉴에 있는 '아메리카노'와 유사합니다. 차이점은 아이스 여부이지만, 메뉴에 따로 아이스/핫을 구분하지 않고 아메리카노만 있으므로 아메리카노를 추천합니다."
}
```

2025-08-10 00:45:06 [http-nio-8080-exec-2] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: ```json
{
  "recommended": ["아메리카노"],
  "reason": "고객이 주문한 '아이스아메리카노'는 맥도날드 메뉴에 있는 '아메리카노'와 유사합니다. 차이점은 아이스 여부이지만, 메뉴에 따로 아이스/핫을 구분하지 않고 아메리카노만 있으므로 아메리카노를 추천합니다."
}
```

2025-08-10 00:45:06 [http-nio-8080-exec-2] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답에서 파싱된 추천 메뉴: [아메리카노]
2025-08-10 00:45:06 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json, application/yaml]
2025-08-10 00:45:06 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [com.example.unithon.global.response.ApiResponse@73cf7ef]
2025-08-10 00:45:06 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-08-10 00:48:18 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-10 00:48:18 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-10 00:48:18 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 00:48:18 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-10 00:48:18 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-10 01:03:13 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 35740 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 01:03:13 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 01:03:13 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 01:03:14 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 01:03:14 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 30 ms. Found 3 JPA repository interfaces.
2025-08-10 01:03:14 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=112049d1-3845-3d87-8e05-9cb5de088356
2025-08-10 01:03:14 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 01:03:14 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 01:03:14 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 01:03:14 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 01:03:14 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 594 ms
2025-08-10 01:03:14 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 01:03:14 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 01:03:14 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 01:03:14 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 01:03:14 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 01:03:14 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@12270a01
2025-08-10 01:03:14 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 01:03:14 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 01:03:14 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 01:03:14 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 01:03:15 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 01:03:15 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 01:03:15 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 01:03:15 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 01:03:15 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/chat] in 'webSocketHandlerMapping'
2025-08-10 01:03:15 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 01:03:15 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 01:03:15 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 01:03:15 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 01:03:16 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-08-10 01:03:16 [main] INFO  c.example.unithon.UnithonApplication - Started UnithonApplication in 2.893 seconds (process running for 3.169)
2025-08-10 01:11:24 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@66ad8469 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 01:11:27 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@12270a01 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 01:11:54 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=5m10s30ms).
2025-08-10 01:13:59 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=2m4s686ms).
2025-08-10 01:22:45 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@7551ef15 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 01:22:49 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=8m49s539ms).
2025-08-10 01:23:39 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@2656c0bc (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 01:26:08 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@23bac123 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 01:26:09 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@71a57b3d (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 01:26:10 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@61e61695 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 01:26:24 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@75b995a1 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 01:26:27 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@fff1ec (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 01:28:35 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=5m46s907ms).
2025-08-10 01:28:36 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@5a590e5d (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 01:28:37 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@3277717a (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 01:44:49 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@4d789649 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 01:44:50 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=16m14s435ms).
2025-08-10 01:45:40 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@30edb99 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 01:45:40 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@33883fb (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 01:45:43 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@56be7a7b (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 01:45:44 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@2399b126 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 01:45:53 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@7585e1f8 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 01:45:58 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@172d5a6d (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 01:45:59 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@23836ddc (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 01:46:05 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@3de7d097 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 01:46:16 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@271938e6 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 01:48:12 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 40839 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 01:48:12 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 01:48:12 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 01:48:13 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 01:48:13 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 15 ms. Found 3 JPA repository interfaces.
2025-08-10 01:48:13 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=3aea7bf1-352f-37ec-b393-0b60bc142e55
2025-08-10 01:48:13 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 01:48:13 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 01:48:13 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 01:48:13 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 01:48:13 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 550 ms
2025-08-10 01:48:13 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 01:48:13 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 01:48:13 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 01:48:13 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 01:48:13 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 01:48:13 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@1b732dd
2025-08-10 01:48:13 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 01:48:14 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 01:48:14 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 01:48:14 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 01:48:14 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 01:48:14 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 01:48:14 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 01:48:15 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 01:48:15 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/chat] in 'webSocketHandlerMapping'
2025-08-10 01:48:15 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 01:48:15 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 01:48:15 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 01:48:15 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 01:48:15 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'
2025-08-10 01:48:15 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 01:48:15 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-10 01:48:15 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-10 01:48:15 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-08-10 01:48:15 [main] ERROR o.s.b.d.LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Web server failed to start. Port 8080 was already in use.

Action:

Identify and stop the process that's listening on port 8080 or configure this application to listen on another port.

2025-08-10 01:49:15 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 41575 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 01:49:15 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 01:49:15 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 01:49:15 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 01:49:15 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 24 ms. Found 3 JPA repository interfaces.
2025-08-10 01:49:15 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=3aea7bf1-352f-37ec-b393-0b60bc142e55
2025-08-10 01:49:15 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 01:49:15 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 01:49:15 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 01:49:15 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 01:49:15 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 546 ms
2025-08-10 01:49:15 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 01:49:15 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 01:49:15 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 01:49:16 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 01:49:16 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 01:49:16 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@2ba9f743
2025-08-10 01:49:16 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 01:49:16 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 01:49:16 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 01:49:16 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 01:49:16 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 01:49:16 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 01:49:16 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 01:49:17 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 01:49:17 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/chat] in 'webSocketHandlerMapping'
2025-08-10 01:49:17 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 01:49:17 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 01:49:17 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 01:49:17 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 01:49:17 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-08-10 01:49:17 [main] INFO  c.example.unithon.UnithonApplication - Started UnithonApplication in 2.821 seconds (process running for 3.137)
2025-08-10 01:54:03 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-10 01:54:03 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-10 01:54:03 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 01:54:03 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-10 01:54:03 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-10 01:54:05 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 44152 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 01:54:05 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 01:54:05 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 01:54:05 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 01:54:05 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 16 ms. Found 3 JPA repository interfaces.
2025-08-10 01:54:05 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=3aea7bf1-352f-37ec-b393-0b60bc142e55
2025-08-10 01:54:06 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 01:54:06 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 01:54:06 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 01:54:06 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 01:54:06 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 565 ms
2025-08-10 01:54:06 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 01:54:06 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 01:54:06 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 01:54:06 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 01:54:06 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 01:54:06 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@72b1df49
2025-08-10 01:54:06 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 01:54:06 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 01:54:06 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 01:54:06 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 01:54:06 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 01:54:07 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 01:54:07 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 01:54:07 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 01:54:07 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/chat] in 'webSocketHandlerMapping'
2025-08-10 01:54:07 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 01:54:07 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 01:54:07 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 01:54:07 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 01:54:08 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-08-10 01:54:08 [main] INFO  c.example.unithon.UnithonApplication - Started UnithonApplication in 3.073 seconds (process running for 3.601)
2025-08-10 02:06:01 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-10 02:06:01 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-10 02:06:01 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 02:06:01 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-10 02:06:01 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-10 02:06:03 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 50115 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 02:06:03 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 02:06:03 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 02:06:03 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 02:06:03 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 18 ms. Found 3 JPA repository interfaces.
2025-08-10 02:06:03 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=3aea7bf1-352f-37ec-b393-0b60bc142e55
2025-08-10 02:06:04 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 02:06:04 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 02:06:04 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 02:06:04 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 02:06:04 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 611 ms
2025-08-10 02:06:04 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 02:06:04 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 02:06:04 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 02:06:04 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 02:06:04 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 02:06:04 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@3458dab6
2025-08-10 02:06:04 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 02:06:04 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 02:06:04 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 02:06:04 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 02:06:04 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 02:06:04 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 02:06:05 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 02:06:05 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 02:06:05 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/chat] in 'webSocketHandlerMapping'
2025-08-10 02:06:05 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 02:06:05 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 02:06:05 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 02:06:05 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 02:06:06 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-08-10 02:06:06 [main] INFO  c.example.unithon.UnithonApplication - Started UnithonApplication in 3.02 seconds (process running for 3.571)
2025-08-10 02:06:55 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-10 02:06:55 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-10 02:06:55 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 02:06:55 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-10 02:06:55 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-10 02:07:05 [Test worker] INFO  c.e.unithon.UnithonApplicationTests - Starting UnithonApplicationTests using Java 21.0.4 with PID 50775 (started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 02:07:05 [Test worker] DEBUG c.e.unithon.UnithonApplicationTests - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 02:07:05 [Test worker] INFO  c.e.unithon.UnithonApplicationTests - No active profile set, falling back to 1 default profile: "default"
2025-08-10 02:07:05 [Test worker] DEBUG o.s.w.c.s.GenericWebApplicationContext - Refreshing org.springframework.web.context.support.GenericWebApplicationContext@4c777e7b
2025-08-10 02:07:05 [Test worker] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 02:07:05 [Test worker] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 17 ms. Found 3 JPA repository interfaces.
2025-08-10 02:07:05 [Test worker] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=79b2becc-2598-3dce-a109-4221bb649dbc
2025-08-10 02:07:05 [Test worker] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 02:07:05 [Test worker] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 02:07:05 [Test worker] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 02:07:05 [Test worker] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 02:07:05 [Test worker] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 02:07:05 [Test worker] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@2173e4d5
2025-08-10 02:07:05 [Test worker] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 02:07:05 [Test worker] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 02:07:05 [Test worker] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 02:07:05 [Test worker] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 02:07:06 [Test worker] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 02:07:06 [Test worker] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 02:07:06 [Test worker] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 02:07:06 [Test worker] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 02:07:06 [Test worker] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/chat] in 'webSocketHandlerMapping'
2025-08-10 02:07:07 [Test worker] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 02:07:07 [Test worker] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 02:07:07 [Test worker] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 02:07:07 [Test worker] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 02:07:07 [Test worker] INFO  c.e.unithon.UnithonApplicationTests - Started UnithonApplicationTests in 2.788 seconds (process running for 3.351)
2025-08-10 02:07:08 [SpringApplicationShutdownHook] DEBUG o.s.w.c.s.GenericWebApplicationContext - Closing org.springframework.web.context.support.GenericWebApplicationContext@4c777e7b, started on Sun Aug 10 02:07:05 KST 2025
2025-08-10 02:07:08 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 02:07:08 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-10 02:07:08 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-10 02:07:20 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 51238 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 02:07:20 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 02:07:20 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 02:07:20 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 02:07:20 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 19 ms. Found 3 JPA repository interfaces.
2025-08-10 02:07:20 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=112049d1-3845-3d87-8e05-9cb5de088356
2025-08-10 02:07:21 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 02:07:21 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 02:07:21 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 02:07:21 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 02:07:21 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 523 ms
2025-08-10 02:07:21 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 02:07:21 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 02:07:21 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 02:07:21 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 02:07:21 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 02:07:21 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@351e86b2
2025-08-10 02:07:21 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 02:07:21 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 02:07:21 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 02:07:21 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 02:07:22 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 02:07:22 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 02:07:22 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 02:07:22 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 02:07:22 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/chat] in 'webSocketHandlerMapping'
2025-08-10 02:07:22 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 02:07:22 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 02:07:22 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 02:07:22 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 02:07:23 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-08-10 02:07:23 [main] INFO  c.example.unithon.UnithonApplication - Started UnithonApplication in 3.031 seconds (process running for 3.27)
2025-08-10 02:08:54 [http-nio-8080-exec-5] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-10 02:08:54 [http-nio-8080-exec-5] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-10 02:08:54 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-08-10 02:08:54 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-08-10 02:08:54 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-08-10 02:08:54 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@a426150
2025-08-10 02:08:54 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@4201bd3
2025-08-10 02:08:54 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-08-10 02:08:54 [http-nio-8080-exec-5] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 19 ms
2025-08-10 02:08:54 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/chat", parameters={}
2025-08-10 02:08:54 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.server.support.WebSocketHttpRequestHandler@38794a3
2025-08-10 02:08:54 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHttpRequestHandler - GET /api/chat
2025-08-10 02:08:54 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-08-10 02:08:54 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New StandardWebSocketSession[id=8ad163b2-ba62-344a-ea9f-6a3e7f063053, uri=ws://localhost:8080/api/chat]
2025-08-10 02:08:54 [http-nio-8080-exec-5] INFO  c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 연결 성공: 8ad163b2-ba62-344a-ea9f-6a3e7f063053
2025-08-10 02:08:54 [http-nio-8080-exec-5] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [8ad163b2-ba62-344a-ea9f-6a3e7f063053]: connection
2025-08-10 02:09:28 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 52608 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 02:09:28 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 02:09:28 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 02:09:28 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 02:09:28 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 14 ms. Found 3 JPA repository interfaces.
2025-08-10 02:09:28 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=efb109c1-7d98-3f96-97fc-a61a66401d77
2025-08-10 02:09:29 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 02:09:29 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 02:09:29 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 02:09:29 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 02:09:29 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 521 ms
2025-08-10 02:09:29 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 02:09:29 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 02:09:29 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 02:09:29 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 02:09:29 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 02:09:29 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@7d80e1b3
2025-08-10 02:09:29 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 02:09:29 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 02:09:29 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 02:09:29 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 02:09:29 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 02:09:30 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 02:09:30 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 02:09:30 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 02:09:30 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/chat] in 'webSocketHandlerMapping'
2025-08-10 02:09:30 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 02:09:30 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 02:09:30 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 02:09:30 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 02:09:31 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'
2025-08-10 02:09:31 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 02:09:31 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-10 02:09:31 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-10 02:09:31 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-08-10 02:09:31 [main] ERROR o.s.b.d.LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Web server failed to start. Port 8080 was already in use.

Action:

Identify and stop the process that's listening on port 8080 or configure this application to listen on another port.

2025-08-10 02:10:06 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in StandardWebSocketSession[id=8ad163b2-ba62-344a-ea9f-6a3e7f063053, uri=ws://localhost:8080/api/chat]
java.io.EOFException: null
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.fillReadBuffer(NioEndpoint.java:1331)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.read(NioEndpoint.java:1219)
	at org.apache.tomcat.websocket.server.WsFrameServer.onDataAvailable(WsFrameServer.java:74)
	at org.apache.tomcat.websocket.server.WsFrameServer.doOnDataAvailable(WsFrameServer.java:184)
	at org.apache.tomcat.websocket.server.WsFrameServer.notifyDataAvailable(WsFrameServer.java:164)
	at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.upgradeDispatch(WsHttpUpgradeHandler.java:152)
	at org.apache.coyote.http11.upgrade.UpgradeProcessorInternal.dispatch(UpgradeProcessorInternal.java:60)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:57)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-08-10 02:10:06 [http-nio-8080-exec-6] ERROR c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 전송 오류 [8ad163b2-ba62-344a-ea9f-6a3e7f063053]: null
java.io.EOFException: null
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.fillReadBuffer(NioEndpoint.java:1331)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.read(NioEndpoint.java:1219)
	at org.apache.tomcat.websocket.server.WsFrameServer.onDataAvailable(WsFrameServer.java:74)
	at org.apache.tomcat.websocket.server.WsFrameServer.doOnDataAvailable(WsFrameServer.java:184)
	at org.apache.tomcat.websocket.server.WsFrameServer.notifyDataAvailable(WsFrameServer.java:164)
	at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.upgradeDispatch(WsHttpUpgradeHandler.java:152)
	at org.apache.coyote.http11.upgrade.UpgradeProcessorInternal.dispatch(UpgradeProcessorInternal.java:60)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:57)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-08-10 02:10:06 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - StandardWebSocketSession[id=8ad163b2-ba62-344a-ea9f-6a3e7f063053, uri=ws://localhost:8080/api/chat] closed with CloseStatus[code=1006, reason=null]
2025-08-10 02:10:06 [http-nio-8080-exec-6] INFO  c.e.u.d.chat.service.ChatService - 세션 정리 [8ad163b2-ba62-344a-ea9f-6a3e7f063053]
2025-08-10 02:10:06 [http-nio-8080-exec-6] INFO  c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 연결 종료 [8ad163b2-ba62-344a-ea9f-6a3e7f063053]: CloseStatus[code=1006, reason=null]
2025-08-10 02:10:09 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 53105 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 02:10:09 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 02:10:09 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 02:10:10 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 02:10:10 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 15 ms. Found 3 JPA repository interfaces.
2025-08-10 02:10:10 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=efb109c1-7d98-3f96-97fc-a61a66401d77
2025-08-10 02:10:10 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 02:10:10 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 02:10:10 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 02:10:10 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 02:10:10 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 538 ms
2025-08-10 02:10:10 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 02:10:10 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 02:10:10 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 02:10:10 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 02:10:10 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 02:10:10 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@53432aef
2025-08-10 02:10:10 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 02:10:10 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 02:10:10 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 02:10:10 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 02:10:11 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 02:10:11 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 02:10:11 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 02:10:11 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 02:10:11 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/chat] in 'webSocketHandlerMapping'
2025-08-10 02:10:11 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 02:10:11 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 02:10:11 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 02:10:11 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 02:10:12 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'
2025-08-10 02:10:12 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 02:10:12 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-10 02:10:12 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-10 02:10:12 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-08-10 02:10:12 [main] ERROR o.s.b.d.LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Web server failed to start. Port 8080 was already in use.

Action:

Identify and stop the process that's listening on port 8080 or configure this application to listen on another port.

2025-08-10 02:10:32 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 53377 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 02:10:32 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 02:10:32 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 02:10:33 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 02:10:33 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 17 ms. Found 3 JPA repository interfaces.
2025-08-10 02:10:33 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=efb109c1-7d98-3f96-97fc-a61a66401d77
2025-08-10 02:10:33 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 02:10:33 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 02:10:33 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 02:10:33 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 02:10:33 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 490 ms
2025-08-10 02:10:33 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 02:10:33 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 02:10:33 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 02:10:33 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 02:10:33 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 02:10:33 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@53432aef
2025-08-10 02:10:33 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 02:10:33 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 02:10:33 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 02:10:33 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 02:10:34 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 02:10:34 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 02:10:34 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 02:10:34 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 02:10:34 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/chat] in 'webSocketHandlerMapping'
2025-08-10 02:10:34 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 02:10:34 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 02:10:34 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 02:10:34 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 02:10:35 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-08-10 02:10:35 [main] INFO  c.example.unithon.UnithonApplication - Started UnithonApplication in 2.633 seconds (process running for 2.941)
2025-08-10 02:10:44 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-10 02:10:44 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-10 02:10:44 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-08-10 02:10:44 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-08-10 02:10:44 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-08-10 02:10:44 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@1330d15e
2025-08-10 02:10:44 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@19f19f89
2025-08-10 02:10:44 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-08-10 02:10:44 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-08-10 02:10:44 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/websocket-test.html", parameters={}
2025-08-10 02:10:44 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [static/]]
2025-08-10 02:10:44 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-08-10 02:10:44 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/chat", parameters={}
2025-08-10 02:10:44 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.server.support.WebSocketHttpRequestHandler@1f9a472e
2025-08-10 02:10:44 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHttpRequestHandler - GET /api/chat
2025-08-10 02:10:44 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-08-10 02:10:44 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New StandardWebSocketSession[id=9474ff46-14fd-4153-bf78-4320dda6c0e1, uri=ws://localhost:8080/api/chat]
2025-08-10 02:10:44 [http-nio-8080-exec-2] INFO  c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 연결 성공: 9474ff46-14fd-4153-bf78-4320dda6c0e1
2025-08-10 02:10:44 [http-nio-8080-exec-2] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [9474ff46-14fd-4153-bf78-4320dda6c0e1]: connection
2025-08-10 02:10:53 [http-nio-8080-exec-5] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [9474ff46-14fd-4153-bf78-4320dda6c0e1]: {"type":"client.text","message":"치즈버거 주세요"}
2025-08-10 02:10:53 [http-nio-8080-exec-5] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [9474ff46-14fd-4153-bf78-4320dda6c0e1]: 치즈버거 주세요
2025-08-10 02:10:53 [http-nio-8080-exec-5] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 시작 [9474ff46-14fd-4153-bf78-4320dda6c0e1]: 치즈버거 주세요
2025-08-10 02:10:54 [http-nio-8080-exec-5] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 치즈버거 주세요
2025-08-10 02:10:54 [http-nio-8080-exec-5] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자가 '치즈버거 주세요'를 주문했습니다.
이것은 맥도날드 매장입니다. 다음은 현재 판매 중인 메뉴입니다:

버거/세트: 빅맥, 쿼터파운더, 맥스파이시 상하이 버거, 불고기 버거
커피: 아메리카노, 카페라떼, 카푸치노, 캐러멜 마키아토
음료: 코카콜라, 코카콜라 제로, 스프라이트, 오렌지 주스
사이드: 프렌치프라이, 치킨 너겟, 애플파이
디저트: 맥플러리 오레오, 소프트 콘

판단 기준:
1. 요청한 음식이 맥도날드에서 파는 종류의 음식인가?
2. 위 메뉴와 유사한 것이 있는가?

응답 규칙:
- 맥도날드와 전혀 관련 없는 음식(짜장면, 김치찌개, 초밥 등)이면 → NO_MATCH
- 유사한 메뉴가 있으면 → 다음 기준으로 추천:
  1. 카테고리가 같은 메뉴를 우선 추천 (커피→커피, 버거→버거)
  2. 맛, 재료, 특성이 유사한 메뉴를 선택
  3. 가격대가 비슷한 메뉴를 우선 고려
  4. 반드시 위 메뉴 목록에 있는 정확한 메뉴명만 추천

예시:
바닐라 라떼' → '카페라떼', '캐러멜 마키아토' 추천
'치즈버거' → '빅맥', '불고기 버거' 추천
'짜장면' → NO_MATCH (맥도날드 음식이 아님)
'김치찌개' → NO_MATCH (맥도날드 음식이 아님)

응답 형식: JSON
{
  "recommended": ["메뉴명1", "메뉴명2"] 또는 "NO_MATCH",
  "reason": "판단 이유"
}
2025-08-10 02:10:55 [http-nio-8080-exec-5] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 02:10:55 [http-nio-8080-exec-5] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: ```json
{
  "recommended": ["빅맥", "불고기 버거"],
  "reason": "주문하신 '치즈버거'는 맥도날드 메뉴에는 없지만, 버거 종류이므로 맥도날드에서 판매하는 다른 버거인 '빅맥'과 '불고기 버거'를 추천합니다."
}
```

2025-08-10 02:10:55 [http-nio-8080-exec-5] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: ```json
{
  "recommended": ["빅맥", "불고기 버거"],
  "reason": "주문하신 '치즈버거'는 맥도날드 메뉴에는 없지만, 버거 종류이므로 맥도날드에서 판매하는 다른 버거인 '빅맥'과 '불고기 버거'를 추천합니다."
}
```

2025-08-10 02:10:55 [http-nio-8080-exec-5] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답에서 파싱된 추천 메뉴: [빅맥, 불고기 버거]
2025-08-10 02:10:55 [http-nio-8080-exec-5] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [9474ff46-14fd-4153-bf78-4320dda6c0e1]: bot.reply
2025-08-10 02:11:35 [http-nio-8080-exec-6] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [9474ff46-14fd-4153-bf78-4320dda6c0e1]: {"type":"client.text","message":"빅맥주세요"}
2025-08-10 02:11:35 [http-nio-8080-exec-6] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [9474ff46-14fd-4153-bf78-4320dda6c0e1]: 빅맥주세요
2025-08-10 02:11:35 [http-nio-8080-exec-6] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 시작 [9474ff46-14fd-4153-bf78-4320dda6c0e1]: 빅맥주세요
2025-08-10 02:11:35 [http-nio-8080-exec-6] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 빅맥주세요
2025-08-10 02:11:35 [http-nio-8080-exec-6] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자가 '빅맥주세요'를 주문했습니다.
이것은 맥도날드 매장입니다. 다음은 현재 판매 중인 메뉴입니다:

버거/세트: 빅맥, 쿼터파운더, 맥스파이시 상하이 버거, 불고기 버거
커피: 아메리카노, 카페라떼, 카푸치노, 캐러멜 마키아토
음료: 코카콜라, 코카콜라 제로, 스프라이트, 오렌지 주스
사이드: 프렌치프라이, 치킨 너겟, 애플파이
디저트: 맥플러리 오레오, 소프트 콘

판단 기준:
1. 요청한 음식이 맥도날드에서 파는 종류의 음식인가?
2. 위 메뉴와 유사한 것이 있는가?

응답 규칙:
- 맥도날드와 전혀 관련 없는 음식(짜장면, 김치찌개, 초밥 등)이면 → NO_MATCH
- 유사한 메뉴가 있으면 → 다음 기준으로 추천:
  1. 카테고리가 같은 메뉴를 우선 추천 (커피→커피, 버거→버거)
  2. 맛, 재료, 특성이 유사한 메뉴를 선택
  3. 가격대가 비슷한 메뉴를 우선 고려
  4. 반드시 위 메뉴 목록에 있는 정확한 메뉴명만 추천

예시:
바닐라 라떼' → '카페라떼', '캐러멜 마키아토' 추천
'치즈버거' → '빅맥', '불고기 버거' 추천
'짜장면' → NO_MATCH (맥도날드 음식이 아님)
'김치찌개' → NO_MATCH (맥도날드 음식이 아님)

응답 형식: JSON
{
  "recommended": ["메뉴명1", "메뉴명2"] 또는 "NO_MATCH",
  "reason": "판단 이유"
}
2025-08-10 02:11:36 [http-nio-8080-exec-6] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 02:11:36 [http-nio-8080-exec-6] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: ```json
{
  "recommended": ["빅맥"],
  "reason": "사용자가 빅맥을 주문했고, 빅맥은 메뉴에 있습니다."
}
```

2025-08-10 02:11:36 [http-nio-8080-exec-6] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: ```json
{
  "recommended": ["빅맥"],
  "reason": "사용자가 빅맥을 주문했고, 빅맥은 메뉴에 있습니다."
}
```

2025-08-10 02:11:36 [http-nio-8080-exec-6] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답에서 파싱된 추천 메뉴: [빅맥]
2025-08-10 02:11:36 [http-nio-8080-exec-6] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [9474ff46-14fd-4153-bf78-4320dda6c0e1]: bot.reply
2025-08-10 02:11:48 [http-nio-8080-exec-7] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [9474ff46-14fd-4153-bf78-4320dda6c0e1]: {"type":"client.command","action":"confirm"}
2025-08-10 02:11:48 [http-nio-8080-exec-7] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 명령 메시지 처리 [9474ff46-14fd-4153-bf78-4320dda6c0e1]: confirm
2025-08-10 02:11:48 [http-nio-8080-exec-7] INFO  c.e.u.d.chat.service.ChatService - 주문 확정 [9474ff46-14fd-4153-bf78-4320dda6c0e1]
2025-08-10 02:11:48 [http-nio-8080-exec-7] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [9474ff46-14fd-4153-bf78-4320dda6c0e1]: macro.trigger
2025-08-10 02:11:59 [http-nio-8080-exec-8] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [9474ff46-14fd-4153-bf78-4320dda6c0e1]: {"type":"client.command","action":"repeat"}
2025-08-10 02:11:59 [http-nio-8080-exec-8] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 명령 메시지 처리 [9474ff46-14fd-4153-bf78-4320dda6c0e1]: repeat
2025-08-10 02:11:59 [http-nio-8080-exec-8] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [9474ff46-14fd-4153-bf78-4320dda6c0e1]: bot.reply
2025-08-10 02:12:07 [http-nio-8080-exec-9] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [9474ff46-14fd-4153-bf78-4320dda6c0e1]: {"type":"client.text","message":"하이"}
2025-08-10 02:12:07 [http-nio-8080-exec-9] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [9474ff46-14fd-4153-bf78-4320dda6c0e1]: 하이
2025-08-10 02:12:07 [http-nio-8080-exec-9] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 시작 [9474ff46-14fd-4153-bf78-4320dda6c0e1]: 하이
2025-08-10 02:12:08 [http-nio-8080-exec-9] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 하이
2025-08-10 02:12:08 [http-nio-8080-exec-9] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자가 '하이'를 주문했습니다.
이것은 맥도날드 매장입니다. 다음은 현재 판매 중인 메뉴입니다:

버거/세트: 빅맥, 쿼터파운더, 맥스파이시 상하이 버거, 불고기 버거
커피: 아메리카노, 카페라떼, 카푸치노, 캐러멜 마키아토
음료: 코카콜라, 코카콜라 제로, 스프라이트, 오렌지 주스
사이드: 프렌치프라이, 치킨 너겟, 애플파이
디저트: 맥플러리 오레오, 소프트 콘

판단 기준:
1. 요청한 음식이 맥도날드에서 파는 종류의 음식인가?
2. 위 메뉴와 유사한 것이 있는가?

응답 규칙:
- 맥도날드와 전혀 관련 없는 음식(짜장면, 김치찌개, 초밥 등)이면 → NO_MATCH
- 유사한 메뉴가 있으면 → 다음 기준으로 추천:
  1. 카테고리가 같은 메뉴를 우선 추천 (커피→커피, 버거→버거)
  2. 맛, 재료, 특성이 유사한 메뉴를 선택
  3. 가격대가 비슷한 메뉴를 우선 고려
  4. 반드시 위 메뉴 목록에 있는 정확한 메뉴명만 추천

예시:
바닐라 라떼' → '카페라떼', '캐러멜 마키아토' 추천
'치즈버거' → '빅맥', '불고기 버거' 추천
'짜장면' → NO_MATCH (맥도날드 음식이 아님)
'김치찌개' → NO_MATCH (맥도날드 음식이 아님)

응답 형식: JSON
{
  "recommended": ["메뉴명1", "메뉴명2"] 또는 "NO_MATCH",
  "reason": "판단 이유"
}
2025-08-10 02:12:09 [http-nio-8080-exec-9] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 02:12:09 [http-nio-8080-exec-9] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: ```json
{
  "recommended": "NO_MATCH",
  "reason": "맥도날드 메뉴에 '하이'라는 음식이 없습니다."
}
```

2025-08-10 02:12:09 [http-nio-8080-exec-9] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: ```json
{
  "recommended": "NO_MATCH",
  "reason": "맥도날드 메뉴에 '하이'라는 음식이 없습니다."
}
```

2025-08-10 02:12:09 [http-nio-8080-exec-9] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: 맥도날드 메뉴와 관련 없는 요청으로 판단됨
2025-08-10 02:12:09 [http-nio-8080-exec-9] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [9474ff46-14fd-4153-bf78-4320dda6c0e1]: bot.reply
2025-08-10 02:12:18 [http-nio-8080-exec-10] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [9474ff46-14fd-4153-bf78-4320dda6c0e1]: {"type":"client.text","message":"불고기버거 주세요"}
2025-08-10 02:12:18 [http-nio-8080-exec-10] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [9474ff46-14fd-4153-bf78-4320dda6c0e1]: 불고기버거 주세요
2025-08-10 02:12:18 [http-nio-8080-exec-10] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 시작 [9474ff46-14fd-4153-bf78-4320dda6c0e1]: 불고기버거 주세요
2025-08-10 02:12:18 [http-nio-8080-exec-10] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 불고기버거 주세요
2025-08-10 02:12:18 [http-nio-8080-exec-10] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자가 '불고기버거 주세요'를 주문했습니다.
이것은 맥도날드 매장입니다. 다음은 현재 판매 중인 메뉴입니다:

버거/세트: 빅맥, 쿼터파운더, 맥스파이시 상하이 버거, 불고기 버거
커피: 아메리카노, 카페라떼, 카푸치노, 캐러멜 마키아토
음료: 코카콜라, 코카콜라 제로, 스프라이트, 오렌지 주스
사이드: 프렌치프라이, 치킨 너겟, 애플파이
디저트: 맥플러리 오레오, 소프트 콘

판단 기준:
1. 요청한 음식이 맥도날드에서 파는 종류의 음식인가?
2. 위 메뉴와 유사한 것이 있는가?

응답 규칙:
- 맥도날드와 전혀 관련 없는 음식(짜장면, 김치찌개, 초밥 등)이면 → NO_MATCH
- 유사한 메뉴가 있으면 → 다음 기준으로 추천:
  1. 카테고리가 같은 메뉴를 우선 추천 (커피→커피, 버거→버거)
  2. 맛, 재료, 특성이 유사한 메뉴를 선택
  3. 가격대가 비슷한 메뉴를 우선 고려
  4. 반드시 위 메뉴 목록에 있는 정확한 메뉴명만 추천

예시:
바닐라 라떼' → '카페라떼', '캐러멜 마키아토' 추천
'치즈버거' → '빅맥', '불고기 버거' 추천
'짜장면' → NO_MATCH (맥도날드 음식이 아님)
'김치찌개' → NO_MATCH (맥도날드 음식이 아님)

응답 형식: JSON
{
  "recommended": ["메뉴명1", "메뉴명2"] 또는 "NO_MATCH",
  "reason": "판단 이유"
}
2025-08-10 02:12:19 [http-nio-8080-exec-10] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 02:12:19 [http-nio-8080-exec-10] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: ```json
{
  "recommended": ["불고기 버거"],
  "reason": "주문하신 '불고기 버거'는 맥도날드에서 판매하는 메뉴입니다."
}
```

2025-08-10 02:12:19 [http-nio-8080-exec-10] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: ```json
{
  "recommended": ["불고기 버거"],
  "reason": "주문하신 '불고기 버거'는 맥도날드에서 판매하는 메뉴입니다."
}
```

2025-08-10 02:12:19 [http-nio-8080-exec-10] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답에서 파싱된 추천 메뉴: [불고기 버거]
2025-08-10 02:12:19 [http-nio-8080-exec-10] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [9474ff46-14fd-4153-bf78-4320dda6c0e1]: bot.reply
2025-08-10 02:12:36 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-10 02:12:36 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-10 02:12:36 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 02:12:36 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-10 02:12:36 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-10 02:12:36 [SpringApplicationShutdownHook] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in StandardWebSocketSession[id=9474ff46-14fd-4153-bf78-4320dda6c0e1, uri=ws://localhost:8080/api/chat]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:542)
	at org.apache.tomcat.websocket.WsSession.close(WsSession.java:530)
	at org.apache.tomcat.websocket.WsWebSocketContainer.destroy(WsWebSocketContainer.java:1022)
	at org.apache.tomcat.websocket.server.WsContextListener.contextDestroyed(WsContextListener.java:46)
	at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4090)
	at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:4700)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1219)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1208)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:814)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1219)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1208)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:814)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardService.stopInternal(StandardService.java:468)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardServer.stopInternal(StandardServer.java:915)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.startup.Tomcat.stop(Tomcat.java:448)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.stopTomcat(TomcatWebServer.java:301)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.destroy(TomcatWebServer.java:374)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:182)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.SpringApplicationShutdownHook.closeAndWait(SpringApplicationShutdownHook.java:147)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.boot.SpringApplicationShutdownHook.run(SpringApplicationShutdownHook.java:116)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 37 common frames omitted
2025-08-10 02:12:36 [SpringApplicationShutdownHook] ERROR c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 전송 오류 [9474ff46-14fd-4153-bf78-4320dda6c0e1]: java.nio.channels.ClosedChannelException
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:542)
	at org.apache.tomcat.websocket.WsSession.close(WsSession.java:530)
	at org.apache.tomcat.websocket.WsWebSocketContainer.destroy(WsWebSocketContainer.java:1022)
	at org.apache.tomcat.websocket.server.WsContextListener.contextDestroyed(WsContextListener.java:46)
	at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4090)
	at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:4700)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1219)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1208)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:814)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1219)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1208)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:814)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardService.stopInternal(StandardService.java:468)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardServer.stopInternal(StandardServer.java:915)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.startup.Tomcat.stop(Tomcat.java:448)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.stopTomcat(TomcatWebServer.java:301)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.destroy(TomcatWebServer.java:374)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:182)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.SpringApplicationShutdownHook.closeAndWait(SpringApplicationShutdownHook.java:147)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.boot.SpringApplicationShutdownHook.run(SpringApplicationShutdownHook.java:116)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 37 common frames omitted
2025-08-10 02:12:36 [SpringApplicationShutdownHook] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - StandardWebSocketSession[id=9474ff46-14fd-4153-bf78-4320dda6c0e1, uri=ws://localhost:8080/api/chat] closed with CloseStatus[code=1001, reason=The web application is stopping]
2025-08-10 02:12:36 [SpringApplicationShutdownHook] INFO  c.e.u.d.chat.service.ChatService - 세션 정리 [9474ff46-14fd-4153-bf78-4320dda6c0e1]
2025-08-10 02:12:36 [SpringApplicationShutdownHook] INFO  c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 연결 종료 [9474ff46-14fd-4153-bf78-4320dda6c0e1]: CloseStatus[code=1001, reason=The web application is stopping]
2025-08-10 02:41:52 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 69472 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 02:41:52 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 02:41:52 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 02:41:53 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 02:41:53 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 16 ms. Found 3 JPA repository interfaces.
2025-08-10 02:41:53 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=efb109c1-7d98-3f96-97fc-a61a66401d77
2025-08-10 02:41:53 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 02:41:53 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 02:41:53 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 02:41:53 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 02:41:53 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 565 ms
2025-08-10 02:41:53 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 02:41:53 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 02:41:53 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 02:41:53 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 02:41:53 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 02:41:53 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@3340ce58
2025-08-10 02:41:53 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 02:41:53 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 02:41:53 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 02:41:53 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 02:41:54 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 02:41:54 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 02:41:54 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 02:41:54 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 02:41:54 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/chat] in 'webSocketHandlerMapping'
2025-08-10 02:41:54 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 02:41:54 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 02:41:54 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 02:41:54 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 02:41:55 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-08-10 02:41:55 [main] INFO  c.example.unithon.UnithonApplication - Started UnithonApplication in 2.887 seconds (process running for 3.516)
2025-08-10 02:42:25 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-10 02:42:25 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-10 02:42:25 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-08-10 02:42:25 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-08-10 02:42:25 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-08-10 02:42:25 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@465b16bb
2025-08-10 02:42:25 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@373efaa2
2025-08-10 02:42:25 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-08-10 02:42:25 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-08-10 02:42:25 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/websocket-test.html", parameters={}
2025-08-10 02:42:25 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [static/]]
2025-08-10 02:42:25 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-08-10 02:42:25 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/chat", parameters={}
2025-08-10 02:42:25 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.server.support.WebSocketHttpRequestHandler@69765d94
2025-08-10 02:42:25 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHttpRequestHandler - GET /api/chat
2025-08-10 02:42:25 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-08-10 02:42:25 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New StandardWebSocketSession[id=79f27196-9785-3f7c-7a11-fdf2173d310d, uri=ws://localhost:8080/api/chat]
2025-08-10 02:42:25 [http-nio-8080-exec-2] INFO  c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 연결 성공: 79f27196-9785-3f7c-7a11-fdf2173d310d
2025-08-10 02:42:25 [http-nio-8080-exec-2] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [79f27196-9785-3f7c-7a11-fdf2173d310d]: connection
2025-08-10 02:42:34 [http-nio-8080-exec-5] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [79f27196-9785-3f7c-7a11-fdf2173d310d]: {"type":"client.text","message":"아아 주세요"}
2025-08-10 02:42:34 [http-nio-8080-exec-5] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [79f27196-9785-3f7c-7a11-fdf2173d310d]: 아아 주세요
2025-08-10 02:42:34 [http-nio-8080-exec-5] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 시작 [79f27196-9785-3f7c-7a11-fdf2173d310d]: 아아 주세요
2025-08-10 02:42:34 [http-nio-8080-exec-5] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 아아 주세요
2025-08-10 02:42:34 [http-nio-8080-exec-5] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자가 '아아 주세요'를 주문했습니다.
이것은 맥도날드 매장입니다. 다음은 현재 판매 중인 메뉴입니다:

버거/세트: 빅맥, 쿼터파운더, 맥스파이시 상하이 버거, 불고기 버거
커피: 아메리카노, 카페라떼, 카푸치노, 캐러멜 마키아토
음료: 코카콜라, 코카콜라 제로, 스프라이트, 오렌지 주스
사이드: 프렌치프라이, 치킨 너겟, 애플파이
디저트: 맥플러리 오레오, 소프트 콘

판단 기준:
1. 요청한 음식이 맥도날드에서 파는 종류의 음식인가?
2. 위 메뉴와 유사한 것이 있는가?

응답 규칙:
- 맥도날드와 전혀 관련 없는 음식(짜장면, 김치찌개, 초밥 등)이면 → NO_MATCH
- 유사한 메뉴가 있으면 → 다음 기준으로 추천:
  1. 카테고리가 같은 메뉴를 우선 추천 (커피→커피, 버거→버거)
  2. 맛, 재료, 특성이 유사한 메뉴를 선택
  3. 가격대가 비슷한 메뉴를 우선 고려
  4. 반드시 위 메뉴 목록에 있는 정확한 메뉴명만 추천

예시:
바닐라 라떼' → '카페라떼', '캐러멜 마키아토' 추천
'치즈버거' → '빅맥', '불고기 버거' 추천
'짜장면' → NO_MATCH (맥도날드 음식이 아님)
'김치찌개' → NO_MATCH (맥도날드 음식이 아님)

응답 형식: JSON
{
  "recommended": ["메뉴명1", "메뉴명2"] 또는 "NO_MATCH",
  "reason": "판단 이유"
}
2025-08-10 02:42:36 [http-nio-8080-exec-5] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 02:42:36 [http-nio-8080-exec-5] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: ```json
{
  "recommended": ["아메리카노"],
  "reason": "'아아'는 '아메리카노'의 줄임말로, 커피 메뉴에 해당합니다."
}
```

2025-08-10 02:42:36 [http-nio-8080-exec-5] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: ```json
{
  "recommended": ["아메리카노"],
  "reason": "'아아'는 '아메리카노'의 줄임말로, 커피 메뉴에 해당합니다."
}
```

2025-08-10 02:42:36 [http-nio-8080-exec-5] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답에서 파싱된 추천 메뉴: [아메리카노]
2025-08-10 02:42:36 [http-nio-8080-exec-5] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [79f27196-9785-3f7c-7a11-fdf2173d310d]: bot.reply
2025-08-10 02:42:44 [http-nio-8080-exec-6] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [79f27196-9785-3f7c-7a11-fdf2173d310d]: {"type":"client.text","message":"아이스 아메리카노요"}
2025-08-10 02:42:44 [http-nio-8080-exec-6] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [79f27196-9785-3f7c-7a11-fdf2173d310d]: 아이스 아메리카노요
2025-08-10 02:42:44 [http-nio-8080-exec-6] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 시작 [79f27196-9785-3f7c-7a11-fdf2173d310d]: 아이스 아메리카노요
2025-08-10 02:42:44 [http-nio-8080-exec-6] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 아이스 아메리카노요
2025-08-10 02:42:44 [http-nio-8080-exec-6] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자가 '아이스 아메리카노요'를 주문했습니다.
이것은 맥도날드 매장입니다. 다음은 현재 판매 중인 메뉴입니다:

버거/세트: 빅맥, 쿼터파운더, 맥스파이시 상하이 버거, 불고기 버거
커피: 아메리카노, 카페라떼, 카푸치노, 캐러멜 마키아토
음료: 코카콜라, 코카콜라 제로, 스프라이트, 오렌지 주스
사이드: 프렌치프라이, 치킨 너겟, 애플파이
디저트: 맥플러리 오레오, 소프트 콘

판단 기준:
1. 요청한 음식이 맥도날드에서 파는 종류의 음식인가?
2. 위 메뉴와 유사한 것이 있는가?

응답 규칙:
- 맥도날드와 전혀 관련 없는 음식(짜장면, 김치찌개, 초밥 등)이면 → NO_MATCH
- 유사한 메뉴가 있으면 → 다음 기준으로 추천:
  1. 카테고리가 같은 메뉴를 우선 추천 (커피→커피, 버거→버거)
  2. 맛, 재료, 특성이 유사한 메뉴를 선택
  3. 가격대가 비슷한 메뉴를 우선 고려
  4. 반드시 위 메뉴 목록에 있는 정확한 메뉴명만 추천

예시:
바닐라 라떼' → '카페라떼', '캐러멜 마키아토' 추천
'치즈버거' → '빅맥', '불고기 버거' 추천
'짜장면' → NO_MATCH (맥도날드 음식이 아님)
'김치찌개' → NO_MATCH (맥도날드 음식이 아님)

응답 형식: JSON
{
  "recommended": ["메뉴명1", "메뉴명2"] 또는 "NO_MATCH",
  "reason": "판단 이유"
}
2025-08-10 02:42:45 [http-nio-8080-exec-6] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 02:42:45 [http-nio-8080-exec-6] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: ```json
{
  "recommended": ["아메리카노"],
  "reason": "고객이 주문한 '아이스 아메리카노'는 메뉴에 있는 '아메리카노'와 일치합니다.  '아이스'는 맥도날드에서 제공하는 일반적인 커피 주문 방식이므로,  '아메리카노'를 추천합니다."
}
```

2025-08-10 02:42:45 [http-nio-8080-exec-6] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: ```json
{
  "recommended": ["아메리카노"],
  "reason": "고객이 주문한 '아이스 아메리카노'는 메뉴에 있는 '아메리카노'와 일치합니다.  '아이스'는 맥도날드에서 제공하는 일반적인 커피 주문 방식이므로,  '아메리카노'를 추천합니다."
}
```

2025-08-10 02:42:45 [http-nio-8080-exec-6] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답에서 파싱된 추천 메뉴: [아메리카노]
2025-08-10 02:42:45 [http-nio-8080-exec-6] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [79f27196-9785-3f7c-7a11-fdf2173d310d]: bot.reply
2025-08-10 02:43:10 [http-nio-8080-exec-7] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [79f27196-9785-3f7c-7a11-fdf2173d310d]: {"type":"client.text","message":"라떼 주세요"}
2025-08-10 02:43:10 [http-nio-8080-exec-7] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [79f27196-9785-3f7c-7a11-fdf2173d310d]: 라떼 주세요
2025-08-10 02:43:10 [http-nio-8080-exec-7] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 시작 [79f27196-9785-3f7c-7a11-fdf2173d310d]: 라떼 주세요
2025-08-10 02:43:10 [http-nio-8080-exec-7] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 라떼 주세요
2025-08-10 02:43:10 [http-nio-8080-exec-7] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자가 '라떼 주세요'를 주문했습니다.
이것은 맥도날드 매장입니다. 다음은 현재 판매 중인 메뉴입니다:

버거/세트: 빅맥, 쿼터파운더, 맥스파이시 상하이 버거, 불고기 버거
커피: 아메리카노, 카페라떼, 카푸치노, 캐러멜 마키아토
음료: 코카콜라, 코카콜라 제로, 스프라이트, 오렌지 주스
사이드: 프렌치프라이, 치킨 너겟, 애플파이
디저트: 맥플러리 오레오, 소프트 콘

판단 기준:
1. 요청한 음식이 맥도날드에서 파는 종류의 음식인가?
2. 위 메뉴와 유사한 것이 있는가?

응답 규칙:
- 맥도날드와 전혀 관련 없는 음식(짜장면, 김치찌개, 초밥 등)이면 → NO_MATCH
- 유사한 메뉴가 있으면 → 다음 기준으로 추천:
  1. 카테고리가 같은 메뉴를 우선 추천 (커피→커피, 버거→버거)
  2. 맛, 재료, 특성이 유사한 메뉴를 선택
  3. 가격대가 비슷한 메뉴를 우선 고려
  4. 반드시 위 메뉴 목록에 있는 정확한 메뉴명만 추천

예시:
바닐라 라떼' → '카페라떼', '캐러멜 마키아토' 추천
'치즈버거' → '빅맥', '불고기 버거' 추천
'짜장면' → NO_MATCH (맥도날드 음식이 아님)
'김치찌개' → NO_MATCH (맥도날드 음식이 아님)

응답 형식: JSON
{
  "recommended": ["메뉴명1", "메뉴명2"] 또는 "NO_MATCH",
  "reason": "판단 이유"
}
2025-08-10 02:43:11 [http-nio-8080-exec-7] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 02:43:11 [http-nio-8080-exec-7] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: ```json
{
  "recommended": ["카페라떼"],
  "reason": "고객이 주문한 '라떼'는 맥도날드 메뉴에 있는 '카페라떼'와 일치합니다."
}
```

2025-08-10 02:43:11 [http-nio-8080-exec-7] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: ```json
{
  "recommended": ["카페라떼"],
  "reason": "고객이 주문한 '라떼'는 맥도날드 메뉴에 있는 '카페라떼'와 일치합니다."
}
```

2025-08-10 02:43:11 [http-nio-8080-exec-7] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답에서 파싱된 추천 메뉴: [카페라떼]
2025-08-10 02:43:11 [http-nio-8080-exec-7] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [79f27196-9785-3f7c-7a11-fdf2173d310d]: bot.reply
2025-08-10 02:43:16 [http-nio-8080-exec-8] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [79f27196-9785-3f7c-7a11-fdf2173d310d]: {"type":"client.text","message":"아이스 카페라떼요"}
2025-08-10 02:43:16 [http-nio-8080-exec-8] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [79f27196-9785-3f7c-7a11-fdf2173d310d]: 아이스 카페라떼요
2025-08-10 02:43:16 [http-nio-8080-exec-8] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 시작 [79f27196-9785-3f7c-7a11-fdf2173d310d]: 아이스 카페라떼요
2025-08-10 02:43:16 [http-nio-8080-exec-8] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 아이스 카페라떼요
2025-08-10 02:43:16 [http-nio-8080-exec-8] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자가 '아이스 카페라떼요'를 주문했습니다.
이것은 맥도날드 매장입니다. 다음은 현재 판매 중인 메뉴입니다:

버거/세트: 빅맥, 쿼터파운더, 맥스파이시 상하이 버거, 불고기 버거
커피: 아메리카노, 카페라떼, 카푸치노, 캐러멜 마키아토
음료: 코카콜라, 코카콜라 제로, 스프라이트, 오렌지 주스
사이드: 프렌치프라이, 치킨 너겟, 애플파이
디저트: 맥플러리 오레오, 소프트 콘

판단 기준:
1. 요청한 음식이 맥도날드에서 파는 종류의 음식인가?
2. 위 메뉴와 유사한 것이 있는가?

응답 규칙:
- 맥도날드와 전혀 관련 없는 음식(짜장면, 김치찌개, 초밥 등)이면 → NO_MATCH
- 유사한 메뉴가 있으면 → 다음 기준으로 추천:
  1. 카테고리가 같은 메뉴를 우선 추천 (커피→커피, 버거→버거)
  2. 맛, 재료, 특성이 유사한 메뉴를 선택
  3. 가격대가 비슷한 메뉴를 우선 고려
  4. 반드시 위 메뉴 목록에 있는 정확한 메뉴명만 추천

예시:
바닐라 라떼' → '카페라떼', '캐러멜 마키아토' 추천
'치즈버거' → '빅맥', '불고기 버거' 추천
'짜장면' → NO_MATCH (맥도날드 음식이 아님)
'김치찌개' → NO_MATCH (맥도날드 음식이 아님)

응답 형식: JSON
{
  "recommended": ["메뉴명1", "메뉴명2"] 또는 "NO_MATCH",
  "reason": "판단 이유"
}
2025-08-10 02:43:18 [http-nio-8080-exec-8] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 02:43:18 [http-nio-8080-exec-8] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: ```json
{
  "recommended": ["카페라떼"],
  "reason": "고객이 '아이스 카페라떼'를 주문했고, 메뉴에 '카페라떼'가 있습니다. '아이스'는 메뉴에 명시되어 있지 않지만, 일반적으로 커피 메뉴는 아이스로 주문 가능합니다."
}
```

2025-08-10 02:43:18 [http-nio-8080-exec-8] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: ```json
{
  "recommended": ["카페라떼"],
  "reason": "고객이 '아이스 카페라떼'를 주문했고, 메뉴에 '카페라떼'가 있습니다. '아이스'는 메뉴에 명시되어 있지 않지만, 일반적으로 커피 메뉴는 아이스로 주문 가능합니다."
}
```

2025-08-10 02:43:18 [http-nio-8080-exec-8] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답에서 파싱된 추천 메뉴: [카페라떼]
2025-08-10 02:43:18 [http-nio-8080-exec-8] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [79f27196-9785-3f7c-7a11-fdf2173d310d]: bot.reply
2025-08-10 02:43:48 [http-nio-8080-exec-9] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [79f27196-9785-3f7c-7a11-fdf2173d310d]: {"type":"client.text","message":"치즈버거 주세요"}
2025-08-10 02:43:48 [http-nio-8080-exec-9] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [79f27196-9785-3f7c-7a11-fdf2173d310d]: 치즈버거 주세요
2025-08-10 02:43:48 [http-nio-8080-exec-9] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 시작 [79f27196-9785-3f7c-7a11-fdf2173d310d]: 치즈버거 주세요
2025-08-10 02:43:49 [http-nio-8080-exec-9] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 치즈버거 주세요
2025-08-10 02:43:49 [http-nio-8080-exec-9] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자가 '치즈버거 주세요'를 주문했습니다.
이것은 맥도날드 매장입니다. 다음은 현재 판매 중인 메뉴입니다:

버거/세트: 빅맥, 쿼터파운더, 맥스파이시 상하이 버거, 불고기 버거
커피: 아메리카노, 카페라떼, 카푸치노, 캐러멜 마키아토
음료: 코카콜라, 코카콜라 제로, 스프라이트, 오렌지 주스
사이드: 프렌치프라이, 치킨 너겟, 애플파이
디저트: 맥플러리 오레오, 소프트 콘

판단 기준:
1. 요청한 음식이 맥도날드에서 파는 종류의 음식인가?
2. 위 메뉴와 유사한 것이 있는가?

응답 규칙:
- 맥도날드와 전혀 관련 없는 음식(짜장면, 김치찌개, 초밥 등)이면 → NO_MATCH
- 유사한 메뉴가 있으면 → 다음 기준으로 추천:
  1. 카테고리가 같은 메뉴를 우선 추천 (커피→커피, 버거→버거)
  2. 맛, 재료, 특성이 유사한 메뉴를 선택
  3. 가격대가 비슷한 메뉴를 우선 고려
  4. 반드시 위 메뉴 목록에 있는 정확한 메뉴명만 추천

예시:
바닐라 라떼' → '카페라떼', '캐러멜 마키아토' 추천
'치즈버거' → '빅맥', '불고기 버거' 추천
'짜장면' → NO_MATCH (맥도날드 음식이 아님)
'김치찌개' → NO_MATCH (맥도날드 음식이 아님)

응답 형식: JSON
{
  "recommended": ["메뉴명1", "메뉴명2"] 또는 "NO_MATCH",
  "reason": "판단 이유"
}
2025-08-10 02:43:50 [http-nio-8080-exec-9] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 02:43:50 [http-nio-8080-exec-9] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: ```json
{
  "recommended": ["빅맥", "불고기 버거"],
  "reason": "주문하신 '치즈버거'는 맥도날드 메뉴에는 없지만, 버거 카테고리에 속하며 빅맥과 불고기 버거가 유사한 메뉴이기 때문입니다."
}
```

2025-08-10 02:43:50 [http-nio-8080-exec-9] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: ```json
{
  "recommended": ["빅맥", "불고기 버거"],
  "reason": "주문하신 '치즈버거'는 맥도날드 메뉴에는 없지만, 버거 카테고리에 속하며 빅맥과 불고기 버거가 유사한 메뉴이기 때문입니다."
}
```

2025-08-10 02:43:50 [http-nio-8080-exec-9] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답에서 파싱된 추천 메뉴: [빅맥, 불고기 버거]
2025-08-10 02:43:50 [http-nio-8080-exec-9] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [79f27196-9785-3f7c-7a11-fdf2173d310d]: bot.reply
2025-08-10 02:44:00 [http-nio-8080-exec-10] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [79f27196-9785-3f7c-7a11-fdf2173d310d]: {"type":"client.text","message":"빅맥이요"}
2025-08-10 02:44:00 [http-nio-8080-exec-10] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [79f27196-9785-3f7c-7a11-fdf2173d310d]: 빅맥이요
2025-08-10 02:44:00 [http-nio-8080-exec-10] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 시작 [79f27196-9785-3f7c-7a11-fdf2173d310d]: 빅맥이요
2025-08-10 02:44:00 [http-nio-8080-exec-10] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 빅맥이요
2025-08-10 02:44:00 [http-nio-8080-exec-10] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자가 '빅맥이요'를 주문했습니다.
이것은 맥도날드 매장입니다. 다음은 현재 판매 중인 메뉴입니다:

버거/세트: 빅맥, 쿼터파운더, 맥스파이시 상하이 버거, 불고기 버거
커피: 아메리카노, 카페라떼, 카푸치노, 캐러멜 마키아토
음료: 코카콜라, 코카콜라 제로, 스프라이트, 오렌지 주스
사이드: 프렌치프라이, 치킨 너겟, 애플파이
디저트: 맥플러리 오레오, 소프트 콘

판단 기준:
1. 요청한 음식이 맥도날드에서 파는 종류의 음식인가?
2. 위 메뉴와 유사한 것이 있는가?

응답 규칙:
- 맥도날드와 전혀 관련 없는 음식(짜장면, 김치찌개, 초밥 등)이면 → NO_MATCH
- 유사한 메뉴가 있으면 → 다음 기준으로 추천:
  1. 카테고리가 같은 메뉴를 우선 추천 (커피→커피, 버거→버거)
  2. 맛, 재료, 특성이 유사한 메뉴를 선택
  3. 가격대가 비슷한 메뉴를 우선 고려
  4. 반드시 위 메뉴 목록에 있는 정확한 메뉴명만 추천

예시:
바닐라 라떼' → '카페라떼', '캐러멜 마키아토' 추천
'치즈버거' → '빅맥', '불고기 버거' 추천
'짜장면' → NO_MATCH (맥도날드 음식이 아님)
'김치찌개' → NO_MATCH (맥도날드 음식이 아님)

응답 형식: JSON
{
  "recommended": ["메뉴명1", "메뉴명2"] 또는 "NO_MATCH",
  "reason": "판단 이유"
}
2025-08-10 02:44:02 [http-nio-8080-exec-10] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 02:44:02 [http-nio-8080-exec-10] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: ```json
{
  "recommended": ["빅맥"],
  "reason": "고객이 빅맥을 주문했고, 빅맥은 메뉴에 있습니다."
}
```

2025-08-10 02:44:02 [http-nio-8080-exec-10] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: ```json
{
  "recommended": ["빅맥"],
  "reason": "고객이 빅맥을 주문했고, 빅맥은 메뉴에 있습니다."
}
```

2025-08-10 02:44:02 [http-nio-8080-exec-10] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답에서 파싱된 추천 메뉴: [빅맥]
2025-08-10 02:44:02 [http-nio-8080-exec-10] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [79f27196-9785-3f7c-7a11-fdf2173d310d]: bot.reply
2025-08-10 02:56:00 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-10 02:56:00 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-10 02:56:00 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 02:56:00 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-10 02:56:00 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-10 02:56:00 [SpringApplicationShutdownHook] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in StandardWebSocketSession[id=79f27196-9785-3f7c-7a11-fdf2173d310d, uri=ws://localhost:8080/api/chat]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:542)
	at org.apache.tomcat.websocket.WsSession.close(WsSession.java:530)
	at org.apache.tomcat.websocket.WsWebSocketContainer.destroy(WsWebSocketContainer.java:1022)
	at org.apache.tomcat.websocket.server.WsContextListener.contextDestroyed(WsContextListener.java:46)
	at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4090)
	at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:4700)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1219)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1208)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:814)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1219)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1208)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:814)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardService.stopInternal(StandardService.java:468)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardServer.stopInternal(StandardServer.java:915)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.startup.Tomcat.stop(Tomcat.java:448)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.stopTomcat(TomcatWebServer.java:301)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.destroy(TomcatWebServer.java:374)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:182)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.SpringApplicationShutdownHook.closeAndWait(SpringApplicationShutdownHook.java:147)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.boot.SpringApplicationShutdownHook.run(SpringApplicationShutdownHook.java:116)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 37 common frames omitted
2025-08-10 02:56:00 [SpringApplicationShutdownHook] ERROR c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 전송 오류 [79f27196-9785-3f7c-7a11-fdf2173d310d]: java.nio.channels.ClosedChannelException
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:542)
	at org.apache.tomcat.websocket.WsSession.close(WsSession.java:530)
	at org.apache.tomcat.websocket.WsWebSocketContainer.destroy(WsWebSocketContainer.java:1022)
	at org.apache.tomcat.websocket.server.WsContextListener.contextDestroyed(WsContextListener.java:46)
	at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4090)
	at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:4700)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1219)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1208)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:814)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1219)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1208)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:814)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardService.stopInternal(StandardService.java:468)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardServer.stopInternal(StandardServer.java:915)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.startup.Tomcat.stop(Tomcat.java:448)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.stopTomcat(TomcatWebServer.java:301)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.destroy(TomcatWebServer.java:374)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:182)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.SpringApplicationShutdownHook.closeAndWait(SpringApplicationShutdownHook.java:147)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.boot.SpringApplicationShutdownHook.run(SpringApplicationShutdownHook.java:116)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 37 common frames omitted
2025-08-10 02:56:00 [SpringApplicationShutdownHook] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - StandardWebSocketSession[id=79f27196-9785-3f7c-7a11-fdf2173d310d, uri=ws://localhost:8080/api/chat] closed with CloseStatus[code=1001, reason=The web application is stopping]
2025-08-10 02:56:00 [SpringApplicationShutdownHook] INFO  c.e.u.d.chat.service.ChatService - 세션 정리 [79f27196-9785-3f7c-7a11-fdf2173d310d]
2025-08-10 02:56:00 [SpringApplicationShutdownHook] INFO  c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 연결 종료 [79f27196-9785-3f7c-7a11-fdf2173d310d]: CloseStatus[code=1001, reason=The web application is stopping]
2025-08-10 02:58:17 [Test worker] INFO  c.e.unithon.UnithonApplicationTests - Starting UnithonApplicationTests using Java 21.0.4 with PID 78218 (started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 02:58:17 [Test worker] DEBUG c.e.unithon.UnithonApplicationTests - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 02:58:17 [Test worker] INFO  c.e.unithon.UnithonApplicationTests - No active profile set, falling back to 1 default profile: "default"
2025-08-10 02:58:17 [Test worker] DEBUG o.s.w.c.s.GenericWebApplicationContext - Refreshing org.springframework.web.context.support.GenericWebApplicationContext@4c777e7b
2025-08-10 02:58:17 [Test worker] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 02:58:17 [Test worker] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 18 ms. Found 3 JPA repository interfaces.
2025-08-10 02:58:17 [Test worker] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=5ab8cb3c-90a6-39a8-be33-df97d968bd23
2025-08-10 02:58:17 [Test worker] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 02:58:17 [Test worker] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 02:58:17 [Test worker] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 02:58:17 [Test worker] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 02:58:17 [Test worker] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 02:58:18 [Test worker] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@1da32baf
2025-08-10 02:58:18 [Test worker] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 02:58:18 [Test worker] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 02:58:18 [Test worker] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 02:58:18 [Test worker] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 02:58:18 [Test worker] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 02:58:18 [Test worker] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 02:58:18 [Test worker] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 02:58:19 [Test worker] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 02:58:19 [Test worker] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/chat] in 'webSocketHandlerMapping'
2025-08-10 02:58:19 [Test worker] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 02:58:19 [Test worker] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 02:58:19 [Test worker] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 02:58:19 [Test worker] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 02:58:20 [Test worker] INFO  c.e.unithon.UnithonApplicationTests - Started UnithonApplicationTests in 3.068 seconds (process running for 3.632)
2025-08-10 02:58:20 [SpringApplicationShutdownHook] DEBUG o.s.w.c.s.GenericWebApplicationContext - Closing org.springframework.web.context.support.GenericWebApplicationContext@4c777e7b, started on Sun Aug 10 02:58:17 KST 2025
2025-08-10 02:58:20 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 02:58:20 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-10 02:58:20 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-10 02:58:31 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 78769 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 02:58:31 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 02:58:31 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 02:58:31 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 02:58:31 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 22 ms. Found 3 JPA repository interfaces.
2025-08-10 02:58:31 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=bbd63796-756e-3eb4-abf6-8df2b1780b31
2025-08-10 02:58:31 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 02:58:31 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 02:58:31 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 02:58:31 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 02:58:31 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 537 ms
2025-08-10 02:58:31 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 02:58:31 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 02:58:31 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 02:58:32 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 02:58:32 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 02:58:32 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@351e86b2
2025-08-10 02:58:32 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 02:58:32 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 02:58:32 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 02:58:32 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 02:58:32 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 02:58:32 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 02:58:32 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 02:58:33 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 02:58:33 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/chat] in 'webSocketHandlerMapping'
2025-08-10 02:58:33 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 02:58:33 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 02:58:33 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 02:58:33 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 02:58:33 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-08-10 02:58:33 [main] INFO  c.example.unithon.UnithonApplication - Started UnithonApplication in 2.838 seconds (process running for 3.055)
2025-08-10 02:58:59 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-10 02:58:59 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-10 02:58:59 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-08-10 02:58:59 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-08-10 02:58:59 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-08-10 02:58:59 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@754fa706
2025-08-10 02:58:59 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@fc6c83a
2025-08-10 02:58:59 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-08-10 02:58:59 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 3 ms
2025-08-10 02:58:59 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/websocket-test.html", parameters={}
2025-08-10 02:58:59 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [static/]]
2025-08-10 02:58:59 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-08-10 02:58:59 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/chat", parameters={}
2025-08-10 02:58:59 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.server.support.WebSocketHttpRequestHandler@636787fd
2025-08-10 02:58:59 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHttpRequestHandler - GET /api/chat
2025-08-10 02:58:59 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-08-10 02:58:59 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New StandardWebSocketSession[id=a7cbcae7-7dc9-2f36-d055-7b6f31021786, uri=ws://localhost:8080/api/chat]
2025-08-10 02:58:59 [http-nio-8080-exec-2] INFO  c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 연결 성공: a7cbcae7-7dc9-2f36-d055-7b6f31021786
2025-08-10 02:58:59 [http-nio-8080-exec-2] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [a7cbcae7-7dc9-2f36-d055-7b6f31021786]: connection
2025-08-10 02:59:14 [http-nio-8080-exec-5] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [a7cbcae7-7dc9-2f36-d055-7b6f31021786]: {"type":"client.text","message":"아아 주세요"}
2025-08-10 02:59:14 [http-nio-8080-exec-5] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [a7cbcae7-7dc9-2f36-d055-7b6f31021786]: 아아 주세요
2025-08-10 02:59:14 [http-nio-8080-exec-5] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [a7cbcae7-7dc9-2f36-d055-7b6f31021786]: 아아 주세요
2025-08-10 02:59:14 [http-nio-8080-exec-5] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 아아 주세요
2025-08-10 02:59:14 [http-nio-8080-exec-5] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자가 '아아 주세요'를 주문했습니다.
이것은 맥도날드 매장입니다. 다음은 현재 판매 중인 메뉴입니다:

버거/세트: 빅맥, 쿼터파운더, 맥스파이시 상하이 버거, 불고기 버거
커피: 아메리카노, 카페라떼, 카푸치노, 캐러멜 마키아토
음료: 코카콜라, 코카콜라 제로, 스프라이트, 오렌지 주스
사이드: 프렌치프라이, 치킨 너겟, 애플파이
디저트: 맥플러리 오레오, 소프트 콘

판단 기준:
1. 요청한 음식이 맥도날드에서 파는 종류의 음식인가?
2. 위 메뉴와 유사한 것이 있는가?

응답 규칙:
- 맥도날드와 전혀 관련 없는 음식(짜장면, 김치찌개, 초밥 등)이면 → NO_MATCH
- 유사한 메뉴가 있으면 → 다음 기준으로 추천:
  1. 카테고리가 같은 메뉴를 우선 추천 (커피→커피, 버거→버거)
  2. 맛, 재료, 특성이 유사한 메뉴를 선택
  3. 가격대가 비슷한 메뉴를 우선 고려
  4. 반드시 위 메뉴 목록에 있는 정확한 메뉴명만 추천

예시:
바닐라 라떼' → '카페라떼', '캐러멜 마키아토' 추천
'치즈버거' → '빅맥', '불고기 버거' 추천
'짜장면' → NO_MATCH (맥도날드 음식이 아님)
'김치찌개' → NO_MATCH (맥도날드 음식이 아님)

응답 형식: JSON
{
  "recommended": ["메뉴명1", "메뉴명2"] 또는 "NO_MATCH",
  "reason": "판단 이유"
}
2025-08-10 02:59:15 [http-nio-8080-exec-5] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 02:59:15 [http-nio-8080-exec-5] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: ```json
{
  "recommended": ["아메리카노"],
  "reason": "고객이 \"아아\"라고 주문했는데, 이는 아메리카노를 지칭하는 속어입니다. 메뉴에 아메리카노가 있으므로 아메리카노를 추천합니다."
}
```

2025-08-10 02:59:15 [http-nio-8080-exec-5] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: ```json
{
  "recommended": ["아메리카노"],
  "reason": "고객이 \"아아\"라고 주문했는데, 이는 아메리카노를 지칭하는 속어입니다. 메뉴에 아메리카노가 있으므로 아메리카노를 추천합니다."
}
```

2025-08-10 02:59:15 [http-nio-8080-exec-5] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답에서 파싱된 추천 메뉴: [아메리카노]
2025-08-10 02:59:15 [http-nio-8080-exec-5] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [a7cbcae7-7dc9-2f36-d055-7b6f31021786]: bot.reply
2025-08-10 02:59:20 [http-nio-8080-exec-6] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [a7cbcae7-7dc9-2f36-d055-7b6f31021786]: {"type":"client.text","message":"아아 주세요"}
2025-08-10 02:59:20 [http-nio-8080-exec-6] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [a7cbcae7-7dc9-2f36-d055-7b6f31021786]: 아아 주세요
2025-08-10 02:59:20 [http-nio-8080-exec-6] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [a7cbcae7-7dc9-2f36-d055-7b6f31021786]: 아아 주세요
2025-08-10 02:59:20 [http-nio-8080-exec-6] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 아아 주세요
2025-08-10 02:59:20 [http-nio-8080-exec-6] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자가 '아아 주세요'를 주문했습니다.
이것은 맥도날드 매장입니다. 다음은 현재 판매 중인 메뉴입니다:

버거/세트: 빅맥, 쿼터파운더, 맥스파이시 상하이 버거, 불고기 버거
커피: 아메리카노, 카페라떼, 카푸치노, 캐러멜 마키아토
음료: 코카콜라, 코카콜라 제로, 스프라이트, 오렌지 주스
사이드: 프렌치프라이, 치킨 너겟, 애플파이
디저트: 맥플러리 오레오, 소프트 콘

판단 기준:
1. 요청한 음식이 맥도날드에서 파는 종류의 음식인가?
2. 위 메뉴와 유사한 것이 있는가?

응답 규칙:
- 맥도날드와 전혀 관련 없는 음식(짜장면, 김치찌개, 초밥 등)이면 → NO_MATCH
- 유사한 메뉴가 있으면 → 다음 기준으로 추천:
  1. 카테고리가 같은 메뉴를 우선 추천 (커피→커피, 버거→버거)
  2. 맛, 재료, 특성이 유사한 메뉴를 선택
  3. 가격대가 비슷한 메뉴를 우선 고려
  4. 반드시 위 메뉴 목록에 있는 정확한 메뉴명만 추천

예시:
바닐라 라떼' → '카페라떼', '캐러멜 마키아토' 추천
'치즈버거' → '빅맥', '불고기 버거' 추천
'짜장면' → NO_MATCH (맥도날드 음식이 아님)
'김치찌개' → NO_MATCH (맥도날드 음식이 아님)

응답 형식: JSON
{
  "recommended": ["메뉴명1", "메뉴명2"] 또는 "NO_MATCH",
  "reason": "판단 이유"
}
2025-08-10 02:59:21 [http-nio-8080-exec-6] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 02:59:21 [http-nio-8080-exec-6] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: ```json
{
  "recommended": ["아메리카노"],
  "reason": "'아아'는 '아이스 아메리카노'를 의미하며, 메뉴에 있는 '아메리카노'와 가장 유사합니다."
}
```

2025-08-10 02:59:21 [http-nio-8080-exec-6] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: ```json
{
  "recommended": ["아메리카노"],
  "reason": "'아아'는 '아이스 아메리카노'를 의미하며, 메뉴에 있는 '아메리카노'와 가장 유사합니다."
}
```

2025-08-10 02:59:21 [http-nio-8080-exec-6] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답에서 파싱된 추천 메뉴: [아메리카노]
2025-08-10 02:59:21 [http-nio-8080-exec-6] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [a7cbcae7-7dc9-2f36-d055-7b6f31021786]: bot.reply
2025-08-10 03:00:23 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in StandardWebSocketSession[id=a7cbcae7-7dc9-2f36-d055-7b6f31021786, uri=ws://localhost:8080/api/chat]
java.io.EOFException: null
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.fillReadBuffer(NioEndpoint.java:1331)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.read(NioEndpoint.java:1219)
	at org.apache.tomcat.websocket.server.WsFrameServer.onDataAvailable(WsFrameServer.java:74)
	at org.apache.tomcat.websocket.server.WsFrameServer.doOnDataAvailable(WsFrameServer.java:184)
	at org.apache.tomcat.websocket.server.WsFrameServer.notifyDataAvailable(WsFrameServer.java:164)
	at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.upgradeDispatch(WsHttpUpgradeHandler.java:152)
	at org.apache.coyote.http11.upgrade.UpgradeProcessorInternal.dispatch(UpgradeProcessorInternal.java:60)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:57)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-08-10 03:00:23 [http-nio-8080-exec-7] ERROR c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 전송 오류 [a7cbcae7-7dc9-2f36-d055-7b6f31021786]: null
java.io.EOFException: null
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.fillReadBuffer(NioEndpoint.java:1331)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.read(NioEndpoint.java:1219)
	at org.apache.tomcat.websocket.server.WsFrameServer.onDataAvailable(WsFrameServer.java:74)
	at org.apache.tomcat.websocket.server.WsFrameServer.doOnDataAvailable(WsFrameServer.java:184)
	at org.apache.tomcat.websocket.server.WsFrameServer.notifyDataAvailable(WsFrameServer.java:164)
	at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.upgradeDispatch(WsHttpUpgradeHandler.java:152)
	at org.apache.coyote.http11.upgrade.UpgradeProcessorInternal.dispatch(UpgradeProcessorInternal.java:60)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:57)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-08-10 03:00:23 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - StandardWebSocketSession[id=a7cbcae7-7dc9-2f36-d055-7b6f31021786, uri=ws://localhost:8080/api/chat] closed with CloseStatus[code=1006, reason=null]
2025-08-10 03:00:23 [http-nio-8080-exec-7] INFO  c.e.u.d.chat.service.ChatService - 세션 정리 완료 [a7cbcae7-7dc9-2f36-d055-7b6f31021786]
2025-08-10 03:00:23 [http-nio-8080-exec-7] INFO  c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 연결 종료 [a7cbcae7-7dc9-2f36-d055-7b6f31021786]: CloseStatus[code=1006, reason=null]
2025-08-10 03:00:32 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 80038 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 03:00:32 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 03:00:32 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 03:00:33 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 03:00:33 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 15 ms. Found 3 JPA repository interfaces.
2025-08-10 03:00:33 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=efb109c1-7d98-3f96-97fc-a61a66401d77
2025-08-10 03:00:33 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 03:00:33 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 03:00:33 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 03:00:33 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 03:00:33 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 531 ms
2025-08-10 03:00:33 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 03:00:33 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 03:00:33 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 03:00:33 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 03:00:33 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 03:00:33 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@4d16975b
2025-08-10 03:00:33 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 03:00:33 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 03:00:33 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 03:00:33 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 03:00:34 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 03:00:34 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 03:00:34 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 03:00:34 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 03:00:34 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/chat] in 'webSocketHandlerMapping'
2025-08-10 03:00:34 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 03:00:34 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 03:00:34 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 03:00:34 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 03:00:35 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-08-10 03:00:35 [main] INFO  c.example.unithon.UnithonApplication - Started UnithonApplication in 2.798 seconds (process running for 3.18)
2025-08-10 03:00:42 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-10 03:00:42 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-10 03:00:42 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-08-10 03:00:42 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-08-10 03:00:42 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-08-10 03:00:42 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@2b3ba0a8
2025-08-10 03:00:42 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@61c0a61
2025-08-10 03:00:42 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-08-10 03:00:42 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 3 ms
2025-08-10 03:00:42 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/websocket-test.html", parameters={}
2025-08-10 03:00:42 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [static/]]
2025-08-10 03:00:42 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-08-10 03:00:42 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/chat", parameters={}
2025-08-10 03:00:42 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.server.support.WebSocketHttpRequestHandler@712ce4f1
2025-08-10 03:00:42 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHttpRequestHandler - GET /api/chat
2025-08-10 03:00:42 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-08-10 03:00:42 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New StandardWebSocketSession[id=13170aad-b84e-fce1-dceb-4466a9622790, uri=ws://localhost:8080/api/chat]
2025-08-10 03:00:42 [http-nio-8080-exec-2] INFO  c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 연결 성공: 13170aad-b84e-fce1-dceb-4466a9622790
2025-08-10 03:00:42 [http-nio-8080-exec-2] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [13170aad-b84e-fce1-dceb-4466a9622790]: connection
2025-08-10 03:00:49 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - StandardWebSocketSession[id=13170aad-b84e-fce1-dceb-4466a9622790, uri=ws://localhost:8080/api/chat] closed with CloseStatus[code=1001, reason=null]
2025-08-10 03:00:49 [http-nio-8080-exec-6] INFO  c.e.u.d.chat.service.ChatService - 세션 정리 완료 [13170aad-b84e-fce1-dceb-4466a9622790]
2025-08-10 03:00:49 [http-nio-8080-exec-6] INFO  c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 연결 종료 [13170aad-b84e-fce1-dceb-4466a9622790]: CloseStatus[code=1001, reason=null]
2025-08-10 03:00:59 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/websocket-test.html", parameters={}
2025-08-10 03:00:59 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [static/]]
2025-08-10 03:00:59 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-08-10 03:00:59 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/chat", parameters={}
2025-08-10 03:00:59 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.server.support.WebSocketHttpRequestHandler@712ce4f1
2025-08-10 03:00:59 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.s.WebSocketHttpRequestHandler - GET /api/chat
2025-08-10 03:00:59 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-08-10 03:00:59 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New StandardWebSocketSession[id=b2d7238f-cdee-b4b7-87c2-a7e175c60eea, uri=ws://localhost:8080/api/chat]
2025-08-10 03:00:59 [http-nio-8080-exec-10] INFO  c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 연결 성공: b2d7238f-cdee-b4b7-87c2-a7e175c60eea
2025-08-10 03:00:59 [http-nio-8080-exec-10] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [b2d7238f-cdee-b4b7-87c2-a7e175c60eea]: connection
2025-08-10 03:01:20 [http-nio-8080-exec-2] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [b2d7238f-cdee-b4b7-87c2-a7e175c60eea]: {"type":"client.text","message":"아아 주세요"}
2025-08-10 03:01:20 [http-nio-8080-exec-2] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [b2d7238f-cdee-b4b7-87c2-a7e175c60eea]: 아아 주세요
2025-08-10 03:01:20 [http-nio-8080-exec-2] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [b2d7238f-cdee-b4b7-87c2-a7e175c60eea]: 아아 주세요
2025-08-10 03:01:20 [http-nio-8080-exec-2] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 아아 주세요
2025-08-10 03:01:20 [http-nio-8080-exec-2] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자가 '아아 주세요'를 주문했습니다.
이것은 맥도날드 매장입니다. 다음은 현재 판매 중인 메뉴입니다:

버거/세트: 빅맥, 쿼터파운더, 맥스파이시 상하이 버거, 불고기 버거
커피: 아메리카노, 카페라떼, 카푸치노, 캐러멜 마키아토
음료: 코카콜라, 코카콜라 제로, 스프라이트, 오렌지 주스
사이드: 프렌치프라이, 치킨 너겟, 애플파이
디저트: 맥플러리 오레오, 소프트 콘

판단 기준:
1. 요청한 음식이 맥도날드에서 파는 종류의 음식인가?
2. 위 메뉴와 유사한 것이 있는가?

응답 규칙:
- 맥도날드와 전혀 관련 없는 음식(짜장면, 김치찌개, 초밥 등)이면 → NO_MATCH
- 유사한 메뉴가 있으면 → 다음 기준으로 추천:
  1. 카테고리가 같은 메뉴를 우선 추천 (커피→커피, 버거→버거)
  2. 맛, 재료, 특성이 유사한 메뉴를 선택
  3. 가격대가 비슷한 메뉴를 우선 고려
  4. 반드시 위 메뉴 목록에 있는 정확한 메뉴명만 추천

예시:
바닐라 라떼' → '카페라떼', '캐러멜 마키아토' 추천
'치즈버거' → '빅맥', '불고기 버거' 추천
'짜장면' → NO_MATCH (맥도날드 음식이 아님)
'김치찌개' → NO_MATCH (맥도날드 음식이 아님)

응답 형식: JSON
{
  "recommended": ["메뉴명1", "메뉴명2"] 또는 "NO_MATCH",
  "reason": "판단 이유"
}
2025-08-10 03:01:22 [http-nio-8080-exec-2] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 03:01:22 [http-nio-8080-exec-2] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: ```json
{
  "recommended": ["아메리카노"],
  "reason": "고객이 '아아'라고 주문하였는데, 이는 아메리카노를 지칭하는 인터넷 신조어입니다. 메뉴에 있는 아메리카노를 추천합니다."
}
```

2025-08-10 03:01:22 [http-nio-8080-exec-2] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: ```json
{
  "recommended": ["아메리카노"],
  "reason": "고객이 '아아'라고 주문하였는데, 이는 아메리카노를 지칭하는 인터넷 신조어입니다. 메뉴에 있는 아메리카노를 추천합니다."
}
```

2025-08-10 03:01:22 [http-nio-8080-exec-2] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답에서 파싱된 추천 메뉴: [아메리카노]
2025-08-10 03:01:22 [http-nio-8080-exec-2] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [b2d7238f-cdee-b4b7-87c2-a7e175c60eea]: bot.reply
2025-08-10 03:07:13 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-10 03:07:13 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-10 03:07:13 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 03:07:13 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-10 03:07:13 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-10 03:07:13 [SpringApplicationShutdownHook] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in StandardWebSocketSession[id=b2d7238f-cdee-b4b7-87c2-a7e175c60eea, uri=ws://localhost:8080/api/chat]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:542)
	at org.apache.tomcat.websocket.WsSession.close(WsSession.java:530)
	at org.apache.tomcat.websocket.WsWebSocketContainer.destroy(WsWebSocketContainer.java:1022)
	at org.apache.tomcat.websocket.server.WsContextListener.contextDestroyed(WsContextListener.java:46)
	at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4090)
	at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:4700)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1219)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1208)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:814)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1219)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1208)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:814)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardService.stopInternal(StandardService.java:468)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardServer.stopInternal(StandardServer.java:915)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.startup.Tomcat.stop(Tomcat.java:448)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.stopTomcat(TomcatWebServer.java:301)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.destroy(TomcatWebServer.java:374)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:182)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.SpringApplicationShutdownHook.closeAndWait(SpringApplicationShutdownHook.java:147)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.boot.SpringApplicationShutdownHook.run(SpringApplicationShutdownHook.java:116)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 37 common frames omitted
2025-08-10 03:07:13 [SpringApplicationShutdownHook] ERROR c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 전송 오류 [b2d7238f-cdee-b4b7-87c2-a7e175c60eea]: java.nio.channels.ClosedChannelException
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:542)
	at org.apache.tomcat.websocket.WsSession.close(WsSession.java:530)
	at org.apache.tomcat.websocket.WsWebSocketContainer.destroy(WsWebSocketContainer.java:1022)
	at org.apache.tomcat.websocket.server.WsContextListener.contextDestroyed(WsContextListener.java:46)
	at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4090)
	at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:4700)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1219)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1208)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:814)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1219)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1208)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:814)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardService.stopInternal(StandardService.java:468)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardServer.stopInternal(StandardServer.java:915)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.startup.Tomcat.stop(Tomcat.java:448)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.stopTomcat(TomcatWebServer.java:301)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.destroy(TomcatWebServer.java:374)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:182)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.SpringApplicationShutdownHook.closeAndWait(SpringApplicationShutdownHook.java:147)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.boot.SpringApplicationShutdownHook.run(SpringApplicationShutdownHook.java:116)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 37 common frames omitted
2025-08-10 03:07:13 [SpringApplicationShutdownHook] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - StandardWebSocketSession[id=b2d7238f-cdee-b4b7-87c2-a7e175c60eea, uri=ws://localhost:8080/api/chat] closed with CloseStatus[code=1001, reason=The web application is stopping]
2025-08-10 03:07:13 [SpringApplicationShutdownHook] INFO  c.e.u.d.chat.service.ChatService - 세션 정리 완료 [b2d7238f-cdee-b4b7-87c2-a7e175c60eea]
2025-08-10 03:07:13 [SpringApplicationShutdownHook] INFO  c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 연결 종료 [b2d7238f-cdee-b4b7-87c2-a7e175c60eea]: CloseStatus[code=1001, reason=The web application is stopping]
2025-08-10 03:07:17 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 83804 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 03:07:17 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 03:07:17 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 03:07:17 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 03:07:17 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 24 ms. Found 3 JPA repository interfaces.
2025-08-10 03:07:17 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=bbd63796-756e-3eb4-abf6-8df2b1780b31
2025-08-10 03:07:17 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 03:07:17 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 03:07:17 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 03:07:17 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 03:07:17 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 538 ms
2025-08-10 03:07:17 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 03:07:17 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 03:07:18 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 03:07:18 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 03:07:18 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 03:07:18 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@5649f55
2025-08-10 03:07:18 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 03:07:18 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 03:07:18 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 03:07:18 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 03:07:18 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 03:07:18 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 03:07:18 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 03:07:19 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 03:07:19 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/chat] in 'webSocketHandlerMapping'
2025-08-10 03:07:19 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 03:07:19 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 03:07:19 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 03:07:19 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 03:07:20 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-08-10 03:07:20 [main] INFO  c.example.unithon.UnithonApplication - Started UnithonApplication in 2.933 seconds (process running for 3.157)
2025-08-10 03:07:38 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-10 03:07:38 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-10 03:07:38 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-08-10 03:07:38 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-08-10 03:07:38 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-08-10 03:07:38 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@66a97b79
2025-08-10 03:07:38 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@374d3128
2025-08-10 03:07:38 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-08-10 03:07:38 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 7 ms
2025-08-10 03:07:38 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/websocket-test.html", parameters={}
2025-08-10 03:07:38 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [static/]]
2025-08-10 03:07:38 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-08-10 03:07:38 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/chat", parameters={}
2025-08-10 03:07:38 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.server.support.WebSocketHttpRequestHandler@4d5399f4
2025-08-10 03:07:38 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHttpRequestHandler - GET /api/chat
2025-08-10 03:07:38 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-08-10 03:07:38 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New StandardWebSocketSession[id=e9a70f57-9709-60d4-37df-2de66ce574ed, uri=ws://localhost:8080/api/chat]
2025-08-10 03:07:38 [http-nio-8080-exec-2] INFO  c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 연결 성공: e9a70f57-9709-60d4-37df-2de66ce574ed
2025-08-10 03:07:38 [http-nio-8080-exec-2] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [e9a70f57-9709-60d4-37df-2de66ce574ed]: connection
2025-08-10 03:07:44 [http-nio-8080-exec-4] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [e9a70f57-9709-60d4-37df-2de66ce574ed]: {"type":"client.text","message":"아아 주세요"}
2025-08-10 03:07:44 [http-nio-8080-exec-4] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [e9a70f57-9709-60d4-37df-2de66ce574ed]: 아아 주세요
2025-08-10 03:07:44 [http-nio-8080-exec-4] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [e9a70f57-9709-60d4-37df-2de66ce574ed]: 아아 주세요
2025-08-10 03:07:44 [http-nio-8080-exec-4] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 아아 주세요
2025-08-10 03:07:44 [http-nio-8080-exec-4] INFO  c.e.u.d.menu.service.MenuService - DB 동의어 매칭 성공: 아아 주세요 → 아메리카노
2025-08-10 03:07:44 [http-nio-8080-exec-4] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [e9a70f57-9709-60d4-37df-2de66ce574ed]: bot.reply
2025-08-10 03:07:50 [http-nio-8080-exec-5] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [e9a70f57-9709-60d4-37df-2de66ce574ed]: {"type":"client.text","message":"아이스 아메이카노요"}
2025-08-10 03:07:50 [http-nio-8080-exec-5] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [e9a70f57-9709-60d4-37df-2de66ce574ed]: 아이스 아메이카노요
2025-08-10 03:07:50 [http-nio-8080-exec-5] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [e9a70f57-9709-60d4-37df-2de66ce574ed]: 아이스 아메이카노요
2025-08-10 03:07:50 [http-nio-8080-exec-5] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [e9a70f57-9709-60d4-37df-2de66ce574ed]: bot.reply
2025-08-10 03:07:54 [http-nio-8080-exec-6] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [e9a70f57-9709-60d4-37df-2de66ce574ed]: {"type":"client.text","message":"레귤러요"}
2025-08-10 03:07:54 [http-nio-8080-exec-6] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [e9a70f57-9709-60d4-37df-2de66ce574ed]: 레귤러요
2025-08-10 03:07:54 [http-nio-8080-exec-6] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [e9a70f57-9709-60d4-37df-2de66ce574ed]: 레귤러요
2025-08-10 03:07:54 [http-nio-8080-exec-6] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [e9a70f57-9709-60d4-37df-2de66ce574ed]: bot.reply
2025-08-10 03:07:57 [http-nio-8080-exec-7] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [e9a70f57-9709-60d4-37df-2de66ce574ed]: {"type":"client.text","message":"1개요"}
2025-08-10 03:07:57 [http-nio-8080-exec-7] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [e9a70f57-9709-60d4-37df-2de66ce574ed]: 1개요
2025-08-10 03:07:57 [http-nio-8080-exec-7] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [e9a70f57-9709-60d4-37df-2de66ce574ed]: 1개요
2025-08-10 03:07:57 [http-nio-8080-exec-7] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [e9a70f57-9709-60d4-37df-2de66ce574ed]: bot.reply
2025-08-10 03:08:04 [http-nio-8080-exec-8] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [e9a70f57-9709-60d4-37df-2de66ce574ed]: {"type":"client.text","message":"주문을 마칠게요"}
2025-08-10 03:08:04 [http-nio-8080-exec-8] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [e9a70f57-9709-60d4-37df-2de66ce574ed]: 주문을 마칠게요
2025-08-10 03:08:04 [http-nio-8080-exec-8] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [e9a70f57-9709-60d4-37df-2de66ce574ed]: 주문을 마칠게요
2025-08-10 03:08:04 [http-nio-8080-exec-8] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [e9a70f57-9709-60d4-37df-2de66ce574ed]: bot.reply
2025-08-10 03:08:13 [http-nio-8080-exec-9] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [e9a70f57-9709-60d4-37df-2de66ce574ed]: {"type":"client.text","message":"주문을 마칠게요"}
2025-08-10 03:08:13 [http-nio-8080-exec-9] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [e9a70f57-9709-60d4-37df-2de66ce574ed]: 주문을 마칠게요
2025-08-10 03:08:13 [http-nio-8080-exec-9] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [e9a70f57-9709-60d4-37df-2de66ce574ed]: 주문을 마칠게요
2025-08-10 03:08:13 [http-nio-8080-exec-9] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [e9a70f57-9709-60d4-37df-2de66ce574ed]: bot.reply
2025-08-10 03:09:05 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 84795 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 03:09:05 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 03:09:05 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 03:09:05 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 03:09:05 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 15 ms. Found 3 JPA repository interfaces.
2025-08-10 03:09:05 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=efb109c1-7d98-3f96-97fc-a61a66401d77
2025-08-10 03:09:06 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 03:09:06 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 03:09:06 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 03:09:06 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 03:09:06 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 504 ms
2025-08-10 03:09:06 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 03:09:06 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 03:09:06 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 03:09:06 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 03:09:06 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 03:09:06 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@71d0b8a4
2025-08-10 03:09:06 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 03:09:06 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 03:09:06 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 03:09:06 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 03:09:06 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 03:09:07 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 03:09:07 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 03:09:07 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 03:09:07 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/chat] in 'webSocketHandlerMapping'
2025-08-10 03:09:07 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 03:09:07 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 03:09:07 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 03:09:07 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 03:09:08 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'
2025-08-10 03:09:08 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 03:09:08 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-10 03:09:08 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-10 03:09:08 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-08-10 03:09:08 [main] ERROR o.s.b.d.LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Web server failed to start. Port 8080 was already in use.

Action:

Identify and stop the process that's listening on port 8080 or configure this application to listen on another port.

2025-08-10 03:26:09 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in StandardWebSocketSession[id=e9a70f57-9709-60d4-37df-2de66ce574ed, uri=ws://localhost:8080/api/chat]
java.io.EOFException: null
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.fillReadBuffer(NioEndpoint.java:1331)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.read(NioEndpoint.java:1219)
	at org.apache.tomcat.websocket.server.WsFrameServer.onDataAvailable(WsFrameServer.java:74)
	at org.apache.tomcat.websocket.server.WsFrameServer.doOnDataAvailable(WsFrameServer.java:184)
	at org.apache.tomcat.websocket.server.WsFrameServer.notifyDataAvailable(WsFrameServer.java:164)
	at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.upgradeDispatch(WsHttpUpgradeHandler.java:152)
	at org.apache.coyote.http11.upgrade.UpgradeProcessorInternal.dispatch(UpgradeProcessorInternal.java:60)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:57)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-08-10 03:26:09 [http-nio-8080-exec-10] ERROR c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 전송 오류 [e9a70f57-9709-60d4-37df-2de66ce574ed]: null
java.io.EOFException: null
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.fillReadBuffer(NioEndpoint.java:1331)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.read(NioEndpoint.java:1219)
	at org.apache.tomcat.websocket.server.WsFrameServer.onDataAvailable(WsFrameServer.java:74)
	at org.apache.tomcat.websocket.server.WsFrameServer.doOnDataAvailable(WsFrameServer.java:184)
	at org.apache.tomcat.websocket.server.WsFrameServer.notifyDataAvailable(WsFrameServer.java:164)
	at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.upgradeDispatch(WsHttpUpgradeHandler.java:152)
	at org.apache.coyote.http11.upgrade.UpgradeProcessorInternal.dispatch(UpgradeProcessorInternal.java:60)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:57)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-08-10 03:26:09 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - StandardWebSocketSession[id=e9a70f57-9709-60d4-37df-2de66ce574ed, uri=ws://localhost:8080/api/chat] closed with CloseStatus[code=1006, reason=null]
2025-08-10 03:26:09 [http-nio-8080-exec-10] INFO  c.e.u.d.chat.service.ChatService - 세션 정리 완료 [e9a70f57-9709-60d4-37df-2de66ce574ed]
2025-08-10 03:26:09 [http-nio-8080-exec-10] INFO  c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 연결 종료 [e9a70f57-9709-60d4-37df-2de66ce574ed]: CloseStatus[code=1006, reason=null]
2025-08-10 03:34:45 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=45s104ms).
2025-08-10 03:36:52 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=2m6s543ms).
2025-08-10 03:38:27 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m35s70ms).
2025-08-10 03:55:35 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@3173e86d (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 04:31:02 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@3ace6fc4 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 05:00:16 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1h21m49s614ms).
2025-08-10 06:08:14 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1h7m57s769ms).
2025-08-10 06:25:33 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@14085cd9 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 06:36:22 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@4fca80de (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 06:36:26 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@14b2fd06 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 06:52:54 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@9e0c7e4 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 07:09:06 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@45345f5 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 07:26:50 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@70ac2b4 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 07:26:52 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1h18m37s538ms).
2025-08-10 07:31:38 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@8daea56 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 07:32:05 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=5m13s566ms).
2025-08-10 07:32:07 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@3ff540db (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 07:32:12 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@31ecf538 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 07:32:43 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@2e4b86a9 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 07:33:45 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m39s767ms).
2025-08-10 07:35:17 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@cf6b117 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 07:35:19 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@28696baf (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 07:35:21 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@7cd1f271 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 07:35:52 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=2m7s72ms).
2025-08-10 07:37:24 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@45969af5 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 08:11:20 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@5254a2af (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 08:11:23 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@5055e705 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 08:22:18 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=46m26s414ms).
2025-08-10 08:22:27 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@7d626c37 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 09:24:26 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@7bb6bba (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 09:24:27 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1h2m8s65ms).
2025-08-10 09:24:29 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@16c41171 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 09:24:35 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@3bfa18cf (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 09:25:05 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@5193ca3f (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 09:25:08 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@cbd56a7 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 09:25:12 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@698dd84b (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 09:25:17 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@26003577 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 09:25:24 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@116a527c (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 09:25:35 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@70ccf7b3 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 09:25:52 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@14fa8e66 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 09:52:26 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m59s684ms).
2025-08-10 10:27:15 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 34350 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 10:27:15 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 10:27:15 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 10:27:16 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 10:27:16 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 15 ms. Found 3 JPA repository interfaces.
2025-08-10 10:27:16 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=efb109c1-7d98-3f96-97fc-a61a66401d77
2025-08-10 10:27:16 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 10:27:16 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 10:27:16 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 10:27:16 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 10:27:16 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 549 ms
2025-08-10 10:27:16 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 10:27:16 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 10:27:16 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 10:27:16 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 10:27:16 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 10:27:16 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@460b77d6
2025-08-10 10:27:16 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 10:27:16 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 10:27:16 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 10:27:16 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 10:27:17 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 10:27:17 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 10:27:17 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 10:27:17 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 10:27:17 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/chat] in 'webSocketHandlerMapping'
2025-08-10 10:27:17 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 10:27:17 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 10:27:17 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 10:27:17 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 10:27:18 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'
2025-08-10 10:27:18 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 10:27:18 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-10 10:27:18 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-10 10:27:18 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-08-10 10:27:18 [main] ERROR o.s.b.d.LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Web server failed to start. Port 8080 was already in use.

Action:

Identify and stop the process that's listening on port 8080 or configure this application to listen on another port.

2025-08-10 10:34:46 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 38538 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 10:34:46 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 10:34:46 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 10:34:47 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 10:34:47 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 16 ms. Found 3 JPA repository interfaces.
2025-08-10 10:34:47 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=efb109c1-7d98-3f96-97fc-a61a66401d77
2025-08-10 10:34:47 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 10:34:47 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 10:34:47 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 10:34:47 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 10:34:47 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 530 ms
2025-08-10 10:34:47 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 10:34:47 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 10:34:47 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 10:34:47 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 10:34:47 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 10:34:47 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@72b1df49
2025-08-10 10:34:47 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 10:34:47 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 10:34:47 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 10:34:47 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 10:34:48 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 10:34:48 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 10:34:48 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 10:34:48 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 10:34:48 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/chat] in 'webSocketHandlerMapping'
2025-08-10 10:34:48 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 10:34:48 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 10:34:49 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 10:34:49 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 10:34:49 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-08-10 10:34:49 [main] INFO  c.example.unithon.UnithonApplication - Started UnithonApplication in 2.961 seconds (process running for 3.502)
2025-08-10 10:34:56 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-10 10:34:56 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-10 10:34:56 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-08-10 10:34:56 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-08-10 10:34:56 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-08-10 10:34:56 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@2e3ec0e9
2025-08-10 10:34:56 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@61668c05
2025-08-10 10:34:56 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-08-10 10:34:56 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 3 ms
2025-08-10 10:34:56 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/websocket-test.html", parameters={}
2025-08-10 10:34:56 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [static/]]
2025-08-10 10:34:56 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-08-10 10:34:56 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/chat", parameters={}
2025-08-10 10:34:56 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.server.support.WebSocketHttpRequestHandler@66161fee
2025-08-10 10:34:56 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHttpRequestHandler - GET /api/chat
2025-08-10 10:34:56 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-08-10 10:34:56 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New StandardWebSocketSession[id=b0b76d64-c54e-07b0-9be7-e12d5996b95c, uri=ws://localhost:8080/api/chat]
2025-08-10 10:34:56 [http-nio-8080-exec-2] INFO  c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 연결 성공: b0b76d64-c54e-07b0-9be7-e12d5996b95c
2025-08-10 10:34:56 [http-nio-8080-exec-2] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: connection
2025-08-10 10:35:04 [http-nio-8080-exec-5] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: {"type":"client.text","message":"제일싼 메뉴가 뭐에요?"}
2025-08-10 10:35:04 [http-nio-8080-exec-5] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: 제일싼 메뉴가 뭐에요?
2025-08-10 10:35:04 [http-nio-8080-exec-5] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: 제일싼 메뉴가 뭐에요?
2025-08-10 10:35:04 [http-nio-8080-exec-5] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 제일싼 메뉴가 뭐에요?
2025-08-10 10:35:04 [http-nio-8080-exec-5] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: === 맥도날드 메뉴 데이터 ===

[버거/세트]

[커피]

[음료]

[사이드/디저트]


=== 사용자 질문 ===
제일싼 메뉴가 뭐에요?

=== 응답 규칙 ===
위의 메뉴 데이터를 정확히 참고해서 사용자의 질문에 답변해주세요.
- 가격 정보는 정확한 금액을 명시해주세요
- 메뉴명은 정확히 표기해주세요
- 카테고리별로 분류해서 답변하면 더 좋습니다
- 친근하고 자연스러운 톤으로 답변해주세요
- 맥도날드 직원처럼 응답해주세요

응답 형식: 일반 텍스트 (JSON 아님)
2025-08-10 10:35:06 [http-nio-8080-exec-5] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 10:35:06 [http-nio-8080-exec-5] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: 죄송합니다, 고객님.  메뉴 데이터에 가격 정보가 없어서 어떤 메뉴가 제일 싼지 말씀드릴 수가 없네요.  메뉴판을 참고해주시거나, 매장 직원에게 문의하시면 제일 저렴한 메뉴를 안내해 드릴 수 있을 거예요! 😊

2025-08-10 10:35:06 [http-nio-8080-exec-5] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: 죄송합니다, 고객님.  메뉴 데이터에 가격 정보가 없어서 어떤 메뉴가 제일 싼지 말씀드릴 수가 없네요.  메뉴판을 참고해주시거나, 매장 직원에게 문의하시면 제일 저렴한 메뉴를 안내해 드릴 수 있을 거예요! 😊

2025-08-10 10:35:06 [http-nio-8080-exec-5] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: bot.reply
2025-08-10 10:37:59 [http-nio-8080-exec-6] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: {"type":"client.text","message":"아아"}
2025-08-10 10:37:59 [http-nio-8080-exec-6] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: 아아
2025-08-10 10:37:59 [http-nio-8080-exec-6] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: 아아
2025-08-10 10:37:59 [http-nio-8080-exec-6] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 아아
2025-08-10 10:37:59 [http-nio-8080-exec-6] INFO  c.e.u.d.menu.service.MenuService - DB 동의어 매칭 성공: 아아 → 아메리카노
2025-08-10 10:38:00 [http-nio-8080-exec-6] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: bot.reply
2025-08-10 10:38:05 [http-nio-8080-exec-7] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: {"type":"client.text","message":"아이스 1전"}
2025-08-10 10:38:05 [http-nio-8080-exec-7] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: 아이스 1전
2025-08-10 10:38:05 [http-nio-8080-exec-7] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: 아이스 1전
2025-08-10 10:38:05 [http-nio-8080-exec-7] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: bot.reply
2025-08-10 10:38:15 [http-nio-8080-exec-8] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: {"type":"client.text","message":"레귤러 사이즈로!"}
2025-08-10 10:38:15 [http-nio-8080-exec-8] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: 레귤러 사이즈로!
2025-08-10 10:38:15 [http-nio-8080-exec-8] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: 레귤러 사이즈로!
2025-08-10 10:38:15 [http-nio-8080-exec-8] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: bot.reply
2025-08-10 10:38:22 [http-nio-8080-exec-9] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: {"type":"client.text","message":"아이스1잔"}
2025-08-10 10:38:22 [http-nio-8080-exec-9] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: 아이스1잔
2025-08-10 10:38:22 [http-nio-8080-exec-9] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: 아이스1잔
2025-08-10 10:38:22 [http-nio-8080-exec-9] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: bot.reply
2025-08-10 10:38:29 [http-nio-8080-exec-10] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: {"type":"client.text","message":"메뉴 더 담을게"}
2025-08-10 10:38:29 [http-nio-8080-exec-10] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: 메뉴 더 담을게
2025-08-10 10:38:29 [http-nio-8080-exec-10] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: 메뉴 더 담을게
2025-08-10 10:38:29 [http-nio-8080-exec-10] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: bot.reply
2025-08-10 10:38:32 [http-nio-8080-exec-1] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: {"type":"client.text","message":"짜장면"}
2025-08-10 10:38:32 [http-nio-8080-exec-1] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: 짜장면
2025-08-10 10:38:32 [http-nio-8080-exec-1] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: 짜장면
2025-08-10 10:38:32 [http-nio-8080-exec-1] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 짜장면
2025-08-10 10:38:32 [http-nio-8080-exec-1] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자가 '짜장면'를 주문했습니다.
이것은 맥도날드 매장입니다. 다음은 현재 판매 중인 메뉴입니다:

버거/세트: 빅맥, 쿼터파운더, 맥스파이시 상하이 버거, 불고기 버거
커피: 아메리카노, 카페라떼, 카푸치노, 캐러멜 마키아토
음료: 코카콜라, 코카콜라 제로, 스프라이트, 오렌지 주스
사이드: 프렌치프라이, 치킨 너겟, 애플파이
디저트: 맥플러리 오레오, 소프트 콘

판단 기준:
1. 요청한 음식이 맥도날드에서 파는 종류의 음식인가?
2. 위 메뉴와 유사한 것이 있는가?

응답 규칙:
- 맥도날드와 전혀 관련 없는 음식(짜장면, 김치찌개, 초밥 등)이면 → NO_MATCH
- 유사한 메뉴가 있으면 → 다음 기준으로 추천:
  1. 카테고리가 같은 메뉴를 우선 추천 (커피→커피, 버거→버거)
  2. 맛, 재료, 특성이 유사한 메뉴를 선택
  3. 가격대가 비슷한 메뉴를 우선 고려
  4. 반드시 위 메뉴 목록에 있는 정확한 메뉴명만 추천

예시:
바닐라 라떼' → '카페라떼', '캐러멜 마키아토' 추천
'치즈버거' → '빅맥', '불고기 버거' 추천
'짜장면' → NO_MATCH (맥도날드 음식이 아님)
'김치찌개' → NO_MATCH (맥도날드 음식이 아님)

응답 형식: JSON
{
  "recommended": ["메뉴명1", "메뉴명2"] 또는 "NO_MATCH",
  "reason": "판단 이유"
}
2025-08-10 10:38:33 [http-nio-8080-exec-1] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 10:38:33 [http-nio-8080-exec-1] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: ```json
{
  "recommended": "NO_MATCH",
  "reason": "짜장면은 맥도날드에서 판매하지 않는 메뉴입니다."
}
```

2025-08-10 10:38:33 [http-nio-8080-exec-1] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: ```json
{
  "recommended": "NO_MATCH",
  "reason": "짜장면은 맥도날드에서 판매하지 않는 메뉴입니다."
}
```

2025-08-10 10:38:33 [http-nio-8080-exec-1] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: 맥도날드 메뉴와 관련 없는 요청으로 판단됨
2025-08-10 10:38:33 [http-nio-8080-exec-1] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: bot.reply
2025-08-10 10:38:43 [http-nio-8080-exec-2] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: {"type":"client.text","message":"감튀"}
2025-08-10 10:38:43 [http-nio-8080-exec-2] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: 감튀
2025-08-10 10:38:43 [http-nio-8080-exec-2] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: 감튀
2025-08-10 10:38:43 [http-nio-8080-exec-2] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 감튀
2025-08-10 10:38:43 [http-nio-8080-exec-2] INFO  c.e.u.d.menu.service.MenuService - DB 동의어 매칭 성공: 감튀 → 프렌치프라이
2025-08-10 10:38:43 [http-nio-8080-exec-2] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: bot.reply
2025-08-10 10:38:49 [http-nio-8080-exec-4] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: {"type":"client.text","message":"라지 1개"}
2025-08-10 10:38:49 [http-nio-8080-exec-4] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: 라지 1개
2025-08-10 10:38:49 [http-nio-8080-exec-4] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: 라지 1개
2025-08-10 10:38:49 [http-nio-8080-exec-4] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: bot.reply
2025-08-10 10:39:06 [http-nio-8080-exec-3] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: {"type":"client.text","message":"1"}
2025-08-10 10:39:06 [http-nio-8080-exec-3] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: 1
2025-08-10 10:39:06 [http-nio-8080-exec-3] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: 1
2025-08-10 10:39:06 [http-nio-8080-exec-3] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: bot.reply
2025-08-10 10:39:11 [http-nio-8080-exec-5] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: {"type":"client.text","message":"주문 마칠래"}
2025-08-10 10:39:11 [http-nio-8080-exec-5] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: 주문 마칠래
2025-08-10 10:39:11 [http-nio-8080-exec-5] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: 주문 마칠래
2025-08-10 10:39:11 [http-nio-8080-exec-5] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: bot.reply
2025-08-10 11:10:13 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-10 11:10:13 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-10 11:10:13 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 11:10:13 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-10 11:10:13 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-10 11:10:13 [SpringApplicationShutdownHook] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in StandardWebSocketSession[id=b0b76d64-c54e-07b0-9be7-e12d5996b95c, uri=ws://localhost:8080/api/chat]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:542)
	at org.apache.tomcat.websocket.WsSession.close(WsSession.java:530)
	at org.apache.tomcat.websocket.WsWebSocketContainer.destroy(WsWebSocketContainer.java:1022)
	at org.apache.tomcat.websocket.server.WsContextListener.contextDestroyed(WsContextListener.java:46)
	at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4090)
	at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:4700)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1219)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1208)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:814)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1219)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1208)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:814)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardService.stopInternal(StandardService.java:468)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardServer.stopInternal(StandardServer.java:915)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.startup.Tomcat.stop(Tomcat.java:448)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.stopTomcat(TomcatWebServer.java:301)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.destroy(TomcatWebServer.java:374)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:182)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.SpringApplicationShutdownHook.closeAndWait(SpringApplicationShutdownHook.java:147)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.boot.SpringApplicationShutdownHook.run(SpringApplicationShutdownHook.java:116)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 37 common frames omitted
2025-08-10 11:10:13 [SpringApplicationShutdownHook] ERROR c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 전송 오류 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: java.nio.channels.ClosedChannelException
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:542)
	at org.apache.tomcat.websocket.WsSession.close(WsSession.java:530)
	at org.apache.tomcat.websocket.WsWebSocketContainer.destroy(WsWebSocketContainer.java:1022)
	at org.apache.tomcat.websocket.server.WsContextListener.contextDestroyed(WsContextListener.java:46)
	at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4090)
	at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:4700)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1219)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1208)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:814)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1219)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1208)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:814)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardService.stopInternal(StandardService.java:468)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardServer.stopInternal(StandardServer.java:915)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.startup.Tomcat.stop(Tomcat.java:448)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.stopTomcat(TomcatWebServer.java:301)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.destroy(TomcatWebServer.java:374)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:182)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.SpringApplicationShutdownHook.closeAndWait(SpringApplicationShutdownHook.java:147)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.boot.SpringApplicationShutdownHook.run(SpringApplicationShutdownHook.java:116)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 37 common frames omitted
2025-08-10 11:10:13 [SpringApplicationShutdownHook] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - StandardWebSocketSession[id=b0b76d64-c54e-07b0-9be7-e12d5996b95c, uri=ws://localhost:8080/api/chat] closed with CloseStatus[code=1001, reason=The web application is stopping]
2025-08-10 11:10:13 [SpringApplicationShutdownHook] INFO  c.e.u.d.chat.service.ChatService - 세션 정리 완료 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]
2025-08-10 11:10:13 [SpringApplicationShutdownHook] INFO  c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 연결 종료 [b0b76d64-c54e-07b0-9be7-e12d5996b95c]: CloseStatus[code=1001, reason=The web application is stopping]
2025-08-10 11:10:15 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 56636 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 11:10:15 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 11:10:15 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 11:10:16 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 11:10:16 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 15 ms. Found 3 JPA repository interfaces.
2025-08-10 11:10:16 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=efb109c1-7d98-3f96-97fc-a61a66401d77
2025-08-10 11:10:16 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 11:10:16 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 11:10:16 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 11:10:16 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 11:10:16 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 514 ms
2025-08-10 11:10:16 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 11:10:16 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 11:10:16 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 11:10:16 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 11:10:16 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 11:10:16 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@5bdb9c69
2025-08-10 11:10:16 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 11:10:16 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 11:10:16 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 11:10:16 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 11:10:17 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 11:10:17 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 11:10:17 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 11:10:17 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 11:10:17 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/chat] in 'webSocketHandlerMapping'
2025-08-10 11:10:17 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 11:10:17 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 11:10:17 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 11:10:17 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 11:10:18 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-08-10 11:10:18 [main] INFO  c.example.unithon.UnithonApplication - Started UnithonApplication in 2.963 seconds (process running for 3.374)
2025-08-10 11:10:23 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-10 11:10:23 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-10 11:10:23 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-08-10 11:10:23 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-08-10 11:10:23 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-08-10 11:10:23 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@274783f8
2025-08-10 11:10:23 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@357f7e2d
2025-08-10 11:10:23 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-08-10 11:10:23 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-10 11:10:23 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/websocket-test.html", parameters={}
2025-08-10 11:10:23 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [static/]]
2025-08-10 11:10:23 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-08-10 11:10:23 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/chat", parameters={}
2025-08-10 11:10:23 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.server.support.WebSocketHttpRequestHandler@79462469
2025-08-10 11:10:23 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHttpRequestHandler - GET /api/chat
2025-08-10 11:10:23 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-08-10 11:10:23 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New StandardWebSocketSession[id=d73fd82c-b06b-0a7b-5a35-a49cc422940e, uri=ws://localhost:8080/api/chat]
2025-08-10 11:10:23 [http-nio-8080-exec-2] INFO  c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 연결 성공: d73fd82c-b06b-0a7b-5a35-a49cc422940e
2025-08-10 11:10:23 [http-nio-8080-exec-2] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [d73fd82c-b06b-0a7b-5a35-a49cc422940e]: connection
2025-08-10 11:10:27 [http-nio-8080-exec-5] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [d73fd82c-b06b-0a7b-5a35-a49cc422940e]: {"type":"client.text","message":"제일싼 메뉴"}
2025-08-10 11:10:27 [http-nio-8080-exec-5] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [d73fd82c-b06b-0a7b-5a35-a49cc422940e]: 제일싼 메뉴
2025-08-10 11:10:27 [http-nio-8080-exec-5] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [d73fd82c-b06b-0a7b-5a35-a49cc422940e]: 제일싼 메뉴
2025-08-10 11:10:27 [http-nio-8080-exec-5] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자 메시지: "제일싼 메뉴"

이 메시지가 주문을 마치고 결제하려는 의도인지 판단해주세요.

주문 완료 의도 예시:
- "주문 마칠게요", "이걸로 끝", "계산해주세요"
- "주문 마친다", "이것만 주문할게요", "결제할게요"
- "다 됐어요", "이게 다예요", "더 이상 안 시켜요"

응답: YES 또는 NO만 답해주세요.

2025-08-10 11:10:28 [http-nio-8080-exec-5] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 11:10:28 [http-nio-8080-exec-5] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: NO

2025-08-10 11:10:28 [http-nio-8080-exec-5] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자 메시지: "제일싼 메뉴"

이 메시지가 메뉴를 더 추가 주문하려는 의도인지 판단해주세요.

메뉴 추가 의도 예시:
- "하나 더요", "추가로 주문할게요", "더 시키겠습니다"
- "다른 것도 주문", "또 주문", "추가 주문"

응답: YES 또는 NO만 답해주세요.

2025-08-10 11:10:29 [http-nio-8080-exec-5] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 11:10:29 [http-nio-8080-exec-5] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: NO

2025-08-10 11:10:29 [http-nio-8080-exec-5] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 제일싼 메뉴
2025-08-10 11:10:29 [http-nio-8080-exec-5] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: === 맥도날드 메뉴 데이터 ===

[버거/세트]
- 맥스파이시 상하이 버거 세트: 6,200원
- 불고기 버거: 3,500원
- 맥스파이시 상하이 버거: 4,500원
- 쿼터파운더: 4,800원
- 빅맥: 4,200원
- 불고기 버거 세트: 5,200원
- 쿼터파운더 세트: 6,500원
- 빅맥 세트: 5,900원

[커피]
- 아메리카노: 1,500원 (온도선택가능) (사이즈선택가능)
- 캐러멜 마키아토: 2,500원 (온도선택가능) (사이즈선택가능)
- 카푸치노: 2,200원 (온도선택가능) (사이즈선택가능)
- 카페라떼: 2,000원 (온도선택가능) (사이즈선택가능)

[음료]
- 오렌지 주스: 1,500원 (사이즈선택가능)
- 스프라이트: 1,200원 (사이즈선택가능)
- 코카콜라 제로: 1,200원 (사이즈선택가능)
- 코카콜라: 1,200원 (사이즈선택가능)

[사이드/디저트]
- 소프트 콘: 800원
- 맥플러리 오레오: 2,500원
- 애플파이: 1,500원
- 치킨 너겟: 2,200원
- 프렌치프라이: 1,800원 (사이즈선택가능)


=== 사용자 질문 ===
제일싼 메뉴

=== 응답 규칙 ===
위의 메뉴 데이터를 정확히 참고해서 사용자의 질문에 답변해주세요.
- 가격 정보는 정확한 금액을 명시해주세요
- 메뉴명은 정확히 표기해주세요
- 카테고리별로 분류해서 답변하면 더 좋습니다
- 친근하고 자연스러운 톤으로 답변해주세요
- 맥도날드 직원처럼 응답해주세요

응답 형식: 일반 텍스트 (JSON 아님)
2025-08-10 11:10:31 [http-nio-8080-exec-5] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 11:10:31 [http-nio-8080-exec-5] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: 안녕하세요! 맥도날드입니다.  가장 저렴한 메뉴를 찾으시는군요!

음료 중에서는 스프라이트와 코카콜라, 코카콜라 제로가 1,200원으로 제일 저렴하네요. 사이즈는 선택 가능하시구요!  

사이드/디저트 중에서는 소프트콘이 800원으로 가장 저렴합니다. 달콤한 간식으로 딱이죠!

버거류는 불고기버거가 3,500원으로 가장 저렴합니다.  든든한 한끼로 좋답니다!

2025-08-10 11:10:31 [http-nio-8080-exec-5] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: 안녕하세요! 맥도날드입니다.  가장 저렴한 메뉴를 찾으시는군요!

음료 중에서는 스프라이트와 코카콜라, 코카콜라 제로가 1,200원으로 제일 저렴하네요. 사이즈는 선택 가능하시구요!  

사이드/디저트 중에서는 소프트콘이 800원으로 가장 저렴합니다. 달콤한 간식으로 딱이죠!

버거류는 불고기버거가 3,500원으로 가장 저렴합니다.  든든한 한끼로 좋답니다!

2025-08-10 11:10:31 [http-nio-8080-exec-5] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [d73fd82c-b06b-0a7b-5a35-a49cc422940e]: bot.reply
2025-08-10 11:11:24 [http-nio-8080-exec-6] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [d73fd82c-b06b-0a7b-5a35-a49cc422940e]: {"type":"client.text","message":"아아"}
2025-08-10 11:11:24 [http-nio-8080-exec-6] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [d73fd82c-b06b-0a7b-5a35-a49cc422940e]: 아아
2025-08-10 11:11:24 [http-nio-8080-exec-6] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [d73fd82c-b06b-0a7b-5a35-a49cc422940e]: 아아
2025-08-10 11:11:24 [http-nio-8080-exec-6] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자 메시지: "아아"

이 메시지가 주문을 마치고 결제하려는 의도인지 판단해주세요.

주문 완료 의도 예시:
- "주문 마칠게요", "이걸로 끝", "계산해주세요"
- "주문 마친다", "이것만 주문할게요", "결제할게요"
- "다 됐어요", "이게 다예요", "더 이상 안 시켜요"

응답: YES 또는 NO만 답해주세요.

2025-08-10 11:11:25 [http-nio-8080-exec-6] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 11:11:25 [http-nio-8080-exec-6] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: NO

2025-08-10 11:11:25 [http-nio-8080-exec-6] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자 메시지: "아아"

이 메시지가 메뉴를 더 추가 주문하려는 의도인지 판단해주세요.

메뉴 추가 의도 예시:
- "하나 더요", "추가로 주문할게요", "더 시키겠습니다"
- "다른 것도 주문", "또 주문", "추가 주문"

응답: YES 또는 NO만 답해주세요.

2025-08-10 11:11:26 [http-nio-8080-exec-6] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 11:11:26 [http-nio-8080-exec-6] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: NO

2025-08-10 11:11:26 [http-nio-8080-exec-6] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 아아
2025-08-10 11:11:26 [http-nio-8080-exec-6] INFO  c.e.u.d.menu.service.MenuService - DB 동의어 매칭 성공: 아아 → 아메리카노
2025-08-10 11:11:26 [http-nio-8080-exec-6] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [d73fd82c-b06b-0a7b-5a35-a49cc422940e]: bot.reply
2025-08-10 11:11:42 [http-nio-8080-exec-7] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [d73fd82c-b06b-0a7b-5a35-a49cc422940e]: {"type":"client.text","message":"아이스로 레귤러"}
2025-08-10 11:11:42 [http-nio-8080-exec-7] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [d73fd82c-b06b-0a7b-5a35-a49cc422940e]: 아이스로 레귤러
2025-08-10 11:11:42 [http-nio-8080-exec-7] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [d73fd82c-b06b-0a7b-5a35-a49cc422940e]: 아이스로 레귤러
2025-08-10 11:11:42 [http-nio-8080-exec-7] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자 메시지: "아이스로 레귤러"

이 메시지가 주문을 마치고 결제하려는 의도인지 판단해주세요.

주문 완료 의도 예시:
- "주문 마칠게요", "이걸로 끝", "계산해주세요"
- "주문 마친다", "이것만 주문할게요", "결제할게요"
- "다 됐어요", "이게 다예요", "더 이상 안 시켜요"

응답: YES 또는 NO만 답해주세요.

2025-08-10 11:11:42 [http-nio-8080-exec-7] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 11:11:42 [http-nio-8080-exec-7] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: NO

2025-08-10 11:11:42 [http-nio-8080-exec-7] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자 메시지: "아이스로 레귤러"

이 메시지가 메뉴를 더 추가 주문하려는 의도인지 판단해주세요.

메뉴 추가 의도 예시:
- "하나 더요", "추가로 주문할게요", "더 시키겠습니다"
- "다른 것도 주문", "또 주문", "추가 주문"

응답: YES 또는 NO만 답해주세요.

2025-08-10 11:11:43 [http-nio-8080-exec-7] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 11:11:43 [http-nio-8080-exec-7] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: NO

2025-08-10 11:11:43 [http-nio-8080-exec-7] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [d73fd82c-b06b-0a7b-5a35-a49cc422940e]: bot.reply
2025-08-10 11:11:54 [http-nio-8080-exec-8] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [d73fd82c-b06b-0a7b-5a35-a49cc422940e]: {"type":"client.text","message":"주문 마칠래"}
2025-08-10 11:11:54 [http-nio-8080-exec-8] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [d73fd82c-b06b-0a7b-5a35-a49cc422940e]: 주문 마칠래
2025-08-10 11:11:54 [http-nio-8080-exec-8] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [d73fd82c-b06b-0a7b-5a35-a49cc422940e]: 주문 마칠래
2025-08-10 11:11:54 [http-nio-8080-exec-8] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자 메시지: "주문 마칠래"

이 메시지가 주문을 마치고 결제하려는 의도인지 판단해주세요.

주문 완료 의도 예시:
- "주문 마칠게요", "이걸로 끝", "계산해주세요"
- "주문 마친다", "이것만 주문할게요", "결제할게요"
- "다 됐어요", "이게 다예요", "더 이상 안 시켜요"

응답: YES 또는 NO만 답해주세요.

2025-08-10 11:11:55 [http-nio-8080-exec-8] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 11:11:55 [http-nio-8080-exec-8] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: YES

2025-08-10 11:11:55 [http-nio-8080-exec-8] INFO  c.e.u.d.chat.service.ChatService - 세션 정리 완료 [d73fd82c-b06b-0a7b-5a35-a49cc422940e]
2025-08-10 11:11:55 [http-nio-8080-exec-8] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [d73fd82c-b06b-0a7b-5a35-a49cc422940e]: bot.reply
2025-08-10 11:11:55 [http-nio-8080-exec-8] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 주문 완료로 인한 WebSocket 연결 종료 [d73fd82c-b06b-0a7b-5a35-a49cc422940e]
2025-08-10 11:11:55 [http-nio-8080-exec-8] DEBUG o.s.w.s.a.NativeWebSocketSession - Closing StandardWebSocketSession[id=d73fd82c-b06b-0a7b-5a35-a49cc422940e, uri=ws://localhost:8080/api/chat]
2025-08-10 11:11:55 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - StandardWebSocketSession[id=d73fd82c-b06b-0a7b-5a35-a49cc422940e, uri=ws://localhost:8080/api/chat] closed with CloseStatus[code=1000, reason=null]
2025-08-10 11:11:55 [http-nio-8080-exec-8] INFO  c.e.u.d.chat.service.ChatService - 세션 정리 완료 [d73fd82c-b06b-0a7b-5a35-a49cc422940e]
2025-08-10 11:11:55 [http-nio-8080-exec-8] INFO  c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 연결 종료 [d73fd82c-b06b-0a7b-5a35-a49cc422940e]: CloseStatus[code=1000, reason=null]
2025-08-10 12:30:54 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1h14m37s798ms).
2025-08-10 12:30:57 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@382154d7 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 12:30:59 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@9db7d0 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 13:17:15 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@3228ccf8 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 13:17:17 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@6e51fe05 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 13:30:53 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@5bdb9c69 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 13:30:53 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=59m58s750ms).
2025-08-10 14:06:54 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@77a4a4bf (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 14:07:04 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=36m11s421ms).
2025-08-10 14:07:08 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@7aeb69c6 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 14:07:09 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@54e2aa21 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 14:07:11 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@17617d40 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 14:07:20 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@36658333 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 14:07:57 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@7a13dd53 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 14:08:00 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@7c624fd4 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 14:08:02 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@496bd7df (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 14:08:10 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@2d7662e4 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 14:08:25 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@466784b (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 14:11:42 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/chat", parameters={}
2025-08-10 14:11:42 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.server.support.WebSocketHttpRequestHandler@79462469
2025-08-10 14:11:42 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.s.WebSocketHttpRequestHandler - GET /api/chat
2025-08-10 14:11:42 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-08-10 14:11:42 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New StandardWebSocketSession[id=06f9820e-c792-b620-0fc1-7c16fb2a5a56, uri=ws://localhost:8080/api/chat]
2025-08-10 14:11:42 [http-nio-8080-exec-9] INFO  c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 연결 성공: 06f9820e-c792-b620-0fc1-7c16fb2a5a56
2025-08-10 14:11:42 [http-nio-8080-exec-9] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [06f9820e-c792-b620-0fc1-7c16fb2a5a56]: connection
2025-08-10 14:18:50 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=2m15s525ms).
2025-08-10 14:20:38 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m6s624ms).
2025-08-10 14:20:43 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@74238de7 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 14:20:48 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@50c93729 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 14:22:41 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@73647d6d (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 14:23:27 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@53da709e (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 14:23:32 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@559dfa83 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 14:28:31 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@495bfbf (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 14:28:31 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=7m53s835ms).
2025-08-10 14:28:36 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@2830aebf (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 14:28:41 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@5eec69bd (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 14:29:07 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@7971b3bb (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 14:29:26 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@5918b0c1 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
2025-08-10 14:46:11 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-10 14:46:11 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-10 14:46:11 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 14:46:11 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-10 14:46:11 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-10 14:46:11 [SpringApplicationShutdownHook] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in StandardWebSocketSession[id=06f9820e-c792-b620-0fc1-7c16fb2a5a56, uri=ws://localhost:8080/api/chat]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:542)
	at org.apache.tomcat.websocket.WsSession.close(WsSession.java:530)
	at org.apache.tomcat.websocket.WsWebSocketContainer.destroy(WsWebSocketContainer.java:1022)
	at org.apache.tomcat.websocket.server.WsContextListener.contextDestroyed(WsContextListener.java:46)
	at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4090)
	at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:4700)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1219)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1208)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:814)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1219)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1208)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:814)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardService.stopInternal(StandardService.java:468)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardServer.stopInternal(StandardServer.java:915)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.startup.Tomcat.stop(Tomcat.java:448)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.stopTomcat(TomcatWebServer.java:301)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.destroy(TomcatWebServer.java:374)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:182)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.SpringApplicationShutdownHook.closeAndWait(SpringApplicationShutdownHook.java:147)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.boot.SpringApplicationShutdownHook.run(SpringApplicationShutdownHook.java:116)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 37 common frames omitted
2025-08-10 14:46:11 [SpringApplicationShutdownHook] ERROR c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 전송 오류 [06f9820e-c792-b620-0fc1-7c16fb2a5a56]: java.nio.channels.ClosedChannelException
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:542)
	at org.apache.tomcat.websocket.WsSession.close(WsSession.java:530)
	at org.apache.tomcat.websocket.WsWebSocketContainer.destroy(WsWebSocketContainer.java:1022)
	at org.apache.tomcat.websocket.server.WsContextListener.contextDestroyed(WsContextListener.java:46)
	at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4090)
	at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:4700)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1219)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1208)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:814)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1219)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1208)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:814)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardService.stopInternal(StandardService.java:468)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardServer.stopInternal(StandardServer.java:915)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.startup.Tomcat.stop(Tomcat.java:448)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.stopTomcat(TomcatWebServer.java:301)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.destroy(TomcatWebServer.java:374)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:182)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.SpringApplicationShutdownHook.closeAndWait(SpringApplicationShutdownHook.java:147)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.boot.SpringApplicationShutdownHook.run(SpringApplicationShutdownHook.java:116)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 37 common frames omitted
2025-08-10 14:46:11 [SpringApplicationShutdownHook] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - StandardWebSocketSession[id=06f9820e-c792-b620-0fc1-7c16fb2a5a56, uri=ws://localhost:8080/api/chat] closed with CloseStatus[code=1001, reason=The web application is stopping]
2025-08-10 14:46:11 [SpringApplicationShutdownHook] INFO  c.e.u.d.chat.service.ChatService - 세션 정리 완료 [06f9820e-c792-b620-0fc1-7c16fb2a5a56]
2025-08-10 14:46:11 [SpringApplicationShutdownHook] INFO  c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 연결 종료 [06f9820e-c792-b620-0fc1-7c16fb2a5a56]: CloseStatus[code=1001, reason=The web application is stopping]
2025-08-10 14:46:15 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 76454 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 14:46:15 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 14:46:15 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 14:46:15 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 14:46:15 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 15 ms. Found 3 JPA repository interfaces.
2025-08-10 14:46:15 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=efb109c1-7d98-3f96-97fc-a61a66401d77
2025-08-10 14:46:15 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 14:46:15 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 14:46:15 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 14:46:15 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 14:46:15 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 535 ms
2025-08-10 14:46:15 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 14:46:15 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 14:46:15 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 14:46:15 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 14:46:15 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 14:46:16 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@7f41d979
2025-08-10 14:46:16 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 14:46:16 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 14:46:16 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 14:46:16 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 14:46:16 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 14:46:16 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 14:46:16 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 14:46:17 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 14:46:17 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/chat] in 'webSocketHandlerMapping'
2025-08-10 14:46:17 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 14:46:17 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 14:46:17 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 14:46:17 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 14:46:17 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-08-10 14:46:17 [main] INFO  c.example.unithon.UnithonApplication - Started UnithonApplication in 2.797 seconds (process running for 3.256)
2025-08-10 14:46:29 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-10 14:46:29 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-10 14:46:29 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-08-10 14:46:29 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-08-10 14:46:29 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-08-10 14:46:29 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@30c98124
2025-08-10 14:46:29 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@23243385
2025-08-10 14:46:29 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-08-10 14:46:29 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 3 ms
2025-08-10 14:46:29 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/websocket-test.html", parameters={}
2025-08-10 14:46:29 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [static/]]
2025-08-10 14:46:29 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-08-10 14:46:29 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/chat", parameters={}
2025-08-10 14:46:29 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.server.support.WebSocketHttpRequestHandler@729f8c5d
2025-08-10 14:46:29 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHttpRequestHandler - GET /api/chat
2025-08-10 14:46:29 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-08-10 14:46:29 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New StandardWebSocketSession[id=fefa9fdb-964b-334f-f62a-516fe9b8fe28, uri=ws://localhost:8080/api/chat]
2025-08-10 14:46:29 [http-nio-8080-exec-2] INFO  c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 연결 성공: fefa9fdb-964b-334f-f62a-516fe9b8fe28
2025-08-10 14:46:29 [http-nio-8080-exec-2] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [fefa9fdb-964b-334f-f62a-516fe9b8fe28]: connection
2025-08-10 14:46:34 [http-nio-8080-exec-5] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [fefa9fdb-964b-334f-f62a-516fe9b8fe28]: {"type":"client.text","message":"아아줘"}
2025-08-10 14:46:34 [http-nio-8080-exec-5] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [fefa9fdb-964b-334f-f62a-516fe9b8fe28]: 아아줘
2025-08-10 14:46:34 [http-nio-8080-exec-5] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [fefa9fdb-964b-334f-f62a-516fe9b8fe28]: 아아줘
2025-08-10 14:46:34 [http-nio-8080-exec-5] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자 메시지: "아아줘"

이 메시지가 주문을 마치고 결제하려는 의도인지 판단해주세요.

주문 완료 의도 예시:
- "주문 마칠게요", "이걸로 끝", "계산해주세요"
- "주문 마친다", "이것만 주문할게요", "결제할게요"
- "다 됐어요", "이게 다예요", "더 이상 안 시켜요"

응답: YES 또는 NO만 답해주세요.

2025-08-10 14:46:35 [http-nio-8080-exec-5] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 14:46:35 [http-nio-8080-exec-5] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: NO

2025-08-10 14:46:35 [http-nio-8080-exec-5] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자 메시지: "아아줘"

이 메시지가 메뉴를 더 추가 주문하려는 의도인지 판단해주세요.

메뉴 추가 의도 예시:
- "하나 더요", "추가로 주문할게요", "더 시키겠습니다"
- "다른 것도 주문", "또 주문", "추가 주문"

응답: YES 또는 NO만 답해주세요.

2025-08-10 14:46:35 [http-nio-8080-exec-5] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 14:46:35 [http-nio-8080-exec-5] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: NO

2025-08-10 14:46:35 [http-nio-8080-exec-5] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 아아줘
2025-08-10 14:46:36 [http-nio-8080-exec-5] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자가 '아아줘'를 주문했습니다.
이것은 맥도날드 매장입니다. 다음은 현재 판매 중인 메뉴입니다:

버거/세트: 빅맥, 쿼터파운더, 맥스파이시 상하이 버거, 불고기 버거
커피: 아메리카노, 카페라떼, 카푸치노, 캐러멜 마키아토
음료: 코카콜라, 코카콜라 제로, 스프라이트, 오렌지 주스
사이드: 프렌치프라이, 치킨 너겟, 애플파이
디저트: 맥플러리 오레오, 소프트 콘

판단 기준:
1. 요청한 음식이 맥도날드에서 파는 종류의 음식인가?
2. 위 메뉴와 유사한 것이 있는가?

응답 규칙:
- 맥도날드와 전혀 관련 없는 음식(짜장면, 김치찌개, 초밥 등)이면 → NO_MATCH
- 유사한 메뉴가 있으면 → 다음 기준으로 추천:
  1. 카테고리가 같은 메뉴를 우선 추천 (커피→커피, 버거→버거)
  2. 맛, 재료, 특성이 유사한 메뉴를 선택
  3. 가격대가 비슷한 메뉴를 우선 고려
  4. 반드시 위 메뉴 목록에 있는 정확한 메뉴명만 추천

예시:
바닐라 라떼' → '카페라떼', '캐러멜 마키아토' 추천
'치즈버거' → '빅맥', '불고기 버거' 추천
'짜장면' → NO_MATCH (맥도날드 음식이 아님)
'김치찌개' → NO_MATCH (맥도날드 음식이 아님)

응답 형식: JSON
{
  "recommended": ["메뉴명1", "메뉴명2"] 또는 "NO_MATCH",
  "reason": "판단 이유"
}
2025-08-10 14:46:37 [http-nio-8080-exec-5] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 14:46:37 [http-nio-8080-exec-5] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: ```json
{
  "recommended": ["아메리카노"],
  "reason": "사용자가 주문한 '아아줘'는 '아이스 아메리카노'를 의미하는 것으로 판단되며, 메뉴에 '아메리카노'가 있으므로 아메리카노를 추천합니다."
}
```

2025-08-10 14:46:37 [http-nio-8080-exec-5] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: ```json
{
  "recommended": ["아메리카노"],
  "reason": "사용자가 주문한 '아아줘'는 '아이스 아메리카노'를 의미하는 것으로 판단되며, 메뉴에 '아메리카노'가 있으므로 아메리카노를 추천합니다."
}
```

2025-08-10 14:46:37 [http-nio-8080-exec-5] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답에서 파싱된 추천 메뉴: [아메리카노]
2025-08-10 14:46:37 [http-nio-8080-exec-5] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [fefa9fdb-964b-334f-f62a-516fe9b8fe28]: bot.reply
2025-08-10 14:46:45 [http-nio-8080-exec-6] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [fefa9fdb-964b-334f-f62a-516fe9b8fe28]: {"type":"client.text","message":"아아 줘"}
2025-08-10 14:46:45 [http-nio-8080-exec-6] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [fefa9fdb-964b-334f-f62a-516fe9b8fe28]: 아아 줘
2025-08-10 14:46:45 [http-nio-8080-exec-6] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [fefa9fdb-964b-334f-f62a-516fe9b8fe28]: 아아 줘
2025-08-10 14:46:45 [http-nio-8080-exec-6] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자 메시지: "아아 줘"

이 메시지가 주문을 마치고 결제하려는 의도인지 판단해주세요.

주문 완료 의도 예시:
- "주문 마칠게요", "이걸로 끝", "계산해주세요"
- "주문 마친다", "이것만 주문할게요", "결제할게요"
- "다 됐어요", "이게 다예요", "더 이상 안 시켜요"

응답: YES 또는 NO만 답해주세요.

2025-08-10 14:46:45 [http-nio-8080-exec-6] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 14:46:45 [http-nio-8080-exec-6] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: NO

2025-08-10 14:46:45 [http-nio-8080-exec-6] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자 메시지: "아아 줘"

이 메시지가 메뉴를 더 추가 주문하려는 의도인지 판단해주세요.

메뉴 추가 의도 예시:
- "하나 더요", "추가로 주문할게요", "더 시키겠습니다"
- "다른 것도 주문", "또 주문", "추가 주문"

응답: YES 또는 NO만 답해주세요.

2025-08-10 14:46:46 [http-nio-8080-exec-6] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 14:46:46 [http-nio-8080-exec-6] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: NO

2025-08-10 14:46:46 [http-nio-8080-exec-6] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 아아 줘
2025-08-10 14:46:46 [http-nio-8080-exec-6] INFO  c.e.u.d.menu.service.MenuService - DB 동의어 매칭 성공: 아아 줘 → 아메리카노
2025-08-10 14:46:46 [http-nio-8080-exec-6] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [fefa9fdb-964b-334f-f62a-516fe9b8fe28]: bot.reply
2025-08-10 14:46:56 [http-nio-8080-exec-7] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [fefa9fdb-964b-334f-f62a-516fe9b8fe28]: {"type":"client.text","message":"라지로 한잔줘."}
2025-08-10 14:46:56 [http-nio-8080-exec-7] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [fefa9fdb-964b-334f-f62a-516fe9b8fe28]: 라지로 한잔줘.
2025-08-10 14:46:56 [http-nio-8080-exec-7] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [fefa9fdb-964b-334f-f62a-516fe9b8fe28]: 라지로 한잔줘.
2025-08-10 14:46:56 [http-nio-8080-exec-7] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자 메시지: "라지로 한잔줘."

이 메시지가 주문을 마치고 결제하려는 의도인지 판단해주세요.

주문 완료 의도 예시:
- "주문 마칠게요", "이걸로 끝", "계산해주세요"
- "주문 마친다", "이것만 주문할게요", "결제할게요"
- "다 됐어요", "이게 다예요", "더 이상 안 시켜요"

응답: YES 또는 NO만 답해주세요.

2025-08-10 14:46:57 [http-nio-8080-exec-7] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 14:46:57 [http-nio-8080-exec-7] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: NO

2025-08-10 14:46:57 [http-nio-8080-exec-7] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자 메시지: "라지로 한잔줘."

이 메시지가 메뉴를 더 추가 주문하려는 의도인지 판단해주세요.

메뉴 추가 의도 예시:
- "하나 더요", "추가로 주문할게요", "더 시키겠습니다"
- "다른 것도 주문", "또 주문", "추가 주문"

응답: YES 또는 NO만 답해주세요.

2025-08-10 14:46:58 [http-nio-8080-exec-7] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 14:46:58 [http-nio-8080-exec-7] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: YES

2025-08-10 14:46:58 [http-nio-8080-exec-7] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [fefa9fdb-964b-334f-f62a-516fe9b8fe28]: bot.reply
2025-08-10 14:47:04 [http-nio-8080-exec-8] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [fefa9fdb-964b-334f-f62a-516fe9b8fe28]: {"type":"client.command","action":"cancel"}
2025-08-10 14:47:04 [http-nio-8080-exec-8] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 명령 메시지 처리 [fefa9fdb-964b-334f-f62a-516fe9b8fe28]: cancel
2025-08-10 14:47:04 [http-nio-8080-exec-8] INFO  c.e.u.d.chat.service.ChatService - 세션 정리 완료 [fefa9fdb-964b-334f-f62a-516fe9b8fe28]
2025-08-10 14:47:04 [http-nio-8080-exec-8] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [fefa9fdb-964b-334f-f62a-516fe9b8fe28]: bot.reply
2025-08-10 14:47:12 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/websocket-test.html", parameters={}
2025-08-10 14:47:12 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [static/]]
2025-08-10 14:47:12 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-08-10 14:47:12 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - StandardWebSocketSession[id=fefa9fdb-964b-334f-f62a-516fe9b8fe28, uri=ws://localhost:8080/api/chat] closed with CloseStatus[code=1001, reason=null]
2025-08-10 14:47:12 [http-nio-8080-exec-10] INFO  c.e.u.d.chat.service.ChatService - 세션 정리 완료 [fefa9fdb-964b-334f-f62a-516fe9b8fe28]
2025-08-10 14:47:12 [http-nio-8080-exec-10] INFO  c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 연결 종료 [fefa9fdb-964b-334f-f62a-516fe9b8fe28]: CloseStatus[code=1001, reason=null]
2025-08-10 14:47:12 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/chat", parameters={}
2025-08-10 14:47:12 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.server.support.WebSocketHttpRequestHandler@729f8c5d
2025-08-10 14:47:12 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHttpRequestHandler - GET /api/chat
2025-08-10 14:47:12 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-08-10 14:47:12 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New StandardWebSocketSession[id=35e74b5d-71a5-1ff1-d1ce-be87cae152a3, uri=ws://localhost:8080/api/chat]
2025-08-10 14:47:12 [http-nio-8080-exec-1] INFO  c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 연결 성공: 35e74b5d-71a5-1ff1-d1ce-be87cae152a3
2025-08-10 14:47:12 [http-nio-8080-exec-1] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [35e74b5d-71a5-1ff1-d1ce-be87cae152a3]: connection
2025-08-10 14:47:19 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-10 14:47:19 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-10 14:47:19 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 14:47:19 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-10 14:47:19 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-10 14:47:19 [SpringApplicationShutdownHook] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in StandardWebSocketSession[id=35e74b5d-71a5-1ff1-d1ce-be87cae152a3, uri=ws://localhost:8080/api/chat]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:542)
	at org.apache.tomcat.websocket.WsSession.close(WsSession.java:530)
	at org.apache.tomcat.websocket.WsWebSocketContainer.destroy(WsWebSocketContainer.java:1022)
	at org.apache.tomcat.websocket.server.WsContextListener.contextDestroyed(WsContextListener.java:46)
	at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4090)
	at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:4700)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1219)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1208)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:814)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1219)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1208)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:814)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardService.stopInternal(StandardService.java:468)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardServer.stopInternal(StandardServer.java:915)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.startup.Tomcat.stop(Tomcat.java:448)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.stopTomcat(TomcatWebServer.java:301)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.destroy(TomcatWebServer.java:374)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:182)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.SpringApplicationShutdownHook.closeAndWait(SpringApplicationShutdownHook.java:147)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.boot.SpringApplicationShutdownHook.run(SpringApplicationShutdownHook.java:116)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 37 common frames omitted
2025-08-10 14:47:19 [SpringApplicationShutdownHook] ERROR c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 전송 오류 [35e74b5d-71a5-1ff1-d1ce-be87cae152a3]: java.nio.channels.ClosedChannelException
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:778)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:575)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:542)
	at org.apache.tomcat.websocket.WsSession.close(WsSession.java:530)
	at org.apache.tomcat.websocket.WsWebSocketContainer.destroy(WsWebSocketContainer.java:1022)
	at org.apache.tomcat.websocket.server.WsContextListener.contextDestroyed(WsContextListener.java:46)
	at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4090)
	at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:4700)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1219)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1208)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:814)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1219)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1208)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:814)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardService.stopInternal(StandardService.java:468)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardServer.stopInternal(StandardServer.java:915)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.startup.Tomcat.stop(Tomcat.java:448)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.stopTomcat(TomcatWebServer.java:301)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.destroy(TomcatWebServer.java:374)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:182)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1126)
	at org.springframework.boot.SpringApplicationShutdownHook.closeAndWait(SpringApplicationShutdownHook.java:147)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.boot.SpringApplicationShutdownHook.run(SpringApplicationShutdownHook.java:116)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1665)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:171)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 37 common frames omitted
2025-08-10 14:47:19 [SpringApplicationShutdownHook] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - StandardWebSocketSession[id=35e74b5d-71a5-1ff1-d1ce-be87cae152a3, uri=ws://localhost:8080/api/chat] closed with CloseStatus[code=1001, reason=The web application is stopping]
2025-08-10 14:47:19 [SpringApplicationShutdownHook] INFO  c.e.u.d.chat.service.ChatService - 세션 정리 완료 [35e74b5d-71a5-1ff1-d1ce-be87cae152a3]
2025-08-10 14:47:19 [SpringApplicationShutdownHook] INFO  c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 연결 종료 [35e74b5d-71a5-1ff1-d1ce-be87cae152a3]: CloseStatus[code=1001, reason=The web application is stopping]
2025-08-10 14:47:21 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 77061 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 14:47:21 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 14:47:21 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 14:47:21 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 14:47:21 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 18 ms. Found 3 JPA repository interfaces.
2025-08-10 14:47:21 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=efb109c1-7d98-3f96-97fc-a61a66401d77
2025-08-10 14:47:21 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 14:47:21 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 14:47:21 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 14:47:21 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 14:47:21 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 647 ms
2025-08-10 14:47:21 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 14:47:21 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 14:47:21 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 14:47:21 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 14:47:21 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 14:47:22 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@1feb76b9
2025-08-10 14:47:22 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 14:47:22 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 14:47:22 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 14:47:22 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 14:47:22 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 14:47:22 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 14:47:22 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 14:47:22 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 14:47:23 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/chat] in 'webSocketHandlerMapping'
2025-08-10 14:47:23 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 13 mappings in 'requestMappingHandlerMapping'
2025-08-10 14:47:23 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 14:47:23 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 14:47:23 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 14:47:23 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-08-10 14:47:23 [main] INFO  c.example.unithon.UnithonApplication - Started UnithonApplication in 2.719 seconds (process running for 3.044)
2025-08-10 14:47:25 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-10 14:47:25 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-10 14:47:25 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-08-10 14:47:25 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-08-10 14:47:25 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-08-10 14:47:25 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@7065ae93
2025-08-10 14:47:25 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@2095e085
2025-08-10 14:47:25 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-08-10 14:47:25 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-08-10 14:47:25 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/websocket-test.html", parameters={}
2025-08-10 14:47:25 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [static/]]
2025-08-10 14:47:25 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-08-10 14:47:25 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/chat", parameters={}
2025-08-10 14:47:25 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.server.support.WebSocketHttpRequestHandler@680f7a5e
2025-08-10 14:47:25 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHttpRequestHandler - GET /api/chat
2025-08-10 14:47:25 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-08-10 14:47:25 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New StandardWebSocketSession[id=5ace0ffe-68e2-adf2-9d0f-9ec1940cd875, uri=ws://localhost:8080/api/chat]
2025-08-10 14:47:25 [http-nio-8080-exec-2] INFO  c.e.u.d.c.h.ChatWebSocketHandler - WebSocket 연결 성공: 5ace0ffe-68e2-adf2-9d0f-9ec1940cd875
2025-08-10 14:47:25 [http-nio-8080-exec-2] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [5ace0ffe-68e2-adf2-9d0f-9ec1940cd875]: connection
2025-08-10 14:47:28 [http-nio-8080-exec-3] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [5ace0ffe-68e2-adf2-9d0f-9ec1940cd875]: {"type":"client.text","message":"아아줘"}
2025-08-10 14:47:28 [http-nio-8080-exec-3] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [5ace0ffe-68e2-adf2-9d0f-9ec1940cd875]: 아아줘
2025-08-10 14:47:28 [http-nio-8080-exec-3] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [5ace0ffe-68e2-adf2-9d0f-9ec1940cd875]: 아아줘
2025-08-10 14:47:28 [http-nio-8080-exec-3] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자 메시지: "아아줘"

이 메시지가 주문을 마치고 결제하려는 의도인지 판단해주세요.

주문 완료 의도 예시:
- "주문 마칠게요", "이걸로 끝", "계산해주세요"
- "주문 마친다", "이것만 주문할게요", "결제할게요"
- "다 됐어요", "이게 다예요", "더 이상 안 시켜요"

응답: YES 또는 NO만 답해주세요.

2025-08-10 14:47:29 [http-nio-8080-exec-3] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 14:47:29 [http-nio-8080-exec-3] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: NO

2025-08-10 14:47:29 [http-nio-8080-exec-3] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자 메시지: "아아줘"

이 메시지가 메뉴를 더 추가 주문하려는 의도인지 판단해주세요.

메뉴 추가 의도 예시:
- "하나 더요", "추가로 주문할게요", "더 시키겠습니다"
- "다른 것도 주문", "또 주문", "추가 주문"

응답: YES 또는 NO만 답해주세요.

2025-08-10 14:47:29 [http-nio-8080-exec-3] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 14:47:29 [http-nio-8080-exec-3] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: NO

2025-08-10 14:47:29 [http-nio-8080-exec-3] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 아아줘
2025-08-10 14:47:29 [http-nio-8080-exec-3] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자가 '아아줘'를 주문했습니다.
이것은 맥도날드 매장입니다. 다음은 현재 판매 중인 메뉴입니다:

버거/세트: 빅맥, 쿼터파운더, 맥스파이시 상하이 버거, 불고기 버거
커피: 아메리카노, 카페라떼, 카푸치노, 캐러멜 마키아토
음료: 코카콜라, 코카콜라 제로, 스프라이트, 오렌지 주스
사이드: 프렌치프라이, 치킨 너겟, 애플파이
디저트: 맥플러리 오레오, 소프트 콘

판단 기준:
1. 요청한 음식이 맥도날드에서 파는 종류의 음식인가?
2. 위 메뉴와 유사한 것이 있는가?

응답 규칙:
- 맥도날드와 전혀 관련 없는 음식(짜장면, 김치찌개, 초밥 등)이면 → NO_MATCH
- 유사한 메뉴가 있으면 → 다음 기준으로 추천:
  1. 카테고리가 같은 메뉴를 우선 추천 (커피→커피, 버거→버거)
  2. 맛, 재료, 특성이 유사한 메뉴를 선택
  3. 가격대가 비슷한 메뉴를 우선 고려
  4. 반드시 위 메뉴 목록에 있는 정확한 메뉴명만 추천

예시:
바닐라 라떼' → '카페라떼', '캐러멜 마키아토' 추천
'치즈버거' → '빅맥', '불고기 버거' 추천
'짜장면' → NO_MATCH (맥도날드 음식이 아님)
'김치찌개' → NO_MATCH (맥도날드 음식이 아님)

응답 형식: JSON
{
  "recommended": ["메뉴명1", "메뉴명2"] 또는 "NO_MATCH",
  "reason": "판단 이유"
}
2025-08-10 14:47:30 [http-nio-8080-exec-3] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 14:47:30 [http-nio-8080-exec-3] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: ```json
{
  "recommended": ["아메리카노"],
  "reason": "사용자가 주문한 '아아줘'는 '아이스 아메리카노'를 의미하는 것으로 추정되며, 메뉴에 '아메리카노'가 있으므로 아메리카노를 추천합니다."
}
```

2025-08-10 14:47:30 [http-nio-8080-exec-3] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답: ```json
{
  "recommended": ["아메리카노"],
  "reason": "사용자가 주문한 '아아줘'는 '아이스 아메리카노'를 의미하는 것으로 추정되며, 메뉴에 '아메리카노'가 있으므로 아메리카노를 추천합니다."
}
```

2025-08-10 14:47:30 [http-nio-8080-exec-3] INFO  c.e.u.d.menu.service.MenuService - Gemini 응답에서 파싱된 추천 메뉴: [아메리카노]
2025-08-10 14:47:30 [http-nio-8080-exec-3] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [5ace0ffe-68e2-adf2-9d0f-9ec1940cd875]: bot.reply
2025-08-10 14:47:41 [http-nio-8080-exec-6] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [5ace0ffe-68e2-adf2-9d0f-9ec1940cd875]: {"type":"client.text","message":"아아 줘"}
2025-08-10 14:47:41 [http-nio-8080-exec-6] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [5ace0ffe-68e2-adf2-9d0f-9ec1940cd875]: 아아 줘
2025-08-10 14:47:41 [http-nio-8080-exec-6] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [5ace0ffe-68e2-adf2-9d0f-9ec1940cd875]: 아아 줘
2025-08-10 14:47:41 [http-nio-8080-exec-6] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자 메시지: "아아 줘"

이 메시지가 주문을 마치고 결제하려는 의도인지 판단해주세요.

주문 완료 의도 예시:
- "주문 마칠게요", "이걸로 끝", "계산해주세요"
- "주문 마친다", "이것만 주문할게요", "결제할게요"
- "다 됐어요", "이게 다예요", "더 이상 안 시켜요"

응답: YES 또는 NO만 답해주세요.

2025-08-10 14:47:42 [http-nio-8080-exec-6] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 14:47:42 [http-nio-8080-exec-6] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: NO

2025-08-10 14:47:42 [http-nio-8080-exec-6] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자 메시지: "아아 줘"

이 메시지가 메뉴를 더 추가 주문하려는 의도인지 판단해주세요.

메뉴 추가 의도 예시:
- "하나 더요", "추가로 주문할게요", "더 시키겠습니다"
- "다른 것도 주문", "또 주문", "추가 주문"

응답: YES 또는 NO만 답해주세요.

2025-08-10 14:47:43 [http-nio-8080-exec-6] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 14:47:43 [http-nio-8080-exec-6] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: NO

2025-08-10 14:47:43 [http-nio-8080-exec-6] INFO  c.e.u.d.menu.service.MenuService - 메뉴 검색 시작: 아아 줘
2025-08-10 14:47:43 [http-nio-8080-exec-6] INFO  c.e.u.d.menu.service.MenuService - DB 동의어 매칭 성공: 아아 줘 → 아메리카노
2025-08-10 14:47:43 [http-nio-8080-exec-6] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [5ace0ffe-68e2-adf2-9d0f-9ec1940cd875]: bot.reply
2025-08-10 14:48:30 [http-nio-8080-exec-7] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [5ace0ffe-68e2-adf2-9d0f-9ec1940cd875]: {"type":"client.text","message":"래귤러"}
2025-08-10 14:48:30 [http-nio-8080-exec-7] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [5ace0ffe-68e2-adf2-9d0f-9ec1940cd875]: 래귤러
2025-08-10 14:48:30 [http-nio-8080-exec-7] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [5ace0ffe-68e2-adf2-9d0f-9ec1940cd875]: 래귤러
2025-08-10 14:48:30 [http-nio-8080-exec-7] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자 메시지: "래귤러"

이 메시지가 주문을 마치고 결제하려는 의도인지 판단해주세요.

주문 완료 의도 예시:
- "주문 마칠게요", "이걸로 끝", "계산해주세요"
- "주문 마친다", "이것만 주문할게요", "결제할게요"
- "다 됐어요", "이게 다예요", "더 이상 안 시켜요"

응답: YES 또는 NO만 답해주세요.

2025-08-10 14:48:31 [http-nio-8080-exec-7] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 14:48:31 [http-nio-8080-exec-7] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: NO

2025-08-10 14:48:31 [http-nio-8080-exec-7] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자 메시지: "래귤러"

이 메시지가 메뉴를 더 추가 주문하려는 의도인지 판단해주세요.

메뉴 추가 의도 예시:
- "하나 더요", "추가로 주문할게요", "더 시키겠습니다"
- "다른 것도 주문", "또 주문", "추가 주문"

응답: YES 또는 NO만 답해주세요.

2025-08-10 14:48:32 [http-nio-8080-exec-7] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 14:48:32 [http-nio-8080-exec-7] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: NO

2025-08-10 14:48:32 [http-nio-8080-exec-7] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [5ace0ffe-68e2-adf2-9d0f-9ec1940cd875]: bot.reply
2025-08-10 14:48:38 [http-nio-8080-exec-8] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 수신 메시지 [5ace0ffe-68e2-adf2-9d0f-9ec1940cd875]: {"type":"client.text","message":"레귤러"}
2025-08-10 14:48:38 [http-nio-8080-exec-8] INFO  c.e.u.d.c.h.ChatWebSocketHandler - 텍스트 메시지 처리 [5ace0ffe-68e2-adf2-9d0f-9ec1940cd875]: 레귤러
2025-08-10 14:48:38 [http-nio-8080-exec-8] INFO  c.e.u.d.chat.service.ChatService - 메시지 처리 [5ace0ffe-68e2-adf2-9d0f-9ec1940cd875]: 레귤러
2025-08-10 14:48:38 [http-nio-8080-exec-8] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자 메시지: "레귤러"

이 메시지가 주문을 마치고 결제하려는 의도인지 판단해주세요.

주문 완료 의도 예시:
- "주문 마칠게요", "이걸로 끝", "계산해주세요"
- "주문 마친다", "이것만 주문할게요", "결제할게요"
- "다 됐어요", "이게 다예요", "더 이상 안 시켜요"

응답: YES 또는 NO만 답해주세요.

2025-08-10 14:48:38 [http-nio-8080-exec-8] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 14:48:38 [http-nio-8080-exec-8] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: NO

2025-08-10 14:48:38 [http-nio-8080-exec-8] INFO  c.e.u.g.client.gemini.GeminiService - Calling Gemini API with prompt: 사용자 메시지: "레귤러"

이 메시지가 메뉴를 더 추가 주문하려는 의도인지 판단해주세요.

메뉴 추가 의도 예시:
- "하나 더요", "추가로 주문할게요", "더 시키겠습니다"
- "다른 것도 주문", "또 주문", "추가 주문"

응답: YES 또는 NO만 답해주세요.

2025-08-10 14:48:39 [http-nio-8080-exec-8] DEBUG o.s.w.c.HttpMessageConverterExtractor - Reading to [com.example.unithon.global.client.gemini.GeminiResponse]
2025-08-10 14:48:39 [http-nio-8080-exec-8] INFO  c.e.u.g.client.gemini.GeminiService - Received response from Gemini API: NO

2025-08-10 14:48:39 [http-nio-8080-exec-8] DEBUG c.e.u.d.c.h.ChatWebSocketHandler - 메시지 전송 [5ace0ffe-68e2-adf2-9d0f-9ec1940cd875]: bot.reply
2025-08-10 14:58:38 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 83881 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 14:58:38 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 14:58:38 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 14:58:38 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 14:58:38 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 19 ms. Found 3 JPA repository interfaces.
2025-08-10 14:58:38 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=a942e31c-ca38-3fd1-bbc9-8e04d9a2759c
2025-08-10 14:58:38 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 14:58:38 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 14:58:38 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 14:58:38 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 14:58:38 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 604 ms
2025-08-10 14:58:39 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 14:58:39 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 14:58:39 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 14:58:39 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 14:58:39 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 14:58:39 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@5ea9373e
2025-08-10 14:58:39 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 14:58:39 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 14:58:39 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 14:58:39 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 14:58:39 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 14:58:39 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 14:58:39 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 14:58:40 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 14:58:40 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/chat] in 'webSocketHandlerMapping'
2025-08-10 14:58:40 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 15 mappings in 'requestMappingHandlerMapping'
2025-08-10 14:58:40 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 14:58:40 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 14:58:40 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 14:58:41 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-08-10 14:58:41 [main] INFO  c.example.unithon.UnithonApplication - Started UnithonApplication in 2.887 seconds (process running for 3.155)
2025-08-10 15:15:20 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 93194 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 15:15:20 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 15:15:20 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 15:15:21 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 15:15:21 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 19 ms. Found 3 JPA repository interfaces.
2025-08-10 15:15:21 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=4d8ed9c3-4e79-3088-b2f8-668d8c1b63c3
2025-08-10 15:15:21 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 15:15:21 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 15:15:21 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 15:15:21 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 15:15:21 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 573 ms
2025-08-10 15:15:21 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 15:15:21 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 15:15:21 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 15:15:21 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 15:15:21 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 15:15:21 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@78e97d4d
2025-08-10 15:15:21 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 15:15:21 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 15:15:21 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 15:15:21 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 15:15:22 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 15:15:22 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 15:15:22 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 15:15:22 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 15:15:22 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/chat] in 'webSocketHandlerMapping'
2025-08-10 15:15:22 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 15 mappings in 'requestMappingHandlerMapping'
2025-08-10 15:15:22 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 15:15:22 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 15:15:22 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 15:15:23 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'
2025-08-10 15:15:23 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 15:15:23 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-10 15:15:23 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-10 15:15:23 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-08-10 15:15:23 [main] ERROR o.s.b.d.LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Web server failed to start. Port 8080 was already in use.

Action:

Identify and stop the process that's listening on port 8080 or configure this application to listen on another port.

2025-08-10 15:16:13 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 93826 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 15:16:13 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 15:16:13 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 15:16:13 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 15:16:13 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 16 ms. Found 3 JPA repository interfaces.
2025-08-10 15:16:13 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=4d8ed9c3-4e79-3088-b2f8-668d8c1b63c3
2025-08-10 15:16:13 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 15:16:13 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 15:16:13 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 15:16:13 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 15:16:13 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 567 ms
2025-08-10 15:16:14 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 15:16:14 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 15:16:14 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 15:16:14 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 15:16:14 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 15:16:14 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@14fff5e7
2025-08-10 15:16:14 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 15:16:14 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 15:16:14 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 15:16:14 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 15:16:14 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 15:16:14 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 15:16:14 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 15:16:15 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 15:16:15 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/chat] in 'webSocketHandlerMapping'
2025-08-10 15:16:15 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 15 mappings in 'requestMappingHandlerMapping'
2025-08-10 15:16:15 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 15:16:15 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 15:16:15 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 15:16:16 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-08-10 15:16:16 [main] INFO  c.example.unithon.UnithonApplication - Started UnithonApplication in 2.856 seconds (process running for 3.276)
2025-08-10 15:16:17 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-10 15:16:17 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-10 15:16:17 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 15:16:17 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-10 15:16:17 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-10 15:18:21 [main] INFO  c.example.unithon.UnithonApplication - Starting UnithonApplication using Java 21.0.4 with PID 95331 (/Users/yunjeong/Desktop/unithon/build/classes/java/main started by yunjeong in /Users/yunjeong/Desktop/unithon)
2025-08-10 15:18:21 [main] DEBUG c.example.unithon.UnithonApplication - Running with Spring Boot v3.5.4, Spring v6.2.9
2025-08-10 15:18:21 [main] INFO  c.example.unithon.UnithonApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-10 15:18:21 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-10 15:18:21 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 27 ms. Found 3 JPA repository interfaces.
2025-08-10 15:18:21 [main] INFO  o.s.cloud.context.scope.GenericScope - BeanFactory id=feeb995c-0e7b-32e7-bb56-2ed26f0c4cc5
2025-08-10 15:18:22 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-08-10 15:18:22 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-10 15:18:22 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-10 15:18:22 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-08-10 15:18:22 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 741 ms
2025-08-10 15:18:22 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-10 15:18:22 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-10 15:18:22 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-10 15:18:22 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-10 15:18:22 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-10 15:18:22 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@aa23f11
2025-08-10 15:18:22 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-10 15:18:22 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-10 15:18:22 [main] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-08-10 15:18:22 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-10 15:18:23 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-10 15:18:23 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-10 15:18:23 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-10 15:18:23 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-10 15:18:23 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/chat] in 'webSocketHandlerMapping'
2025-08-10 15:18:23 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 15 mappings in 'requestMappingHandlerMapping'
2025-08-10 15:18:23 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2025-08-10 15:18:23 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-08-10 15:18:23 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2025-08-10 15:18:24 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-08-10 15:18:24 [main] INFO  c.example.unithon.UnithonApplication - Started UnithonApplication in 3.351 seconds (process running for 3.641)
